<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>pfan博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pfan博客 新起点，新高度">
<meta property="og:type" content="website">
<meta property="og:title" content="pfan博客">
<meta property="og:url" content="http://pfan123.github.io/index.html">
<meta property="og:site_name" content="pfan博客">
<meta property="og:description" content="pfan博客 新起点，新高度">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pfan博客">
<meta name="twitter:description" content="pfan博客 新起点，新高度">
  
    <link rel="alternative" href="/atom.xml" title="pfan博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://litten.github.io/assets/blogImg/litten.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">pfan</a></h1>
		</hgroup>

		
		<p class="header-subtitle">新起点，新高度</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>		
					
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>

			</div>
		


		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
				        	<li class = "article_cate_tit"> 文章分类</li>
				        	<li class = "article_cate_a"> <a  href = "/categories/技术杂谈/">技术杂谈</a>	</li>
				        	<li class = "article_cate_a"> <a href = "/categories/兴趣爱好/">兴趣爱好</a>		</li>
				        	<li class = "article_cate_a"> <a href = "/categories/日志/">日志</a></li>
				        	<li class = "article_cate_a"> <a href = "/categories/JavaScript/">JavaScript</a>	</li>
				        	<li class = "article_cate_a"> <a  href = "/categories/CSS3/">CSS3</a>	</li>
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/pfan123" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/gaolu1990/home?wvr=5" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>



				<style type="text/css">
					.article_cate_tit{
						color:#ba8f6c;
						margin-top:6px;
					}
					.article_cate_con a{
						display:block;
						font-size:12px;
						text-align:center;
						margin:4px 0;
					}
					#header .header-menu{
						line-height:21px;
					}
					.article_cate_a{
						line-height:18px !important;
					}	
					.article_cate_a a{
						font-size:12px !important;
					}				
					#container .left-col .overlay{
						height:130px;
					}
					.header-nav{
						top:160px;
					}
				</style>	
				<!-- E 新增模块-->
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/gitignore-git/" style="font-size: 10px;">.gitignore git</a> <a href="/tags/htaccess-配置二级域名-绑定子目录/" style="font-size: 10px;">.htaccess  配置二级域名  绑定子目录</a> <a href="/tags/AMD/" style="font-size: 10px;">AMD</a> <a href="/tags/CMD/" style="font-size: 10px;">CMD</a> <a href="/tags/CSS-BEM-OOCSS/" style="font-size: 10px;">CSS BEM OOCSS</a> <a href="/tags/CSS动画篇/" style="font-size: 10px;">CSS动画篇</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/Git，Git查看历史记录/" style="font-size: 10px;">Git，Git查看历史记录</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/H5-视频直播-video/" style="font-size: 10px;">H5 视频直播 video</a> <a href="/tags/H5全景、CSS3d、perspective/" style="font-size: 15px;">H5全景、CSS3d、perspective</a> <a href="/tags/HLS、RTMP协议/" style="font-size: 10px;">HLS、RTMP协议</a> <a href="/tags/HTML5/" style="font-size: 15px;">HTML5</a> <a href="/tags/HTML5-视频直播-video-canvas/" style="font-size: 10px;">HTML5 视频直播 video canvas</a> <a href="/tags/HTML5、localstorage、sessionStorage/" style="font-size: 10px;">HTML5、localstorage、sessionStorage</a> <a href="/tags/HTML、XML解析、dom-level、htmlparser2、xmldom、sax-js、cheerio/" style="font-size: 10px;">HTML、XML解析、dom level、htmlparser2、xmldom、sax-js、cheerio</a> <a href="/tags/HTTP、-node-http-proxy、-nginx、-proxy/" style="font-size: 15px;">HTTP、 node-http-proxy、 nginx、 proxy</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Linux、CentOS/" style="font-size: 10px;">Linux、CentOS</a> <a href="/tags/Linux、UNIX/" style="font-size: 10px;">Linux、UNIX</a> <a href="/tags/Linux、Unix/" style="font-size: 20px;">Linux、Unix</a> <a href="/tags/Linux、Unix、nvm、node/" style="font-size: 10px;">Linux、Unix、nvm、node</a> <a href="/tags/Mac-命令-Terminal-osx/" style="font-size: 10px;">Mac 命令 Terminal osx</a> <a href="/tags/Mac、root/" style="font-size: 10px;">Mac、root</a> <a href="/tags/Math-atan-、Math-atan2-斜率/" style="font-size: 10px;">Math.atan()、Math.atan2() 斜率</a> <a href="/tags/Mongoose参考手册-MongoDB-数据库-node/" style="font-size: 10px;">Mongoose参考手册  MongoDB  数据库 node</a> <a href="/tags/Nginx-负载均衡/" style="font-size: 10px;">Nginx  负载均衡</a> <a href="/tags/Nginx-负载均衡-node-jdc-解决方案-host/" style="font-size: 10px;">Nginx  负载均衡 node  jdc 解决方案 host</a> <a href="/tags/Nginx-Mac-Node/" style="font-size: 10px;">Nginx Mac Node</a> <a href="/tags/Nginx-MySQL-PHP-FPM-Mac-OS/" style="font-size: 10px;">Nginx MySQL PHP-FPM Mac OS</a> <a href="/tags/Nodejs学习实践-nodejs-ES6/" style="font-size: 10px;">Nodejs学习实践 nodejs  ES6</a> <a href="/tags/PreloadJS-EaselJS-TweenJS-SoundJS/" style="font-size: 10px;">PreloadJS EaselJS TweenJS SoundJS</a> <a href="/tags/SVG-Sprites-Symbols/" style="font-size: 10px;">SVG Sprites Symbols</a> <a href="/tags/SVG-icon、-导出优化/" style="font-size: 10px;">SVG icon、 导出优化</a> <a href="/tags/SVG、dataURI、base64/" style="font-size: 10px;">SVG、dataURI、base64</a> <a href="/tags/UMD/" style="font-size: 10px;">UMD</a> <a href="/tags/Vim-vi/" style="font-size: 10px;">Vim vi</a> <a href="/tags/createJS/" style="font-size: 10px;">createJS</a> <a href="/tags/css-modules-scope-模块化/" style="font-size: 10px;">css modules  scope  模块化</a> <a href="/tags/deviceorientation、orientationchange-重力感应/" style="font-size: 10px;">deviceorientation、orientationchange 重力感应</a> <a href="/tags/deviceorientation、orientationchange-重力感应-CSS3D/" style="font-size: 10px;">deviceorientation、orientationchange 重力感应 CSS3D</a> <a href="/tags/express/" style="font-size: 10px;">express</a> <a href="/tags/fiddler/" style="font-size: 10px;">fiddler</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/hexo初始/" style="font-size: 10px;">hexo初始</a> <a href="/tags/hexo相关问题/" style="font-size: 10px;">hexo相关问题</a> <a href="/tags/howler-js、-video-js/" style="font-size: 10px;">howler.js、 video.js</a> <a href="/tags/insertAdjacentHTML方法/" style="font-size: 10px;">insertAdjacentHTML方法</a> <a href="/tags/insertAdjacentText方法/" style="font-size: 10px;">insertAdjacentText方法</a> <a href="/tags/javascript、canvas、toDataURL/" style="font-size: 10px;">javascript、canvas、toDataURL()</a> <a href="/tags/mac-iphone-铃声/" style="font-size: 10px;">mac iphone 铃声</a> <a href="/tags/node-版本管理-nvm-n/" style="font-size: 10px;">node 版本管理  nvm  n</a> <a href="/tags/node-读写excel-JS-XLSX-分析excel写入/" style="font-size: 10px;">node 读写excel JS-XLSX 分析excel写入</a> <a href="/tags/pm2学习实践-nodejs-pm2/" style="font-size: 10px;">pm2学习实践 nodejs pm2</a> <a href="/tags/react-flux-redux-ECMAScript6-Vue-Angular-Angular2-0-NuclearJS/" style="font-size: 10px;">react flux redux ECMAScript6 Vue Angular Angular2.0 NuclearJS</a> <a href="/tags/ssh常用命令-SSH/" style="font-size: 10px;">ssh常用命令  SSH</a> <a href="/tags/svg、path、circle、rect、ellipse、polygon、polyline、line/" style="font-size: 10px;">svg、path、circle、rect、ellipse、polygon、polyline、line</a> <a href="/tags/video-canvas/" style="font-size: 10px;">video canvas</a> <a href="/tags/vue-router-vue/" style="font-size: 10px;">vue-router, vue</a> <a href="/tags/webp/" style="font-size: 10px;">webp</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/三角学、弧度、角度/" style="font-size: 10px;">三角学、弧度、角度</a> <a href="/tags/买房前必备知识-house-home/" style="font-size: 10px;">买房前必备知识  house home</a> <a href="/tags/买车前必备知识-car/" style="font-size: 10px;">买车前必备知识  car</a> <a href="/tags/京东购物H5活动CP重构规范/" style="font-size: 10px;">京东购物H5活动CP重构规范</a> <a href="/tags/优化JavaScript的执行效率/" style="font-size: 10px;">优化JavaScript的执行效率</a> <a href="/tags/前端性能优化/" style="font-size: 10px;">前端性能优化</a> <a href="/tags/吉他/" style="font-size: 10px;">吉他</a> <a href="/tags/吉他知识/" style="font-size: 10px;">吉他知识</a> <a href="/tags/学吉他知识集锦/" style="font-size: 10px;">学吉他知识集锦</a> <a href="/tags/搬瓦工，Shadowsocks/" style="font-size: 10px;">搬瓦工，Shadowsocks</a> <a href="/tags/旅游-帝都畅游-相约北京/" style="font-size: 10px;">旅游 帝都畅游 相约北京</a> <a href="/tags/模块的写法/" style="font-size: 10px;">模块的写法</a> <a href="/tags/运营规范/" style="font-size: 10px;">运营规范</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/pingfan1990/">博客园博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.w3cfuns.com/house.php">前端网博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://pingfan1990.sinaapp.com/">pfan展示平台</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://doc.pfan123.com/">pfan前端开发导航平台</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">因上努力，果上随缘</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">pfan</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://litten.github.io/assets/blogImg/litten.png" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">pfan</h1>
			</hgroup>
			
			<p class="header-subtitle">新起点，新高度</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/pfan123" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/gaolu1990/home?wvr=5" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-Fiddler实战深入研究" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/28/Fiddler实战深入研究/" class="article-date">
  	<time datetime="2017-02-28T02:00:21.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/Fiddler实战深入研究/">Fiddler实战深入研究</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>本文介绍的工具是 <a href="http://www.telerik.com/fiddler" target="_blank" rel="external">Fiddler</a>，它能够在本机和服务端之间建立一个代理，通过这个代理，可以对所有经过的请求和响应进行拦截、修改、分析等。理论上说，只要你使用的软件支持代理，都可以用 Fiddler 进行拦截，包括浏览器、命令行等。</p>
<p>类似的软件有很多，比如 WireShark、HttpWatch 等，如果只是模拟发请求的话，Chrome 中有几个插件也很不错，比如 Postman、REST Client 等。</p>
<h2 id="基本术语"><a href="#基本术语" class="headerlink" title="基本术语"></a>基本术语</h2><h3 id="会话（Session）"><a href="#会话（Session）" class="headerlink" title="会话（Session）"></a>会话（Session）</h3><p>不同于服务端的 Session，这里仅仅指一次HTTP请求而已。会话面板在工具左侧，如下图所示。</p>
<p><img src="//img.pfan123.com/fiddler_1.png" alt="fiddler1"></p>
<p>图中显示了三条请求，每一列的具体含义都很清晰，认识英文单词就能懂了。</p>
<p>只是左边 # 号下的图标，帮各位找了一下，见下图。</p>
<p><img src="//img.pfan123.com/fiddler_2.png" alt="fiddler2"></p>
<p>默认情况下，一旦开启 Fiddler，就会走它的代理。想暂停这种行为，那请看到左下方有个状态栏。</p>
<p><img src="//img.pfan123.com/fiddler_3.png" alt="fiddler3"></p>
<p>单击一下左边的 Capturing，就能停止拦截，想再开启，就再单击一下。</p>
<p>它的右边是会话的来源，可以设置仅仅拦截浏览器发出的请求。</p>
<p>右边还有有三种选择：1、在请求发出之前进行断点；2、在响应回来的时候进行断点；3、不设断点。</p>
<h3 id="审查（Inspector）"><a href="#审查（Inspector）" class="headerlink" title="审查（Inspector）"></a>审查（Inspector）</h3><p>随便单击一条会话，右侧就会显示详细信息。</p>
<p><img src="//img.pfan123.com/fiddler_4.png" alt="fiddler4"></p>
<p>首先，这里有上下两栏，上面是 Request，下面是 Response。</p>
<p>Request 中有三个比较重要的：</p>
<ul>
<li>Headers、Cookies，并且可以对请求体格式化，以 WebForms、JSON、Raw 等方式查看。具体每种方式的区别可以自己感受一下。一般来说，想要查看请求的参数的话，WebForms 的方式就挺直观的。</li>
<li>AutoResponder：这个地方可以模拟服务端返回值。顾名思义，当浏览器发出的请求满足你设置的匹配条件的话，Fiddler 就自动响应了，并不需要走网络。</li>
<li>Composer：模拟向服务端发送请求，用于测试服务端接口是否正确。</li>
</ul>
<p>Response 中常用也有三个：</p>
<ul>
<li>Headers：响应头。比如 Content-Type、Access-Control-Allow-Origin 等这些属性都在这个 tab 展示。</li>
<li>Cookies：查看由服务端带回来的 cookie。</li>
<li>JSON：将返回的内容以 JSON 格式显示。这个很有用，特别是当服务端返回的内容本身就是 JSON 的时候。</li>
</ul>
<h2 id="QuickExec"><a href="#QuickExec" class="headerlink" title="QuickExec"></a>QuickExec</h2><p>它位于状态栏的上方，有个 QuickExec 的提示，非常显眼。</p>
<p>其实，当你看到它的时候，就已经会了第一个命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help</span><br></pre></td></tr></table></figure>
<p>输入<code>help</code>会带你到命令行的<a href="http://docs.telerik.com/fiddler/KnowledgeBase/QuickExec" target="_blank" rel="external">帮助页</a>，上面列举了所有可用的命令。不是很多，而且都很直观。这里同样把常用的列一下。</p>
<ul>
<li><code>?sometext</code>：高亮包含匹配文字的会话。比如 <code>?/foo</code> 就可以把所有包含 <code>/foo</code> 的请求都找出来。</li>
</ul>
<p>其他的高亮功能还有：=（匹配请求方法或状态码）、@（匹配host）、select（匹配MIME）。</p>
<ul>
<li>clear：清空会话面板。</li>
<li>keeponly：清空会话面板，仅保留指定的MIME类型。比如 <code>keeponly json</code> 就能筛选出所有返回 json 的会话。</li>
<li>go：放行所有的断点。</li>
</ul>
<h2 id="请求重定向-AutoResponder"><a href="#请求重定向-AutoResponder" class="headerlink" title="请求重定向(AutoResponder)"></a>请求重定向(AutoResponder)</h2><p>所谓请求在前端就是一些基本的css，js，图片等请求，重定向是指页面请求资源文件替换成其他需要替换成的文件。</p>
<p>比如目前需要调试线上某个js或者css文件等，可以使用fiddler捕获这个文件的请求，然后复制线上一份文件(比如JS或者css)代码放到本地，在本地的文件(JS或者css)修改完后，替换线上的文件来调式，当一切设置完毕之后，可以直接把代码提交到服务器上即可，如下所示：<br><img src="//img.pfan123.com/fiddler_5.png" alt="fiddler5"></p>
<p>如上：<code>Enable automatic responses</code> 复选框的含义是：控制是否激活 <code>AutoResponder</code> 选项卡，如果没有选中该选项，选项卡上的其他选项就不可选。</p>
<p><code>Unmatched  requests passthrough</code> 复选框的含义是： 如果选中该选项，不匹配的请求会正常发送到服务器，如果没有选中该选项，Fiddler会为所有和该规则完全不匹配的HTTP请求生成 HTTP/404 Not Found 响应，比如我现在不勾选它，如下所示：<br><img src="//img.pfan123.com/fiddler_6.png" alt="fiddler6"></p>
<p>那么现在再来访问淘宝网，就访问不了，提示如下所示：<br><img src="//img.pfan123.com/fiddler_7.png" alt="fiddler7"></p>
<p><code>Enable Latency</code>的含义是：控制匹配某个规则的请求时立即执行，还是延迟Latency字段中所指定的毫秒数。如果没有选中该选项，Latency字段就不会显示，使用这个选项可以更准确地模拟现实中的服务器响应，取消该选项可以提升性能。如下所示：<br><img src="//img.pfan123.com/fiddler_8.png" alt="fiddler8"></p>
<p>我们也可以点击右键进行毫秒数设置它，如下：<br><img src="//img.pfan123.com/fiddler_9.png" alt="fiddler9"></p>
<p>在下方的Rule Editor选项卡中可以调整上面的请求替换，如下：<br>第一个下拉框指需要替换的文件，第二个下拉框a.js是替换上面的下拉框的文件；当然不一定要这样替换，如果正则非常好的话，我们可以使用正则替换需要替换的文件。当我们点击 save后即可替换。</p>
<p><img src="//img.pfan123.com/fiddler_10.png" alt="fiddler10"></p>
<h2 id="Composer选项卡"><a href="#Composer选项卡" class="headerlink" title="Composer选项卡"></a>Composer选项卡</h2><p>Composer选项卡支持手动构建和发送HTTP，HTTPS和FTP请求，我们还可以从web session列表中拖曳session，把它放到composer选项卡中，当我们点击Execute按钮，把请求发送到服务器端。</p>
<p>Composer使用场景如下：</p>
<p>比如开发需要测试post请求接口，都知道浏览器请求只能是get请求，所以无法使用浏览器来测试，因此可以使用Composer构造post请求，点击execute发送请求。</p>
<p>Composer选项卡是由4个子选项卡组成的，如下所示：</p>
<p><img src="//img.pfan123.com/fiddler_11.png" alt="fiddler11"></p>
<p>其中 Scratchpad 选项卡基本不用，先看 <code>Options</code> 选项卡中 <code>Request Options</code> 的复选框中的含义如下：</p>
<p><code>Inspect  Session</code>  请求执行后，Inspectors选项卡会被激活，可以查看请求结果。</p>
<p><code>Fix Content-Length header*</code>  该选项控制Composer是否会自动添加或修改Content-Length请求头，表示请求体的大小。在很多情况下，缺少适当的Content-Length头的请求会导致http请求响应出错。</p>
<p><code>Follow Redirects*</code>  该选项控制Composer是否会自动使用响应的Location头，遵循HTTP/3xx重定向，如果选中该选项，Composer在失败之前最多会执行10次重定向。</p>
<p><code>Automatically Authenticate*</code>  该选项控制composer是否会自动响应服务器的HTTP/401或HTTP/407认证需求。</p>
<p><code>Tear off button</code>  该按钮会从主Fiddler窗口删除Composer，并把它作为独立的悬浮窗口打开。如果选中Inspect   Session选项，该选项就非常有用，因为它支持同时查看Composer和Inspector选项卡；</p>
<h2 id="断点调试"><a href="#断点调试" class="headerlink" title="断点调试"></a>断点调试</h2><p>这是Fiddler又一强大和实用的工具之一。通过设置断点，Fiddler可以做到：</p>
<ul>
<li><p>1.修改HTTP请求头信息。例如修改请求头的UA, Cookie, Referer 信息，通过“伪造”相应信息达到达到相应的目的（调试，模拟用户真实请求等）。</p>
</li>
<li><p>2.构造请求数据，突破表单的限制，随意提交数据。避免页面js和表单限制影响相关调试。</p>
</li>
<li><p>3.拦截响应数据，修改响应实体。</p>
</li>
</ul>
<p>为什么以上方法是重要的？假设js前端程序员和服务器程序员是分工合作的，js程序员想要调试Ajax请求的功能，这样便不必等待服务器端程序员开发好所有接口之后再开始开发js端的ajax请求功能，因为通过“模拟”真实的服务器端的响应，便可以保证功能的正确性，而服务器端开发程序员，只要保证最终的响应是符合规定的即可。这大大简化了程序开发的效率，当然也降低了不同业务线程序员联调的难度。</p>
<p>有两种方法设置断点：</p>
<ul>
<li>1.fiddler菜单栏-&gt;rules-&gt;automatic Breakpoints-&gt;选择断点方式，这种方式下设定的断点会对之后的所有HTTP请求有效。</li>
</ul>
<p>有两个断点位置：</p>
<blockquote>
<p>a. before response。也就是发送请求之后，但是Fiddler代理中转之前，这时可以修改请求的数据。</p>
<p>b.after response。也就是服务器响应之后，但是在Fiddler将响应中转给客户端之前。这时可以修改响应的结果。</p>
</blockquote>
<ul>
<li>2.命令行下输入。Bpafter xxx或者bpv,bpu,bpm等设置断点。这种断点只针对特定类型的请求。</li>
</ul>
<p>参考资料：</p>
<p><a href="http://docs.telerik.com/fiddler/KnowledgeBase/QuickExec" target="_blank" rel="external">Fiddler官方文档</a><br><a href="http://www.cnblogs.com/tugenhua0707/p/4637771.html#_labe4" target="_blank" rel="external">Fiddler实战深入研究</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fiddler/">fiddler</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Linux(CentOS)下设置nginx开机自动启动和chkconfig管理--转载" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/20/Linux(CentOS)下设置nginx开机自动启动和chkconfig管理--转载/" class="article-date">
  	<time datetime="2017-02-20T02:00:21.000Z" itemprop="datePublished">2017-02-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/20/Linux(CentOS)下设置nginx开机自动启动和chkconfig管理--转载/">Linux(CentOS)下设置nginx开机自动启动和chkconfig管理--转载</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Nginx 是一个很强大的高性能Web和反向代理服务器。虽然使用命令行可以对nginx进行各种操作，比如启动等，但是还是根据不太方便。下面介绍在linux下安装后，如何设置开机自启动。</p>
<h2 id="配置自动启动"><a href="#配置自动启动" class="headerlink" title="配置自动启动"></a>配置自动启动</h2><p>首先，在linux系统的/etc/init.d/目录下创建nginx文件，使用如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/init.d/nginx</span><br></pre></td></tr></table></figure>
<p>在脚本中添加如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">#</span><br><span class="line"># nginx - this script starts and stops the nginx daemon</span><br><span class="line">#</span><br><span class="line"># chkconfig:   - 85 15</span><br><span class="line"># description:  NGINX is an HTTP(S) server, HTTP(S) reverse \</span><br><span class="line">#               proxy and IMAP/POP3 proxy server</span><br><span class="line"># processname: nginx</span><br><span class="line"># config:      /etc/nginx/nginx.conf</span><br><span class="line"># config:      /etc/sysconfig/nginx</span><br><span class="line"># pidfile:     /var/run/nginx.pid</span><br><span class="line"></span><br><span class="line"># Source function library.</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"></span><br><span class="line"># Source networking configuration.</span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"></span><br><span class="line"># Check that networking is up.</span><br><span class="line">[ &quot;$NETWORKING&quot; = &quot;no&quot; ] &amp;&amp; exit 0</span><br><span class="line"></span><br><span class="line">nginx=&quot;/usr/sbin/nginx&quot;</span><br><span class="line">prog=$(basename $nginx)</span><br><span class="line"></span><br><span class="line">NGINX_CONF_FILE=&quot;/etc/nginx/nginx.conf&quot;</span><br><span class="line"></span><br><span class="line">[ -f /etc/sysconfig/nginx ] &amp;&amp; . /etc/sysconfig/nginx</span><br><span class="line"></span><br><span class="line">lockfile=/var/lock/subsys/nginx</span><br><span class="line"></span><br><span class="line">make_dirs() &#123;</span><br><span class="line">   # make required directories</span><br><span class="line">   user=`$nginx -V 2&gt;&amp;1 | grep &quot;configure arguments:.*--user=&quot; | sed &apos;s/[^*]*--user=\([^ ]*\).*/\1/g&apos; -`</span><br><span class="line">   if [ -n &quot;$user&quot; ]; then</span><br><span class="line">      if [ -z &quot;`grep $user /etc/passwd`&quot; ]; then</span><br><span class="line">         useradd -M -s /bin/nologin $user</span><br><span class="line">      fi</span><br><span class="line">      options=`$nginx -V 2&gt;&amp;1 | grep &apos;configure arguments:&apos;`</span><br><span class="line">      for opt in $options; do</span><br><span class="line">          if [ `echo $opt | grep &apos;.*-temp-path&apos;` ]; then</span><br><span class="line">              value=`echo $opt | cut -d &quot;=&quot; -f 2`</span><br><span class="line">              if [ ! -d &quot;$value&quot; ]; then</span><br><span class="line">                  # echo &quot;creating&quot; $value</span><br><span class="line">                  mkdir -p $value &amp;&amp; chown -R $user $value</span><br><span class="line">              fi</span><br><span class="line">          fi</span><br><span class="line">       done</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">start() &#123;</span><br><span class="line">    [ -x $nginx ] || exit 5</span><br><span class="line">    [ -f $NGINX_CONF_FILE ] || exit 6</span><br><span class="line">    make_dirs</span><br><span class="line">    echo -n $&quot;Starting $prog: &quot;</span><br><span class="line">    daemon $nginx -c $NGINX_CONF_FILE</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; touch $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop() &#123;</span><br><span class="line">    echo -n $&quot;Stopping $prog: &quot;</span><br><span class="line">    killproc $prog -QUIT</span><br><span class="line">    retval=$?</span><br><span class="line">    echo</span><br><span class="line">    [ $retval -eq 0 ] &amp;&amp; rm -f $lockfile</span><br><span class="line">    return $retval</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">restart() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    stop</span><br><span class="line">    sleep 1</span><br><span class="line">    start</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reload() &#123;</span><br><span class="line">    configtest || return $?</span><br><span class="line">    echo -n $&quot;Reloading $prog: &quot;</span><br><span class="line">    killproc $nginx -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    echo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">force_reload() &#123;</span><br><span class="line">    restart</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configtest() &#123;</span><br><span class="line">  $nginx -t -c $NGINX_CONF_FILE</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status() &#123;</span><br><span class="line">    status $prog</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rh_status_q() &#123;</span><br><span class="line">    rh_status &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    start)</span><br><span class="line">        rh_status_q &amp;&amp; exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    restart|configtest)</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    reload)</span><br><span class="line">        rh_status_q || exit 7</span><br><span class="line">        $1</span><br><span class="line">        ;;</span><br><span class="line">    force-reload)</span><br><span class="line">        force_reload</span><br><span class="line">        ;;</span><br><span class="line">    status)</span><br><span class="line">        rh_status</span><br><span class="line">        ;;</span><br><span class="line">    condrestart|try-restart)</span><br><span class="line">        rh_status_q || exit 0</span><br><span class="line">            ;;</span><br><span class="line">    *)</span><br><span class="line">        echo $&quot;Usage: $0 &#123;start|stop|status|restart|condrestart|try-restart|reload|force-reload|configtest&#125;&quot;</span><br><span class="line">        exit 2</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<p>这个脚本其实也不是我写的，谁写的呢，nginx官方写的，脚本地址：<a href="https://www.nginx.com/resources/wiki/start/topics/examples/redhatnginxinit/" target="_blank" rel="external">http://wiki.nginx.org/RedHatNginxInitScript</a> ，不过要注意，如果你是自定义编译安装的nginx，需要根据您的安装路径修改下面这两项配置：</p>
<p>nginx=”/usr/sbin/nginx” 修改成nginx执行程序的路径。</p>
<p>NGINX_CONF_FILE=”/etc/nginx/nginx.conf” 修改成配置文件的路径。</p>
<p>保存脚本文件后<code>设置文件的执行权限</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod a+x /etc/init.d/nginx</span><br></pre></td></tr></table></figure>
<p>然后，就可以通过该脚本对nginx服务进行管理了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/nginx start</span><br><span class="line">/etc/init.d/nginx stop</span><br></pre></td></tr></table></figure>
<h2 id="使用chkconfig进行管理"><a href="#使用chkconfig进行管理" class="headerlink" title="使用chkconfig进行管理"></a>使用chkconfig进行管理</h2><p>上面的方法完成了用脚本管理nginx服务的功能，但是还是不太方便，比如要设置nginx开机启动等。这时可以使用chkconfig来设置。</p>
<p>先将nginx服务加入chkconfig管理列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig --add /etc/init.d/nginx</span><br></pre></td></tr></table></figure>
<p>加完这个之后，就可以使用service对nginx进行启动，重启等操作了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service nginx start</span><br><span class="line">service nginx stop</span><br></pre></td></tr></table></figure>
<p>设置终端模式开机启动：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig nginx on</span><br></pre></td></tr></table></figure></p>
<p>chkconfig命令的使用方法，就不多数啦，可以自行搜索</p>
<h2 id="其他方案"><a href="#其他方案" class="headerlink" title="其他方案"></a>其他方案</h2><p>另外这里还有一个网友分享的脚本（脚本地址：<a href="http://blog.163.com/qsc0624@126/blog/static/140324073201312734548701/" target="_blank" rel="external">http://blog.163.com/qsc0624@126/blog/static/140324073201312734548701/</a>）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"># nginx Startup script for the Nginx HTTP Server</span><br><span class="line"># it is v.0.0.2 version.</span><br><span class="line"># chkconfig: - 85 15</span><br><span class="line"># description: Nginx is a high-performance web and proxy server.</span><br><span class="line">#              It has a lot of features, but it&apos;s not for everyone.</span><br><span class="line"># processname: nginx</span><br><span class="line"># pidfile: /var/run/nginx.pid</span><br><span class="line"># config: /usr/local/nginx/conf/nginx.conf</span><br><span class="line">nginxd=/usr/local/nginx/sbin/nginx</span><br><span class="line">nginx_config=/usr/local/nginx/conf/nginx.conf</span><br><span class="line">nginx_pid=/var/run/nginx.pid</span><br><span class="line">RETVAL=0</span><br><span class="line">prog=&quot;nginx&quot;</span><br><span class="line"># Source function library.</span><br><span class="line">. /etc/rc.d/init.d/functions</span><br><span class="line"># Source networking configuration.</span><br><span class="line">. /etc/sysconfig/network</span><br><span class="line"># Check that networking is up.</span><br><span class="line">[ $&#123;NETWORKING&#125; = &quot;no&quot; ] &amp;&amp; exit 0</span><br><span class="line">[ -x $nginxd ] || exit 0</span><br><span class="line"># Start nginx daemons functions.</span><br><span class="line">start() &#123;</span><br><span class="line">if [ -e $nginx_pid ];then</span><br><span class="line">   echo &quot;nginx already running....&quot;</span><br><span class="line">   exit 1</span><br><span class="line">fi</span><br><span class="line">   echo -n $&quot;Starting $prog: &quot;</span><br><span class="line">   daemon $nginxd -c $&#123;nginx_config&#125;</span><br><span class="line">   RETVAL=$?</span><br><span class="line">   echo</span><br><span class="line">   [ $RETVAL = 0 ] &amp;&amp; touch /var/lock/subsys/nginx</span><br><span class="line">   return $RETVAL</span><br><span class="line">&#125;</span><br><span class="line"># Stop nginx daemons functions.</span><br><span class="line">stop() &#123;</span><br><span class="line">        echo -n $&quot;Stopping $prog: &quot;</span><br><span class="line">        killproc $nginxd</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        echo</span><br><span class="line">        [ $RETVAL = 0 ] &amp;&amp; rm -f /var/lock/subsys/nginx /var/run/nginx.pid</span><br><span class="line">&#125;</span><br><span class="line"># reload nginx service functions.</span><br><span class="line">reload() &#123;</span><br><span class="line">    echo -n $&quot;Reloading $prog: &quot;</span><br><span class="line">    #kill -HUP `cat $&#123;nginx_pid&#125;`</span><br><span class="line">    killproc $nginxd -HUP</span><br><span class="line">    RETVAL=$?</span><br><span class="line">    echo</span><br><span class="line">&#125;</span><br><span class="line"># See how we were called.</span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">start)</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">stop)</span><br><span class="line">        stop</span><br><span class="line">        ;;</span><br><span class="line">reload)</span><br><span class="line">        reload</span><br><span class="line">        ;;</span><br><span class="line">restart)</span><br><span class="line">        stop</span><br><span class="line">        start</span><br><span class="line">        ;;</span><br><span class="line">status)</span><br><span class="line">        status $prog</span><br><span class="line">        RETVAL=$?</span><br><span class="line">        ;;</span><br><span class="line">*)</span><br><span class="line">        echo $&quot;Usage: $prog &#123;start|stop|restart|reload|status|help&#125;&quot;</span><br><span class="line">        exit 1</span><br><span class="line">esac</span><br><span class="line">exit $RETVAL</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Nginx 安装配置</a><br><a href="http://www.cnblogs.com/peida/tag/linux%E5%91%BD%E4%BB%A4/" target="_blank" rel="external">linux 命令学习教程</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、Unix/">Linux、Unix</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-CentOS系统环境下安装MongoDB" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/07/CentOS系统环境下安装MongoDB/" class="article-date">
  	<time datetime="2017-02-07T02:00:21.000Z" itemprop="datePublished">2017-02-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/07/CentOS系统环境下安装MongoDB/">CentOS系统环境下安装MongoDB</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Linux平台安装MongoDB"><a href="#Linux平台安装MongoDB" class="headerlink" title="Linux平台安装MongoDB"></a>Linux平台安装MongoDB</h2><p>MongoDB提供了linux平台上32位和64位的安装包，你可以在官网下载安装包。<br>下载地址：(<a href="http://www.mongodb.org/downloads)[http://www.mongodb.org/downloads" target="_blank" rel="external">http://www.mongodb.org/downloads)[http://www.mongodb.org/downloads</a>]</p>
<p><img src="http://www.runoob.com/wp-content/uploads/2013/10/MongoDB-Linux.jpg" alt="Linux文件目录1"></p>
<p>1.查看系统，判定系统位数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure>
<p>如果输出的信息包含 x86_64 说明你的系统是64位,如果不包含说明是32位系统.</p>
<p>2.下载完安装包，并解压 tgz（以下演示的是 32 位 Linux上的安装） </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-i686-3.0.6.tgz  # 下载</span><br><span class="line"></span><br><span class="line">tar -zxvf mongodb-linux-i686-3.0.6.tgz                                 # 解压</span><br><span class="line"></span><br><span class="line">mv mongodb-linux-i686-3.0.6 /usr/local/mongodb   # 将解压包拷贝到指定目录</span><br></pre></td></tr></table></figure>
<p>3.MongoDB 的可执行文件位于 bin 目录下，所以可以将其添加到 PATH 路径中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=&lt;mongodb-install-directory&gt;/bin:$PATH</span><br></pre></td></tr></table></figure>
<p><code>&lt;mongodb-install-directory&gt;</code> 为你 MongoDB 的安装路径。如本文的 <code>/usr/local/mongodb</code> 。</p>
<p>4.创建数据库目录</p>
<p>MongoDB的数据存储在data目录的db目录下，但是这个目录在安装过程不会自动创建，所以你需要手动创建data目录，并在data目录中创建db目录。</p>
<p>进入mongodb目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/mongodb</span><br></pre></td></tr></table></figure>
<p>新建自定义数据目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ./data/db/</span><br></pre></td></tr></table></figure>
<p>新建日志目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir logs</span><br></pre></td></tr></table></figure>
<p>5.命令行中运行 MongoDB 服务</p>
<p>你可以再命令行中执行mongo安装目录中的bin目录执行mongod命令来启动mongdb服务。</p>
<blockquote>
<p>注意：如果你的数据库目录不是/data/db，可以通过 –dbpath 来指定。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">进入bin目录</span><br><span class="line">cd /usr/local/mongodb/bin/</span><br><span class="line"></span><br><span class="line">启动 mongodb</span><br><span class="line">./mongod</span><br></pre></td></tr></table></figure>
<p>以后台运行方式启动mongodb</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/mongodb/bin/mongod --dbpath=/usr/local/mongodb/data/db --logpath=/usr/local/mongodb/logs/mongodb.log --fork</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">显示</span><br><span class="line">forked process: 18261</span><br><span class="line">all output going to: /usr/local/mongodb/logs/mongodb.log</span><br><span class="line">log file [/usr/local/mongodb/logs/mongodb.log] exists; copied to temporary file [/usr/local/mongodb/logs/mongodb.log.2013-03-01T04-04-28]</span><br><span class="line">child process started successfully, parent exiting</span><br></pre></td></tr></table></figure>
<p>设置开机自启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/usr/local/mongodb/bin/mongod --dbpath=/usr/local/mongodb/data/db --logpath=/usr/local/mongodb/logs/mongodb.log --fork&quot; &gt;&gt; /etc/rc.local</span><br></pre></td></tr></table></figure>
<p>查看MongoDB日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f /usr/local/mongodb/logs/mongodb.log</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="http://www.runoob.com/mongodb/mongodb-linux-install.html" target="_blank" rel="external">Linux平台安装MongoDB</a></p>
<p><a href="http://yijiebuyi.com/blog/9daac70a111e4c3298a4cb69b5dc6214.html" target="_blank" rel="external">CentOS 中使用 yum 安装 mongodb</a></p>
<p><a href="https://my.oschina.net/chinaearl/blog/111077" target="_blank" rel="external">CentOS系统环境下安装MongoDB</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、Unix/">Linux、Unix</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Linux 使用nvm安装node" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/06/Linux 使用nvm安装node/" class="article-date">
  	<time datetime="2017-02-06T07:00:21.000Z" itemprop="datePublished">2017-02-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/06/Linux 使用nvm安装node/">Linux 使用nvm安装node</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="NVM安装"><a href="#NVM安装" class="headerlink" title="NVM安装"></a>NVM安装</h2><p>NVM（Node version manager）顾名思义，就是Node.js的版本管理软件，可以轻松的在Node.js各个版本间切换，项目源码 <a href="https://github.com/creationix/nvm" target="_blank" rel="external">GitHub</a>。</p>
<p>1.下载并安装NVM脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl https://raw.githubusercontent.com/creationix/nvm/v0.13.1/install.sh | bash</span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>2.列出所需要的版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm list-remote</span><br></pre></td></tr></table></figure>
<p>返回结果如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">. . .</span><br><span class="line">	  v5.4.0</span><br><span class="line">      v5.4.1</span><br><span class="line">      v5.5.0</span><br><span class="line">      v5.6.0</span><br><span class="line">      v5.7.0</span><br><span class="line">     v5.10.0</span><br><span class="line">     v5.10.1</span><br><span class="line">     v5.11.0</span><br><span class="line">     v5.11.1</span><br><span class="line">     v5.12.0</span><br><span class="line">      v6.9.1</span><br><span class="line">      v6.9.2</span><br><span class="line">      v6.9.3</span><br><span class="line">      v6.9.4</span><br><span class="line">      v6.9.5</span><br><span class="line">      v7.0.0</span><br><span class="line">      v7.1.0</span><br><span class="line">      v7.2.0</span><br><span class="line">      v7.2.1</span><br><span class="line">      v7.3.0</span><br><span class="line">      v7.4.0</span><br><span class="line">      v7.5.0</span><br></pre></td></tr></table></figure>
<p>3.安装相应的版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install v5.4.0</span><br></pre></td></tr></table></figure>
<p>4.查看已安装的版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nvm list</span><br><span class="line"></span><br><span class="line">-&gt;  v0.10.30</span><br><span class="line">      system</span><br></pre></td></tr></table></figure>
<p>5.切换版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm use v5.4.0</span><br></pre></td></tr></table></figure>
<p>6.设置默认版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm alias default v5.4.0</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="https://cnbin.github.io/blog/2015/06/23/linux-xia-ge-ge-mu-lu-de-zuo-yong-ji-nei-rong/" target="_blank" rel="external">Linux 下各个目录的作用及内容</a></p>
<p><a href="http://linux-wiki.cn/wiki/zh-hans/Linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" target="_blank" rel="external">Linux目录结构</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2012/02/a_history_of_unix_directory_structure.html" target="_blank" rel="external">Unix目录结构的来历</a></p>
<p><a href="http://blog.csdn.net/csfreebird/article/details/48804797" target="_blank" rel="external">Linux常见目录使用区别</a></p>
<p><a href="http://www.imooc.com/article/12746" target="_blank" rel="external">Linux常用命令 帮助命令</a></p>
<p><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Nginx 安装配置</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、Unix、nvm、node/">Linux、Unix、nvm、node</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Linux 下各个目录的作用--转载" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/04/Linux 下各个目录的作用--转载/" class="article-date">
  	<time datetime="2017-02-04T02:00:21.000Z" itemprop="datePublished">2017-02-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/04/Linux 下各个目录的作用--转载/">Linux 下各个目录的作用--转载</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Linux-目录"><a href="#Linux-目录" class="headerlink" title="Linux 目录"></a>Linux 目录</h2><p>在早期的 <code>UNIX</code> 系统中，各个厂家各自定义了自己的 <code>UNIX</code> 系统文件目录，比较混乱。<code>Linux</code> 面世不久后，对文件目录进行了标准化，于1994年对根文件目录做了统一的规范，推出 FHS ( Filesystem Hierarchy Standard ) 的 <code>Linux</code> 文件系统层次结构标准。FHS 标准规定了 Linux 根目录各文件夹的名称及作用，统一了 <code>Linux</code> 界命名混乱的局面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">＃ cd /</span><br><span class="line">＃ ls</span><br><span class="line"></span><br><span class="line">//显示如下 root是根目录</span><br><span class="line">aquota.group  bin   dev  home  lost+found  mnt  proc  sbin     srv  tmp  var</span><br><span class="line">aquota.user   boot  etc  lib   media       opt  root  selinux  sys  usr</span><br></pre></td></tr></table></figure>
<p>无论何种版本的 <code>Linux</code> 发行版，桌面、应用是 <code>Linux</code> 的外衣，文件组织、目录结构才是 <code>Linux</code> 的内心。</p>
<p><code>FHS</code>（英文：<code>Filesystem Hierarchy Standard</code> 中文：文件系统层次结构标准），多数 Linux 版本采用这种文件组织形式，FHS 定义了系统中每个区域的用途、所需要的最小构成的文件和目录同时还给出了例外处理与矛盾处理。 FHS 定义了两层规范，第一层是， <code>/</code> 下面的各个目录应该要放什么文件数据，例如 <code>/etc</code> 应该要放置设置文件，<code>/bin</code> 与 <code>/sbin</code> 则应该要放置可执行文件等等。</p>
<p>第二层则是针对 <code>/usr</code> 及 <code>/var</code> 这两个目录的子目录来定义。例如 <code>/var/log</code> 放置系统登录文件、 <code>/usr/share</code> 放置共享数据等等。</p>
<p><code>FHS</code> 是根据以往无数 Linux 用户和开发者的经验总结出来的，并且会维持更新，FHS 依据文件系统使用的频繁与否以及是否允许用户随意改动（注意，不是不能，学习过程中，不要怕这些），将目录定义为四种交互作用的形态，如下表所示：</p>
<p><img src="http://ww2.sinaimg.cn/mw690/78f9859egw1etd2zfi9t1j20sx061tb4.jpg" alt="Linux文件目录1"></p>
<p><code>/</code>：根目录，一般根目录下只存放目录，不要存放件，/etc、/bin、/dev、/lib、/sbin应该和根目录放置在一个分区中</p>
<p><img src="http://ww3.sinaimg.cn/mw690/78f9859egw1etbt8f77f2j20io0bsgm4.jpg" alt="Linux文件目录2"></p>
<p><code>/bin</code>: <code>/usr/bin</code>: 可执行二进制文件的目录，如常用的命令ls、tar、mv、cat等。</p>
<p><code>/boot</code>：放置linux系统启动时用到的一些文件。/boot/vmlinuz 为 linux 的内核文件，以及 /boot/gurb。建议单独分区，分区大小100M即可</p>
<p><code>/dev</code>：存放linux系统下的设备文件，访问该目录下某个文件，相当于访问某个设备，常用的是挂载光驱 mount /dev/cdrom /mnt。</p>
<p><code>/etc</code>：系统配置文件存放的目录，不建议在此目录下存放可执行文件，重要的配置文件有 /etc/inittab、/etc/fstab、/etc/init.d、/etc/X11、/etc/sysconfig、/etc/xinetd.d修改配置文件之前记得备份。</p>
<blockquote>
<p>注：/etc/X11 存放与 x windows 有关的设置。</p>
</blockquote>
<p><code>/home</code>：系统默认的用户家目录，新增用户账号时，用户的家目录都存放在此目录下，~表示当前用户的家目录，~edu 表示用户 edu 的家目录。建议单独分区，并设置较大的磁盘空间，方便用户存放数据</p>
<p><code>/lib</code>: <code>/usr/lib</code>: <code>/usr/local/lib</code>：系统使用的函数库的目录，程序在执行过程中，需要调用一些额外的参数时需要函数库的协助，比较重要的目录为 /lib/modules。</p>
<p><code>/lost+fount</code>：系统异常产生错误时，会将一些遗失的片段放置于此目录下，通常这个目录会自动出现在装置目录下。如加载硬盘于 /disk 中，此目录下就会自动产生目录 /disk/lost+found</p>
<p><code>/mnt</code>: <code>/media</code>：光盘默认挂载点，通常光盘挂载于 /mnt/cdrom 下，也不一定，可以选择任意位置进行挂载。</p>
<p><code>/opt</code>：给主机额外安装软件所摆放的目录。如：FC4使用的Fedora 社群开发软件，如果想要自行安装新的 KDE 桌面软件，可以将该软件安装在该目录下。以前的 Linux 系统中，习惯放置在 /usr/local 目录下</p>
<p><code>/proc</code>：此目录的数据都在内存中，如系统核心，外部设备，网络状态，由于数据都存放于内存中，所以不占用磁盘空间，比较重要的目录有 /proc/cpuinfo、/proc/interrupts、/proc/dma、/proc/ioports、/proc/net/* 等。</p>
<p><code>/root</code>：系统管理员root的家目录，系统第一个启动的分区为 /，所以最好将 /root和 /放置在一个分区下。</p>
<p><code>/sbin</code>: <code>/usr/sbin</code>: <code>/usr/local/sbin</code>：放置系统管理员使用的可执行命令，如fdisk、shutdown、mount 等。与 /bin 不同的是，这几个目录是给系统管理员 root使用的命令，一般用户只能”查看”而不能设置和使用。</p>
<p><code>/tmp</code>：一般用户或正在执行的程序临时存放文件的目录，任何人都可以访问，重要数据不可放置在此目录下</p>
<p><code>/srv</code>：服务启动之后需要访问的数据目录，如 www 服务需要访问的网页数据存放在 /srv/www 内。</p>
<p><code>/usr</code>：应用程序存放目录，/usr/bin 存放应用程序，/usr/share 存放共享数据，/usr/lib 存放不能直接运行的，却是许多程序运行所必需的一些函数库文件。/usr/local: 存放软件升级包。/usr/share/doc: 系统说明文件存放目录。/usr/share/man: 程序说明文件存放目录，使用 man ls 时会查询 /usr/share/man/man1/ls.1.gz 的内容建议单独分区，设置较大的磁盘空间。</p>
<p><code>/var</code>：放置系统执行过程中经常变化的文件，如随时更改的日志文件 /var/log，/var/log/message：所有的登录文件存放目录，/var/spool/mail：邮件存放的目录，/var/run:程序或服务启动后，其PID存放在该目录下。建议单独分区，设置较大的磁盘空间。</p>
<h2 id="一切皆文件"><a href="#一切皆文件" class="headerlink" title="一切皆文件"></a>一切皆文件</h2><p>Linux 对数据文件(.mp3、.bmp)，程序文件(.c、.h、*.o)，设备文件（LCD、触摸屏、鼠标），网络文件( socket ) 等的管理都抽象为文件，使用统一的方式方法管理。</p>
<p>文件分类：</p>
<p>1）普通文件( 数据文件 )</p>
<p>普通文件是用于存放数据、程序等信息的文件，一般都长期地存放在外存储器（磁盘）中。普通文件又分为文本文件和二进制文件。</p>
<p>2）目录文件</p>
<p>目录文件是文件系统中一个目录所包含的目录项所组成的文件。</p>
<p>3）设备文件</p>
<p>设备文件是用于为操作系统与设备提供连接的一种文件。在Linux系统中将设备作为文件来处理，操作设备就像是操作普通文件一样。每一个设备对应一个设备文件，存放在 /dev 目录中。</p>
<p>5）链接文件</p>
<p>似于 windows 下的快捷方式，链接又可以分为软链接（符号链接）和硬链接。</p>
<p>6）管道文件</p>
<p>管道文件主要用于在进程间传递数据的一种特殊文件。</p>
<p>7）套接口文件</p>
<p>主要用于不同计算机间网络通信的一种特殊文件。</p>
<p><img src="http://ww1.sinaimg.cn/mw690/78f9859egw1etcuy8qxfvj20hp0h2te0.jpg" alt="Linux文件目录3"></p>
<p><img src="http://ww3.sinaimg.cn/mw690/78f9859egw1etd2vg2ad8j20yn12kwlq.jpg" alt="Linux文件目录4"></p>
<p>参考资料：</p>
<p><a href="https://cnbin.github.io/blog/2015/06/23/linux-xia-ge-ge-mu-lu-de-zuo-yong-ji-nei-rong/" target="_blank" rel="external">Linux 下各个目录的作用及内容</a></p>
<p><a href="http://linux-wiki.cn/wiki/zh-hans/Linux%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" target="_blank" rel="external">Linux目录结构</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2012/02/a_history_of_unix_directory_structure.html" target="_blank" rel="external">Unix目录结构的来历</a></p>
<p><a href="http://blog.csdn.net/csfreebird/article/details/48804797" target="_blank" rel="external">Linux常见目录使用区别</a></p>
<p><a href="http://www.imooc.com/article/12746" target="_blank" rel="external">Linux常用命令 帮助命令</a></p>
<p><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Nginx 安装配置</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、Unix/">Linux、Unix</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-搬瓦工VPS快速搭建Shadowsocks服务器" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/03/搬瓦工VPS快速搭建Shadowsocks服务器/" class="article-date">
  	<time datetime="2017-02-03T15:00:21.000Z" itemprop="datePublished">2017-02-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/03/搬瓦工VPS快速搭建Shadowsocks服务器/">搬瓦工VPS快速搭建Shadowsocks服务器</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="shaowsocks安装"><a href="#shaowsocks安装" class="headerlink" title="shaowsocks安装"></a>shaowsocks安装</h2><p>搬瓦工自带 <code>shaowsocks</code> 一键安装，左侧菜单栏找到 <code>Shadowsocks Server</code> ，点进去安装就好了（注意：搬瓦工提供的一键安装功能只支持CentOS6，你也可以通过命令行的方式安装），安装好的 <code>Shadowsocks Server</code> 界面是这样的：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1787336-dcc98c63956bccf1.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="shaowsocks安装成功图片1"></p>
<p>此时VPN已经可以用了，还需要客户端，Windows版本的客户端在后台面板就有链接，Mac用户我已经下载好放到我的网盘了 <a href="https://pan.baidu.com/s/1bpgRndH" target="_blank" rel="external">ShadowsocksX-2.6.3.dmg</a>，安装好打开 <code>Shadowsocks Server</code> ，在Mac的工具栏会有一个小飞机的图标</p>
<blockquote>
<p>由于iPhone的Shadowsocks Server只在英国地区销售，国内的AppStore是下载不到的，大家可以在AppStore搜wingy，配置过程跟mac差不多，主要是IP、 Port和密码，加密协议都用默认的aes-256-cfb就行，然后手机也可以愉快的上网了。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/1787336-bc0272263128ee87.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="shaowsocks安装成功图片2"></p>
<p>点开服务器，配置IP和密码，只需要修改地址和密码，其他不用改就OK了。<br><img src="http://upload-images.jianshu.io/upload_images/1787336-afddffb57d20deaa.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="shaowsocks安装成功图片3"></p>
<p>上两张图显示 <code>Shadowsocks Server</code> 有两种加速模式 ，<code>一般情况下勾选自动代理模式就可以了，这个这个模式下会自动判断你当前访问的域名是否在GFW名单里面，如果是就启用代理，如果不是就正常访问，这样我们在访问墙内网站的时候也不会受到任何影响</code> ，如果你遇到网站无法访问，有可能是这个网站近期被墙了，你没有更新本地的GFW名单，如果你确定这个网站是可以打开的，切换到全局模式就可以访问了。</p>
<blockquote>
<p>Shadowsocks Server自动代理模式原理是根据GFWList配置了一个PAC文件，名单中的域名全部走代理，你可以手动修改这个配置文件，添加你要访问的被墙的网站，它就是一个js文件，你点击编辑自动模式的PAC文件便会跳转到这个js所在的位置，那个GFWList自动更新功能坏掉了，作者一直也没更新，不过不影响平时使用。</p>
</blockquote>
<h2 id="net-speeder加速VPN"><a href="#net-speeder加速VPN" class="headerlink" title="net_speeder加速VPN"></a>net_speeder加速VPN</h2><p>完成以上操作，就可以访问墙外网站外了，但是速度不怎么快。可以使用 Speeder 给 VPN 加速具体如下：</p>
<p>1.先连上远程主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.243.112.242 -p 26244</span><br></pre></td></tr></table></figure>
<p>注意把端口和IP换成你自己主机的，然后需要输入root密码，输入在第一步我们设置的密码就可以了。</p>
<p>2.安装Net-Speeder</p>
<p>输入下面的命令进行安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://coding.net/u/njzhenghao/p/download/git/raw/master/net_speeder-installer.sh</span><br></pre></td></tr></table></figure>
<p>3.编译并安装</p>
<p>输入下面的命令编译Net-Speeder：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash net_speeder-installer.sh</span><br></pre></td></tr></table></figure>
<p>命令执行成功之后，执行 <code>reboot</code> 重启主机，或者在后台面板重启主机也行。（<code>此时远程主机的连接会断开，需要重新连接</code>）</p>
<p>4.端口加速</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup /usr/local/net_speeder/net_speeder venet0 &quot;ip&quot; &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<p>执行完这个命令应该会有一个端口号打印出来，证明加速成功了！还有最后一步，点开 <code>Shadowsocks Server</code> 菜单点击退出，不要点关闭 <code>Shadowsocks Server</code> ，然后再次打开App，现在打开YouTube看个视频试试吧！现在墙外网站下载速度一般都在500KB左右，当然这个速度也受到你所在运营商的网络环境影响。（注意：加速端口这个命令每次重启主机都需要执行一次，因这个脚本没有加到开机自启动）</p>
<p>参考资料：</p>
<p><a href="http://www.cnblogs.com/yfming/p/6337301.html" target="_blank" rel="external">租用搬瓦工 VPS 自建高速丝滑 VPN</a></p>
<p><a href="https://blog.phpgao.com/vps_net_speeder.html" target="_blank" rel="external">使用net_speeder加速你的VPS</a></p>
<p><a href="http://www.jianshu.com/p/57f45490620c" target="_blank" rel="external">搬瓦工VPS搭建高速VPN服务器</a></p>
<p><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Linux 教程</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搬瓦工，Shadowsocks/">搬瓦工，Shadowsocks</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-如何在CentOS 6.x:7.x上安装git及最新版" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/03/如何在CentOS 6.x:7.x上安装git及最新版/" class="article-date">
  	<time datetime="2017-02-03T10:00:21.000Z" itemprop="datePublished">2017-02-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/03/如何在CentOS 6.x:7.x上安装git及最新版/">CentOS 6.x安装git及最新版</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="方式一、yum安装"><a href="#方式一、yum安装" class="headerlink" title="方式一、yum安装"></a>方式一、yum安装</h2><blockquote>
<p>通过yum方式安装，版本比较旧，CentOS6.5上安装好是1.7.1版。如果想安装最新版或其他版本，需要使用源码编译安装的方式。</p>
</blockquote>
<h2 id="方式二、源码包安装"><a href="#方式二、源码包安装" class="headerlink" title="方式二、源码包安装"></a>方式二、源码包安装</h2><p>步骤1. 安装依赖包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install curl-devel expat-devel gettext-devel openssl-devel zlib-devel</span><br><span class="line">yum install  gcc perl-ExtUtils-MakeMaker  //控制make命令操作模块</span><br></pre></td></tr></table></figure>
<p>步骤2. 卸载旧的git版本（如果之前有安装rpm包）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum remove git</span><br></pre></td></tr></table></figure>
<p>步骤3. 下载&amp;解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/src</span><br><span class="line">wget https://www.kernel.org/pub/software/scm/git/git-2.5.0.tar.gz</span><br><span class="line">tar -zxvf git-2.5.0.tar.gz</span><br></pre></td></tr></table></figure>
<blockquote>
<p>或  wget <a href="http://www.codemonkey.org.uk/projects/git-snapshots/git/git-latest.tar.gz" target="_blank" rel="external">http://www.codemonkey.org.uk/projects/git-snapshots/git/git-latest.tar.gz</a> 下载 获取最新版本</p>
</blockquote>
<p>步骤4. 编译安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd git-2.5.0</span><br><span class="line">make prefix=/usr/local/git all</span><br><span class="line">make prefix=/usr/local/git install</span><br><span class="line">echo &quot;export PATH=$PATH:/usr/local/git/bin&quot; &gt;&gt; /etc/bashrc</span><br><span class="line">source /etc/bashrc</span><br></pre></td></tr></table></figure>
<p>步骤5. 检查git版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git --version</span><br><span class="line">git version 2.5.0</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="http://www.ruanyifeng.com/blog/2015/02/make.html" target="_blank" rel="external">Make 命令教程</a></p>
<p><a href="http://www.runoob.com/linux/linux-yum.html" target="_blank" rel="external">linux yum 命令</a></p>
<p><a href="http://www.cnblogs.com/chuncn/archive/2010/10/17/1853915.html" target="_blank" rel="external">linux yum命令详解</a></p>
<p><a href="https://blog.phpgao.com/vps_ssh.html" target="_blank" rel="external">VPS安全之SSH设置</a></p>
<p><a href="https://help.github.com/articles/connecting-to-github-with-ssh/" target="_blank" rel="external">Connecting to GitHub with SSH</a></p>
<p><a href="http://www.linmuxi.com/2016/02/24/github-config-ssh/" target="_blank" rel="external">Github之SSH连接配置</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、CentOS/">Linux、CentOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Linux与UNIX区别" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/02/03/Linux与UNIX区别/" class="article-date">
  	<time datetime="2017-02-03T03:00:21.000Z" itemprop="datePublished">2017-02-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/03/Linux与UNIX区别/">Linux 与 UNIX</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="UNIX简介"><a href="#UNIX简介" class="headerlink" title="UNIX简介"></a>UNIX简介</h2><p>UNIX，一种计算机操作系统，具有多任务、多用户的特征。于1969年，在美国AT&amp;T公司的贝尔实验室开发类UNIX（UNIX-like）。</p>
<p>Unix的前身为1964年开始的Multics，贝尔实验室参与了这个操作系统的研发，但因为开发速度太慢，1969年贝尔实验室决定退出这个计划。贝尔实验室的工程师，肯·汤普逊和丹尼斯·里奇，在此时自行开发了Unix。</p>
<p>此后的10年，Unix在学术机构和大型企业中得到了广泛的应用，当时的UNIX拥有者AT&amp;T公司以低廉甚至免费的许可将Unix源码授权给学术机构做研究或教学之用，许多机构在此源码基础上加以扩充和改进，形成了所谓的“Unix变种”，这些变种反过来也促进了Unix的发展，其中最著名的变种之一是由加州大学柏克莱分校开发的柏克莱软件包(BSD)产品。</p>
<p>BSD使用主版本加次版本的方法标识，如4.2、4.3BSD，在原始版本的基础上还有派生版本，这些版本通常有自己的名字，如4.3BSD-Net/1，4.3BSD-Net/2等。BSD在发展中也逐渐派生出3个主要的分支：FreeBSD、OpenBSD和NetBSD。</p>
<p>详细资料：<a href="https://zh.wikipedia.org/wiki/UNIX" target="_blank" rel="external">UNIX</a></p>
<h2 id="Linux-简介"><a href="#Linux-简介" class="headerlink" title="Linux 简介"></a>Linux 简介</h2><p>Linux内核最初只是由芬兰人李纳斯·托瓦兹（Linus Torvalds）在赫尔辛基大学上学时出于个人爱好而编写的。<br>Linux是一套免费使用和自由传播的类Unix操作系统，是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统。<br>Linux能运行主要的UNIX工具软件、应用程序和网络协议。它支持32位和64位硬件。Linux继承了Unix以网络为核心的设计思想，是一个性能稳定的多用户网络操作系统。</p>
<h2 id="Linux的发行版"><a href="#Linux的发行版" class="headerlink" title="Linux的发行版"></a>Linux的发行版</h2><p>Linux的发行版说简单点就是将Linux内核与应用软件做一个打包。<br>目前市面上较知名的发行版有：Ubuntu、RedHat、CentOS、Debain、Fedora、SuSE、OpenSUSE、TurboLinux、BluePoint、RedFlag、Xterm、SlackWare等。</p>
<h2 id="Linux应用领域"><a href="#Linux应用领域" class="headerlink" title="Linux应用领域"></a>Linux应用领域</h2><p>今天各种场合都有使用各种Linux发行版，从嵌入式设备到超级计算机，并且在服务器领域确定了地位，通常服务器使用LAMP（Linux + Apache + MySQL + PHP）或LNMP（Linux + Nginx+ MySQL + PHP）组合。<br>目前Linux不仅在家庭与企业中使用，并且在政府中也很受欢迎。</p>
<h2 id="Linux-vs-Window"><a href="#Linux-vs-Window" class="headerlink" title="Linux vs Window"></a>Linux vs Window</h2><p>目前国内Linux更多的是应用于服务器上，而桌面操作系统更多使用的是Window。主要区别如下：</p>
<table>
<thead>
<tr>
<th style="text-align:center">比较</th>
<th style="text-align:center">Windows</th>
<th style="text-align:center">Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">界面</td>
<td style="text-align:center">界面统一，外壳程序固定所有Windows程序菜单几乎一致，快捷键也几乎相同</td>
<td style="text-align:center">图形界面风格依发布版不同而不同，可能互不兼容。GNU/Linux的终端机是从UNIX传承下来，基本命令和操作方法也几乎一致。</td>
</tr>
<tr>
<td style="text-align:center">驱动程序</td>
<td style="text-align:center">驱动程序丰富，版本更新频繁。默认安装程序里面一般包含有该版本发布时流行的硬件驱动程序，之后所出的新硬件驱动依赖于硬件厂商提供。对于一些老硬件，如果没有了原配的驱动有时很难支持。另外，有时硬件厂商未提供所需版本的Windows下的驱动，也会比较头痛。</td>
<td style="text-align:center">由志愿者开发，由Linux核心开发小组发布，很多硬件厂商基于版权考虑并未提供驱动程序，尽管多数无需手动安装，但是涉及安装则相对复杂，使得新用户面对驱动程序问题（是否存在和安装方法）会一筹莫展。但是在开源开发模式下，许多老硬件尽管在Windows下很难支持的也容易找到驱动。HP、Intel、AMD等硬件厂商逐步不同程度支持开源驱动，问题正在得到缓解。</td>
</tr>
<tr>
<td style="text-align:center">使用</td>
<td style="text-align:center">使用比较简单，容易入门。图形化界面对没有计算机背景知识的用户使用十分有利。</td>
<td style="text-align:center">图形界面使用简单，容易入门。文字界面，需要学习才能掌握。</td>
</tr>
<tr>
<td style="text-align:center">学习</td>
<td style="text-align:center">系统构造复杂、变化频繁，且知识、技能淘汰快，深入学习困难。</td>
<td style="text-align:center">系统构造简单、稳定，且知识、技能传承性好，深入学习相对容易。</td>
</tr>
<tr>
<td style="text-align:center">软件</td>
<td style="text-align:center">每一种特定功能可能都需要商业软件的支持，需要购买相应的授权。</td>
<td style="text-align:center">大部分软件都可以自由获取，同样功能的软件选择较少。</td>
</tr>
</tbody>
</table>
<h2 id="linux-yum-命令"><a href="#linux-yum-命令" class="headerlink" title="linux yum 命令"></a>linux yum 命令</h2><p>yum（ Yellow dog Updater, Modified）是一个在Fedora和RedHat以及SUSE中的Shell前端软件包管理器。<br>基於RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软体包，无须繁琐地一次次下载、安装。<br>yum提供了查找、安装、删除某一个、一组甚至全部软件包的命令，而且命令简洁而又好记。</p>
<p>yum 语法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum [options] [command] [package ...]</span><br></pre></td></tr></table></figure>
<ul>
<li>options：可选，选项包括-h（帮助），-y（当安装过程提示选择全部为”yes”），-q（不显示安装的过程）等等。</li>
<li>command：要进行的操作。</li>
<li>package操作的对象。</li>
</ul>
<h2 id="yum常用命令"><a href="#yum常用命令" class="headerlink" title="yum常用命令"></a>yum常用命令</h2><p>1.列出所有可更新的软件清单命令：yum check-update<br>2.更新所有软件命令：yum update<br>3.仅安装指定的软件命令：yum install <package_name><br>4.仅更新指定的软件命令：yum update <package_name><br>5.列出所有可安裝的软件清单命令：yum list<br>6.删除软件包命令：yum remove <package_name><br>7.查找软件包 命令：yum search <keyword><br>8.清除缓存命令:</keyword></package_name></package_name></package_name></p>
<ul>
<li>yum clean packages: 清除缓存目录下的软件包</li>
<li>yum clean headers: 清除缓存目录下的 headers</li>
<li>yum clean oldheaders: 清除缓存目录下旧的 headers</li>
<li>yum clean, yum clean all (= yum clean packages; yum clean oldheaders) :清除缓存目录下的软件包及旧的headers</li>
</ul>
<p>参考资料：</p>
<p><a href="https://zh.wikipedia.org/wiki/UNIX" target="_blank" rel="external">UNIX</a></p>
<p><a href="https://zh.wikipedia.org/wiki/CentOS" target="_blank" rel="external">CentOS</a></p>
<p><a href="https://zh.wikipedia.org/wiki/Ubuntu" target="_blank" rel="external">Ubuntu</a></p>
<p><a href="https://zh.wikipedia.org/wiki/Debian" target="_blank" rel="external">Debian</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux、UNIX/">Linux、UNIX</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-SVG 基本形状与路径" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/16/SVG 基本形状与路径/" class="article-date">
  	<time datetime="2017-01-16T01:10:21.000Z" itemprop="datePublished">2017-01-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/SVG 基本形状与路径/">聊聊 SVG 基本形状转换那些事</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间研究 SVG 压缩优化，发现SVG预定义的 <code>rect</code>、<code>circle</code>、<code>ellipse</code>、<code>line</code>、<code>polyline</code>、<code>polygon</code>  六种基本形状可通过path路径转换实现，这样可以在一定程度上减少代码量。不仅如此，我们常用的 SVG Path 动画(路径动画)，是以操作path中两个属性值<code>stroke-dasharray</code>和<code>stroke-dashoffset</code>来实现，基本形状转换为path路径，有利于实现路径动画。</p>
<h2 id="SVG基本形状"><a href="#SVG基本形状" class="headerlink" title="SVG基本形状"></a>SVG基本形状</h2><p>SVG 提供了<code>rect</code>、<code>circle</code>、<code>ellipse</code>、<code>line</code>、<code>polyline</code>、<code>polygon</code>六种基本形状用于图形绘制，这些形状可以直接用来绘制一些基本的形状，如矩形、椭圆等，而复杂图形的绘制则需要使用 path 路径来实现。</p>
<p><img src="http://img.pfan123.com/svgpath1.jpg" alt="svg基本形状"></p>
<h3 id="1-rect-矩形"><a href="#1-rect-矩形" class="headerlink" title="1.rect 矩形"></a>1.<code>rect</code> 矩形</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;rect x=&quot;10&quot; y=&quot;10&quot; width=&quot;30&quot; height=&quot;30&quot;/&gt;</span><br><span class="line">&lt;rect x=&quot;60&quot; y=&quot;10&quot; rx=&quot;10&quot; ry=&quot;10&quot; width=&quot;30&quot; height=&quot;30&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>SVG中<code>rect</code>元素用于绘制矩形、圆角矩形，含有6个基本属性用于控制矩形的形状以及坐标，具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x       矩形左上角x位置, 默认值为 0 </span><br><span class="line">y       矩形左上角y位置, 默认值为 0</span><br><span class="line">width   矩形的宽度, 不能为负值否则报错, 0 值不绘制</span><br><span class="line">height  矩形的高度,  不能为负值否则报错, 0 值不绘制</span><br><span class="line">rx      圆角x方向半径, 不能为负值否则报错</span><br><span class="line">ry      圆角y方向半径, 不能为负值否则报错</span><br></pre></td></tr></table></figure>
<p>这里需要注意，<code>rx</code> 和 <code>ry</code> 的还有如下规则：</p>
<ul>
<li><code>rx</code> 和 <code>ry</code> 都没有设置, 则 rx = 0 ry = 0</li>
<li><code>rx</code> 和 <code>ry</code> 有一个值为0, 则相当于 rx = 0 ry = 0，圆角无效</li>
<li><code>rx</code> 和 <code>ry</code> 有一个被设置, 则全部取这个被设置的值</li>
<li><code>rx</code> 的最大值为 <code>width</code> 的一半, <code>ry</code> 的最大值为 <code>height</code> 的一半</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rx = rx || ry || 0;</span><br><span class="line">ry = ry || rx || 0;</span><br><span class="line"></span><br><span class="line">rx = rx &gt; width / 2 ? width / 2 : rx;</span><br><span class="line">ry = ry &gt; height / 2 ? height / 2 : ry;</span><br><span class="line"></span><br><span class="line">if(0 === rx || 0 === ry)&#123;</span><br><span class="line"> rx = 0,</span><br><span class="line"> ry = 0;  //圆角不生效，等同于，rx，ry都为0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-circle-圆形"><a href="#2-circle-圆形" class="headerlink" title="2.circle 圆形"></a>2.<code>circle</code> 圆形</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;circle cx=&quot;100&quot; cy=&quot;100&quot; r=&quot;50&quot; fill=&quot;#fff&quot;&gt;&lt;/circle&gt;</span><br></pre></td></tr></table></figure>
<p>SVG中<code>circle</code>元素用于绘制圆形，含有3个基本属性用于控制圆形的坐标以及半径，具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r       半径</span><br><span class="line">cx      圆心x位置, 默认为 0</span><br><span class="line">cy      圆心y位置, 默认为 0</span><br></pre></td></tr></table></figure>
<h3 id="3-ellipse-椭圆"><a href="#3-ellipse-椭圆" class="headerlink" title="3.ellipse 椭圆"></a>3.<code>ellipse</code> 椭圆</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ellipse cx=&quot;75&quot; cy=&quot;75&quot; rx=&quot;20&quot; ry=&quot;5&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p>SVG中<code>ellipse</code>元素用于绘制椭圆，是<code>circle</code>元素更通用的形式，含有4个基本属性用于控制椭圆的形状以及坐标，具体如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rx      椭圆x半径</span><br><span class="line">ry      椭圆y半径</span><br><span class="line">cx      圆心x位置, 默认为 0</span><br><span class="line">cy      圆心y位置, 默认为 0</span><br></pre></td></tr></table></figure>
<h3 id="4-line-直线"><a href="#4-line-直线" class="headerlink" title="4.line 直线"></a>4.<code>line</code> 直线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;line x1=&quot;10&quot; x2=&quot;50&quot; y1=&quot;110&quot; y2=&quot;150&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p><code>Line</code>绘制直线。它取两个点的位置作为属性，指定这条线的起点和终点位置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x1 起点的x位置</span><br><span class="line">y1 起点的y位置</span><br><span class="line">x2 终点的x位置</span><br><span class="line">y2 终点的y位置</span><br></pre></td></tr></table></figure>
<h3 id="5-polyline-折线"><a href="#5-polyline-折线" class="headerlink" title="5.polyline 折线"></a>5.<code>polyline</code> 折线</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;polyline points=&quot;60 110, 65 120, 70 115, 75 130, 80 125, 85 140, 90 135, 95 150, 100 145&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p><code>polyline</code>是一组连接在一起的直线。因为它可以有很多的点，折线的的所有点位置都放在一个points属性中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">points 点集数列，每个数字用空白、逗号、终止命令符或者换行符分隔开，每个点必须包含2个数字，一个是x坐标，一个是y坐标 如0 0, 1 1, 2 2”</span><br></pre></td></tr></table></figure>
<h3 id="6-polygon-多边形"><a href="#6-polygon-多边形" class="headerlink" title="6.polygon 多边形"></a>6.<code>polygon</code> 多边形</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;polygon points=&quot;50 160, 55 180, 70 180, 60 190, 65 205, 50 195, 35 205, 40 190, 30 180, 45 180&quot;/&gt;</span><br></pre></td></tr></table></figure>
<p><code>polygon</code>和折线很像，它们都是由连接一组点集的直线构成。不同的是，<code>polygon</code>的路径在最后一个点处自动回到第一个点。需要注意的是，矩形也是一种多边形，如果需要更多灵活性的话，你也可以用多边形创建一个矩形。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">points 点集数列，每个数字用空白、逗号、终止命令符或者换行符分隔开，每个点必须包含2个数字，一个是x坐标，一个是y坐标 如0 0, 1 1, 2 2， 路径绘制完闭合图形”</span><br></pre></td></tr></table></figure>
<h2 id="SVG-path-路径"><a href="#SVG-path-路径" class="headerlink" title="SVG path 路径"></a>SVG path 路径</h2><p>SVG 的路径<code>&lt;path&gt;</code>功能非常强大，它不仅能创建其他基本形状，还能创建更多复杂的形状。<code>&lt;path&gt;</code>路径是由一些命令来控制的，每一个命令对应一个字母，并且区分大小写，大写主要表示绝对定位，小写表示相对定位。<code>&lt;path&gt;</code> 通过属性 d 来定义路径， d 是一系列命令的集合，主要有以下几个命令：</p>
<p><img src="http://img.pfan123.com/svgpath2.jpg" alt="svg基本形状"></p>
<p>通常大部分形状，都可以通过指令<code>M(m)</code>、<code>L(l)</code>、<code>H(h)</code>、<code>V(v)</code>、<code>A(a)</code>来实现，注意特别要区分大小写，相对与绝对坐标情况，转换时推荐使用相对路径可减少代码量，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 以下两个等价</span><br><span class="line">d=&apos;M 10 10 20 20&apos;     // (10, 10) (20 20) 都是绝对坐标</span><br><span class="line">d=&apos;M 10 10 L 20 20&apos;</span><br><span class="line"></span><br><span class="line">// 以下两个等价</span><br><span class="line">d=&apos;m 10 10 20 20&apos;     // (10, 10) 绝对坐标, (20 20) 相对坐标</span><br><span class="line">d=&apos;M 10 10 l 20 20&apos;</span><br></pre></td></tr></table></figure>
<h2 id="SVG-基本形状路径转换原理"><a href="#SVG-基本形状路径转换原理" class="headerlink" title="SVG 基本形状路径转换原理"></a>SVG 基本形状路径转换原理</h2><h3 id="1-rect-to-path"><a href="#1-rect-to-path" class="headerlink" title="1.rect to path"></a>1.rect to path</h3><p>如下图所示，一个 <code>rect</code> 是由 4 个弧和 4 个线段构成；如果 <code>rect</code> 没有设置 rx 和 ry 则 <code>rect</code> 只是由 4 个线段构成。<code>rect</code> 转换为 <code>path</code> 只需要将 A ~ H 之间的弧和线段依次实现即可。</p>
<p><img src="http://img.pfan123.com/rect2path.png" alt="svg基本形状"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">function rect2path(x, y, width, height, rx, ry) &#123;</span><br><span class="line">    /*</span><br><span class="line">    * rx 和 ry 的规则是：</span><br><span class="line">    * 1. 如果其中一个设置为 0 则圆角不生效</span><br><span class="line">    * 2. 如果有一个没有设置则取值为另一个</span><br><span class="line">    */</span><br><span class="line">    rx = rx || ry || 0;</span><br><span class="line">    ry = ry || rx || 0;</span><br><span class="line"></span><br><span class="line">   //非数值单位计算，如当宽度像100%则移除</span><br><span class="line">   if (isNaN(x - y + width - height + rx - ry)) return;</span><br><span class="line"></span><br><span class="line">   rx = rx &gt; width / 2 ? width / 2 : rx;</span><br><span class="line">   ry = ry &gt; height / 2 ? height / 2 : ry;</span><br><span class="line"></span><br><span class="line">   //如果其中一个设置为 0 则圆角不生效</span><br><span class="line">   if(0 == rx || 0 == ry)&#123;</span><br><span class="line">         // var path =</span><br><span class="line">         //     &apos;M&apos; + x + &apos; &apos; + y +</span><br><span class="line">         //     &apos;H&apos; + (x + width) +     不推荐用绝对路径，相对路径节省代码量</span><br><span class="line">         //     &apos;V&apos; + (y + height) +</span><br><span class="line">         //     &apos;H&apos; + x +</span><br><span class="line">         //     &apos;z&apos;;</span><br><span class="line">         var path =</span><br><span class="line">             &apos;M&apos; + x + &apos; &apos; + y +</span><br><span class="line">             &apos;h&apos; + width +</span><br><span class="line">             &apos;v&apos; + height +</span><br><span class="line">             &apos;h&apos; + -width +</span><br><span class="line">             &apos;z&apos;;                </span><br><span class="line">   &#125;else&#123;</span><br><span class="line">         var path =</span><br><span class="line">             &apos;M&apos; + x + &apos; &apos; + (y+ry) +</span><br><span class="line">             &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 0 1 &apos; + rx + &apos; &apos; + (-ry) + </span><br><span class="line">             &apos;h&apos; + (width - rx - rx) +</span><br><span class="line">             &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 0 1 &apos; + rx + &apos; &apos; + ry + </span><br><span class="line">             &apos;v&apos; + (height - ry -ry) +</span><br><span class="line">             &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 0 1 &apos; + (-rx) + &apos; &apos; + ry + </span><br><span class="line">             &apos;h&apos; + (rx + rx -width) +</span><br><span class="line">             &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 0 1 &apos; + (-rx) + &apos; &apos; + (-ry) + </span><br><span class="line">             &apos;z&apos;;        </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   return path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-circle-ellipse-to-path"><a href="#2-circle-ellipse-to-path" class="headerlink" title="2.circle/ellipse to path"></a>2.circle/ellipse to path</h4><p>圆可视为是一种特殊的椭圆，即 rx 与 ry 相等的椭圆，所以可以放在一起讨论。 椭圆可以看成A点到C做180度顺时针画弧、C点到A做180度顺时针画弧即可。</p>
<p><img src="//misc.aotu.io/pfan123/svgpath/ellipse2path.png" alt="svg基本形状"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function ellipse2path(cx, cy, rx, ry) &#123;</span><br><span class="line">   //非数值单位计算，如当宽度像100%则移除</span><br><span class="line">   if (isNaN(cx - cy + rx - ry)) return;</span><br><span class="line"></span><br><span class="line">   var path =</span><br><span class="line">       &apos;M&apos; + (cx-rx) + &apos; &apos; + cy +</span><br><span class="line">       &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 1 0 &apos; + 2*rx + &apos; 0&apos; +</span><br><span class="line">       &apos;a&apos; + rx + &apos; &apos; + ry + &apos; 0 1 0 &apos; + (-2*rx) + &apos; 0&apos; +</span><br><span class="line">       &apos;z&apos;; </span><br><span class="line"></span><br><span class="line">   return path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-line-to-path"><a href="#3-line-to-path" class="headerlink" title="3.line to path"></a>3.line to path</h4><p>相对来说比较简单，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function line2path(x1, y1, x2, y2) &#123;</span><br><span class="line">   //非数值单位计算，如当宽度像100%则移除</span><br><span class="line">   if (isNaN(x1 - y1 + x2 - y2)) return; </span><br><span class="line">   </span><br><span class="line">    x1 = x1 || 0;</span><br><span class="line">    y1 = y1 || 0;</span><br><span class="line">    x2 = x2 || 0;</span><br><span class="line">    y2 = y2 || 0;</span><br><span class="line"></span><br><span class="line">    var path = &apos;M&apos; + x1 + &apos; &apos;+ y1 + &apos;L&apos; + x2 + &apos; &apos; + y2;</span><br><span class="line">    return path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-polyline-polygon-to-path"><a href="#4-polyline-polygon-to-path" class="headerlink" title="4.polyline/polygon to path"></a>4.polyline/polygon to path</h3><p><code>polyline</code>折线、<code>polygon</code>多边形的转换为path比较类似，差别就是<code>polygon</code>多边形会闭合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// polygon折线转换</span><br><span class="line">points = [x1, y1, x2, y2, x3, y3 ...];</span><br><span class="line">function polyline2path (points) &#123;</span><br><span class="line">    var path = &apos;M&apos; + points.slice(0,2).join(&apos; &apos;) +</span><br><span class="line">                      &apos;L&apos; + points.slice(2).join(&apos; &apos;); </span><br><span class="line">    return path;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// polygon多边形转换</span><br><span class="line">points = [x1, y1, x2, y2, x3, y3 ...];</span><br><span class="line">function polygon2path (points) &#123;</span><br><span class="line">    var path = &apos;M&apos; + points.slice(0,2).join(&apos; &apos;) +</span><br><span class="line">                      &apos;L&apos; + points.slice(2).join(&apos; &apos;) + &apos;z&apos;; </span><br><span class="line">    return path;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="convertpath转换工具"><a href="#convertpath转换工具" class="headerlink" title="convertpath转换工具"></a><code>convertpath</code>转换工具</h3><p>为了方便处理SVG基本元素路径转换，本人抽空写了<a href="https://github.com/pfan123/convertpath" target="_blank" rel="external">convertpath</a>工具，具体如下：</p>
<p>安装：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i convertpath</span><br></pre></td></tr></table></figure></p>
<p>使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const parse = require(&apos;convertpath&apos;);</span><br><span class="line">parse.parse(&quot;./test/test.svg&quot;)</span><br><span class="line">/**</span><br><span class="line"> * &lt;circle cx=&quot;500&quot; cy=&quot;500&quot; r=&quot;20&quot; fill=&quot;red&quot;/&gt;</span><br><span class="line"> */</span><br><span class="line">console.log(parse.toSimpleSvg())</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * &lt;path d=&quot;M500,500,m-20,0,a20,20,0,1,0,40,0,a20,20,0,1,0,-40,0,Z&quot; fill=&quot;red&quot;/&gt;</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="https://www.w3.org/TR/SVG/shapes.html" target="_blank" rel="external">Basic Shapes – SVG 1.1 (Second Edition)</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Basic_Shapes" target="_blank" rel="external">基本形状 - SVG | MDN</a><br><a href="https://segmentfault.com/a/1190000004393817" target="_blank" rel="external">SVG (一) 图形, 路径, 变换总结; 以及椭圆弧线, 贝塞尔曲线的详细解释</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths" target="_blank" rel="external">路径 - SVG | MDN</a><br><a href="https://github.com/jindw/xmldom" target="_blank" rel="external">XMLDOM</a>   </p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/svg、path、circle、rect、ellipse、polygon、polyline、line/">svg、path、circle、rect、ellipse、polygon、polyline、line</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-dataURI 中使用 SVG正确姿势" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/11/dataURI 中使用 SVG正确姿势/" class="article-date">
  	<time datetime="2017-01-11T03:00:21.000Z" itemprop="datePublished">2017-01-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/11/dataURI 中使用 SVG正确姿势/">探究 dataURI 中使用 SVG 正确姿势</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>为了减少首页的请求数量，按照以往的思路，会直接将 SVG 转换为 base64 后插入了 CSS 文件中。代码可能是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.svg &#123;</span><br><span class="line">    background-image: url(&apos;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjUwOCIgaGVpZ2h0PSIyNTIuNyIgdmlld0JveD0iMCAwIDI1MDggMjUyLjciPjxwb2x5Z29uIHBvaW50cz0iNCwyNTIuNyAyNTA0LDAgMjUwNCwyNTIuNyIgc3R5bGU9ImZpbGw6I2U2ZWJlYSIgLz48L3N2Zz4=&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>初步开发完成后，为了进一步优化代码，在查询资料时读到了这篇文章：<a href="http://codepen.io/Tigt/post/optimizing-svgs-in-data-uris" target="_blank" rel="external">Optimizing SVGs in data URIs</a>。参考文章内容进行优化之后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.svg &#123;</span><br><span class="line">    background-image: url(&quot;data:image/svg+xml;charset=utf8,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; version=&apos;1.1&apos;%3E%3Cpolygon points=&apos;4,252.7 2504,0 2504,252.7&apos; style=&apos;fill:%23e6ebea&apos;/%3E%3C/svg%3E&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对比这两段代码，最明显的效果是代码量减少了一半多，而且代码非常清晰，几乎就是 SVG 代码原文，日后如果有一些细微的需求变更，比如更改填充色，可以直接在代码里修改无需进行编码转换。</p>
<h2 id="在-dataURI-中使用-SVG-的最佳方法-Optimizing-SVGs-in-data-URIs"><a href="#在-dataURI-中使用-SVG-的最佳方法-Optimizing-SVGs-in-data-URIs" class="headerlink" title="在 dataURI 中使用 SVG 的最佳方法 Optimizing SVGs in data URIs"></a>在 dataURI 中使用 SVG 的最佳方法 <a href="http://codepen.io/Tigt/post/optimizing-svgs-in-data-uris" target="_blank" rel="external">Optimizing SVGs in data URIs</a></h2><p>不久前，CSS-Tricks 发表了 <a href="https://css-tricks.com/probably-dont-base64-svg/" target="_blank" rel="external">“Probably Don’t Base64 SVG”</a>，得出结论：如果你在 data URI 中直接使用 SVG，数据量会比转化成 base64 编码格式时小。</p>
<p>这个观点是正确的，但是这里还有一些复杂的地方以及可优化的空间。</p>
<h2 id="更好的浏览器兼容性"><a href="#更好的浏览器兼容性" class="headerlink" title="更好的浏览器兼容性"></a>更好的浏览器兼容性</h2><p>例如下面这段代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.bg &#123;</span><br><span class="line">    background: url(&apos;data:image/svg+xml;utf8,&lt;svg ...&gt; ... &lt;/svg&gt;&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在那些流行于 web 开发者中的浏览器中是有效的，但是在 IE 中则无法正常工作。因为从技术角度来说这是一种畸形的 data URI，而 IE 很严格（原文： This is because technically it’s a malformed data URI, and IE is being strict.）。</p>
<h3 id="RFC-2397-定义了-data-URI："><a href="#RFC-2397-定义了-data-URI：" class="headerlink" title="RFC 2397 定义了 data URI："></a><a href="http://www.ietf.org/rfc/rfc2397.txt" target="_blank" rel="external">RFC 2397</a> 定义了 data URI：</h3><blockquote>
<p>URL 的形式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:[&lt;mediatype&gt;][;base64],&lt;data&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>&lt;mediatype&gt;</code> 描述数据的 MIME 类型，<code>;base64</code> 的出现意味着数据被编码成 <code>base64</code> 格式。如果没有声明<code>;base64</code>，对于 URL 安全字符使用 ASCII 编码，而安全范围以外的字符则使用十六进制数编码为<code>%xx</code>格式。如果省略<code>&lt;mediatype&gt;</code>，默认为<code>text/plain;charset=US-ASCII</code>。</p>
</blockquote>
<p>换句话说，根据标准，只有如下两种编码 data URI 的方法是有效的：</p>
<ul>
<li>1.<code>data:mime/type;base64,[actual data]</code>：base64 编码，更适合于二进制数据（PNG，fonts，SVGZ 等等）</li>
<li>2.<code>data:mime/type;charset=[charset],[actual data]</code>：URL 编码的普通文本，更适合与文本标记语言（SVG，HTML等）</li>
</ul>
<p>所以，把一个 SVG 文件编码为 data URL 的正确方式为 <code>data:image/svg+xml;charset=utf8,[actual data]</code>。我猜大部分浏览器对是否存在<code>charset=</code>字符串比较宽容，但是在 IE 浏览器里是必须的。为了代码的最大兼容性（例如一些小众浏览器，邮件客户端，等等），它应该被包含在内。</p>
<p>但这并不是全部。记得这段话么？</p>
<blockquote>
<p>如果没有声明<code>;base64</code>，对于 URL 安全字符使用<code>ASCII</code> 编码，而安全范围以外的字符则使用十六进制数编码为<code>%xx</code>格式。如果省略<code>&lt;mediatype&gt;</code>，默认为<code>text/plain;charset=US-ASCII</code>。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!-- Generated by IcoMoon.io --&gt;</span><br><span class="line">&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot; &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&gt;</span><br><span class="line">&lt;svg version=&quot;1.1&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; width=&quot;512&quot; height=&quot;512&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;g id=&quot;icomoon-ignore&quot;&gt;</span><br><span class="line">&lt;/g&gt;</span><br><span class="line">&lt;path d=&quot;M224 387.814v124.186l-192-192 192-192v126.912c223.375 5.24 213.794-151.896 156.931-254.912 140.355 151.707 110.55 394.785-156.931 387.814z&quot;&gt;&lt;/path&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>根据 Chris 的建议，我们使用 <a href="https://github.com/svg/svgo" target="_blank" rel="external">SVGO</a> 来优化我们的 SVG 文件（如果你更习惯图形界面，GUI 版本：<a href="https://jakearchibald.github.io/svgomg/" target="_blank" rel="external">SCGOMG</a>）。结果是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;512&quot; height=&quot;512&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M224 387.814V512L32 320l192-192v126.912C447.375 260.152 437.794 103.016 380.93 0 521.287 151.707 491.48 394.785 224 387.814z&quot;/&gt;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>文件小了很多！而且如果你打算用 CSS 来设定图像的尺寸，你还可以去掉<code>width</code>和<code>height</code>属性让代码更简洁。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 512 512&quot;&gt;&lt;path d=&quot;M224 387.814V512L32 320l192-192v126.912C447.375 260.152 437.794 103.016 380.93 0 521.287 151.707 491.48 394.785 224 387.814z&quot;/&gt;&lt;/svg&gt;</span><br></pre></td></tr></table></figure>
<p>现在，我们把精简后的 SVG 丢进 <a href="http://meyerweb.com/eric/tools/dencoder/" target="_blank" rel="external">URL</a> 编码器，会得到这样的东西：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cpath%20d%3D%22M224%20387.814V512L32%20320l192-192v126.912C447.375%20260.152%20437.794%20103.016%20380.93%200%20521.287%20151.707%20491.48%20394.785%20224%20387.814z%22%2F%3E%3C%2Fsvg%3E</span><br></pre></td></tr></table></figure>
<p>目前这是唯一能在 IE 中工作的版本。非常明显，这甚至比 base64 编码过后的 SVG 都要长：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNMjI0IDM4Ny44MTRWNTEyTDMyIDMyMGwxOTItMTkydjEyNi45MTJDNDQ3LjM3NSAyNjAuMTUyIDQzNy43OTQgMTAzLjAxNiAzODAuOTMgMCA1MjEuMjg3IDE1MS43MDcgNDkxLjQ4IDM5NC43ODUgMjI0IDM4Ny44MTR6Ii8</span><br></pre></td></tr></table></figure>
<h2 id="“引号是关键”"><a href="#“引号是关键”" class="headerlink" title="“引号是关键”"></a>“引号是关键”</h2><p>你可能注意到了，Chris 使用单引号（<code>&#39;</code>）来界定 data URIs。这是因为他的 SVG 文件未编码时使用双引号（<code>&quot;</code>）来包裹属性值，为了避免冲突而使用了单引号来代替。这一点点微小的改变其实是真正精简 data URI 的关键。</p>
<p><code>&quot;</code> 和 <code>&#39;</code> 都是有效的属性分隔符（即：<code>attribute=&quot;value&quot;</code> 和 <code>attribute=&#39;value&#39;</code> 都有效），但是只有<code>&#39;</code>可以直接在 URL 中使用而无须编码转换。现在我们替换双引号，编码<code>&lt;</code>和<code>&gt;</code>，得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 512 512&apos;%3E%3Cpath d=&apos;M224 387.814V512L32 320l192-192v126.912C447.375 260.152 437.794 103.016 380.93 0 521.287 151.707 491.48 394.785 224 387.814z&apos;/%3E%3C/svg%3E</span><br></pre></td></tr></table></figure>
<p>所以，当你把 SVG 作为 data URI使用时：</p>
<p>用单引号替换包裹属性值的双引号<br>编码 <code>&lt;</code>，<code>&gt;</code>，<code>#</code>，和剩余的 <code>&quot;</code> （例如在文本内容中的双引号），以及其他一直的不安全 URL 字符（例如 <code>%</code>）<br>使用双引号来分隔 data URI（<code>&lt;img src=&quot;&quot;&gt;</code>，<code>url(&quot;&quot;)</code>）</p>
<p>网友 jakob-e 在 SASS 中实现了这个算法，使整个流程变得非常简单：</p>
<iframe scrolling="no" src="//codepen.io/jakob-e/embed/doMoML/?height=287&amp;theme-id=0&amp;default-tab=js" allowtransparency="true" allowfullscreen="true" style="width: 100%;" frameborder="no" height="287">See the Pen &lt;a href=’<a href="http://codepen.io/jakob-e/pen/doMoML/&#39;&gt;Encode" target="_blank" rel="external">http://codepen.io/jakob-e/pen/doMoML/&#39;&gt;Encode</a> SVG SCSS&lt;/a&gt; by jakob-e (&lt;a href=’<a href="http://codepen.io/jakob-e&#39;&gt;@jakob-e&lt;/a&amp;gt" target="_blank" rel="external">http://codepen.io/jakob-e&#39;&gt;@jakob-e&lt;/a&amp;gt</a>;) on &lt;a href=’<a href="http://codepen.io&#39;&gt;CodePen&lt;/a&amp;gt" target="_blank" rel="external">http://codepen.io&#39;&gt;CodePen&lt;/a&amp;gt</a>;.<br></iframe>

<p>以上就是如何得到能够在 IE （以及标准）中使用最精简的 data URI。总结一下：</p>
<p>base64 编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBkPSJNMjI0IDM4Ny44MTRWNTEyTDMyIDMyMGwxOTItMTkydjEyNi45MTJDNDQ3LjM3NSAyNjAuMTUyIDQzNy43OTQgMTAzLjAxNiAzODAuOTMgMCA1MjEuMjg3IDE1MS43MDcgNDkxLjQ4IDM5NC43ODUgMjI0IDM4Ny44MTR6Ii8+PC9zdmc+</span><br></pre></td></tr></table></figure>
<p>完全 URL 编码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/svg+xml;charset=utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20512%20512%22%3E%3Cpath%20d%3D%22M224%20387.814V512L32%20320l192-192v126.912C447.375%20260.152%20437.794%20103.016%20380.93%200%20521.287%20151.707%20491.48%20394.785%20224%20387.814z%22%2F%3E%3C%2Fsvg%3E</span><br></pre></td></tr></table></figure>
<p>最大程度优化的 URL 编码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/svg+xml;charset=utf8,%3Csvg xmlns=&apos;http://www.w3.org/2000/svg&apos; viewBox=&apos;0 0 512 512&apos;%3E%3Cpath d=&apos;M224%20387.814V512L32 320l192-192v126.912C447.375 260.152 437.794 103.016 380.93 0 521.287 151.707 491.48 394.785 224 387.814z&apos;/%3E%3C/svg%3E</span><br></pre></td></tr></table></figure></p>
<p>我们测试发现，结果它在 IE9+ 以及 安卓3.x 以上的浏览器中都能够完美显示。</p>
<iframe scrolling="no" src="//codepen.io/Tigt/embed/wavYWE/?height=268&amp;theme-id=0&amp;default-tab=result" allowtransparency="true" allowfullscreen="true" style="width: 100%;" frameborder="no" height="268">See the Pen &lt;a href=’<a href="http://codepen.io/Tigt/pen/wavYWE/&#39;&gt;Cross-Browser" target="_blank" rel="external">http://codepen.io/Tigt/pen/wavYWE/&#39;&gt;Cross-Browser</a> data URI encoding test&lt;/a&gt; by Taylor Hunt (&lt;a href=’<a href="http://codepen.io/Tigt&#39;&gt;@Tigt&lt;/a&amp;gt" target="_blank" rel="external">http://codepen.io/Tigt&#39;&gt;@Tigt&lt;/a&amp;gt</a>;) on &lt;a href=’<a href="http://codepen.io&#39;&gt;CodePen&lt;/a&amp;gt" target="_blank" rel="external">http://codepen.io&#39;&gt;CodePen&lt;/a&amp;gt</a>;.<br></iframe>

<p>参考资料：</p>
<p><a href="http://codepen.io/Tigt/post/optimizing-svgs-in-data-uris" target="_blank" rel="external">Optimizing SVGs in data URIs</a></p>
<p><a href="https://css-tricks.com/probably-dont-base64-svg/" target="_blank" rel="external">Probably Don’t Base64 SVG</a></p>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SVG、dataURI、base64/">SVG、dataURI、base64</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 pfan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a>
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>