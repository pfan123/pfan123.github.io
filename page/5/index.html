<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>pfan博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="pfan博客 新起点，新高度">
<meta property="og:type" content="website">
<meta property="og:title" content="pfan博客">
<meta property="og:url" content="http://pfan123.github.io/page/5/index.html">
<meta property="og:site_name" content="pfan博客">
<meta property="og:description" content="pfan博客 新起点，新高度">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pfan博客">
<meta name="twitter:description" content="pfan博客 新起点，新高度">
  
    <link rel="alternative" href="/atom.xml" title="pfan博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://litten.github.io/assets/blogImg/litten.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">pfan</a></h1>
		</hgroup>

		
		<p class="header-subtitle">新起点，新高度</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>		
					
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>

			</div>
		


		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
				        	<li class = "article_cate_tit"> 文章分类</li>
				        	<li class = "article_cate_a"> <a  href = "/categories/技术杂谈/">技术杂谈</a>	</li>
				        	<li class = "article_cate_a"> <a href = "/categories/兴趣爱好/">兴趣爱好</a>		</li>
				        	<li class = "article_cate_a"> <a href = "/categories/日志/">日志</a></li>
				        	<li class = "article_cate_a"> <a href = "/categories/JavaScript/">JavaScript</a>	</li>
				        	<li class = "article_cate_a"> <a  href = "/categories/CSS3/">CSS3</a>	</li>
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/pfan123" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/gaolu1990/home?wvr=5" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>



				<style type="text/css">
					.article_cate_tit{
						color:#ba8f6c;
						margin-top:6px;
					}
					.article_cate_con a{
						display:block;
						font-size:12px;
						text-align:center;
						margin:4px 0;
					}
					#header .header-menu{
						line-height:21px;
					}
					.article_cate_a{
						line-height:18px !important;
					}	
					.article_cate_a a{
						font-size:12px !important;
					}				
					#container .left-col .overlay{
						height:130px;
					}
					.header-nav{
						top:160px;
					}
				</style>	
				<!-- E 新增模块-->
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/gitignore-git/" style="font-size: 10px;">.gitignore git</a> <a href="/tags/htaccess-配置二级域名-绑定子目录/" style="font-size: 10px;">.htaccess  配置二级域名  绑定子目录</a> <a href="/tags/AMD/" style="font-size: 10px;">AMD</a> <a href="/tags/CMD/" style="font-size: 10px;">CMD</a> <a href="/tags/CSS-BEM-OOCSS/" style="font-size: 10px;">CSS BEM OOCSS</a> <a href="/tags/CSS动画篇/" style="font-size: 10px;">CSS动画篇</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/ESLint/" style="font-size: 10px;">ESLint</a> <a href="/tags/Git，Git查看历史记录/" style="font-size: 10px;">Git，Git查看历史记录</a> <a href="/tags/H5/" style="font-size: 10px;">H5</a> <a href="/tags/H5-视频直播-video/" style="font-size: 10px;">H5 视频直播 video</a> <a href="/tags/H5全景、CSS3d、perspective/" style="font-size: 15px;">H5全景、CSS3d、perspective</a> <a href="/tags/HLS、RTMP协议/" style="font-size: 10px;">HLS、RTMP协议</a> <a href="/tags/HTML5/" style="font-size: 15px;">HTML5</a> <a href="/tags/HTML5-视频直播-video-canvas/" style="font-size: 10px;">HTML5 视频直播 video canvas</a> <a href="/tags/HTML5、localstorage、sessionStorage/" style="font-size: 10px;">HTML5、localstorage、sessionStorage</a> <a href="/tags/HTML、XML解析、dom-level、htmlparser2、xmldom、sax-js、cheerio/" style="font-size: 10px;">HTML、XML解析、dom level、htmlparser2、xmldom、sax-js、cheerio</a> <a href="/tags/HTTP、-node-http-proxy、-nginx、-proxy/" style="font-size: 15px;">HTTP、 node-http-proxy、 nginx、 proxy</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/Linux、CentOS/" style="font-size: 10px;">Linux、CentOS</a> <a href="/tags/Linux、UNIX/" style="font-size: 10px;">Linux、UNIX</a> <a href="/tags/Linux、Unix/" style="font-size: 20px;">Linux、Unix</a> <a href="/tags/Linux、Unix、nvm、node/" style="font-size: 10px;">Linux、Unix、nvm、node</a> <a href="/tags/Mac-命令-Terminal-osx/" style="font-size: 10px;">Mac 命令 Terminal osx</a> <a href="/tags/Mac、root/" style="font-size: 10px;">Mac、root</a> <a href="/tags/Math-atan-、Math-atan2-斜率/" style="font-size: 10px;">Math.atan()、Math.atan2() 斜率</a> <a href="/tags/Mongoose参考手册-MongoDB-数据库-node/" style="font-size: 10px;">Mongoose参考手册  MongoDB  数据库 node</a> <a href="/tags/Nginx-负载均衡/" style="font-size: 10px;">Nginx  负载均衡</a> <a href="/tags/Nginx-负载均衡-node-jdc-解决方案-host/" style="font-size: 10px;">Nginx  负载均衡 node  jdc 解决方案 host</a> <a href="/tags/Nginx-Mac-Node/" style="font-size: 10px;">Nginx Mac Node</a> <a href="/tags/Nginx-MySQL-PHP-FPM-Mac-OS/" style="font-size: 10px;">Nginx MySQL PHP-FPM Mac OS</a> <a href="/tags/Nodejs学习实践-nodejs-ES6/" style="font-size: 10px;">Nodejs学习实践 nodejs  ES6</a> <a href="/tags/PreloadJS-EaselJS-TweenJS-SoundJS/" style="font-size: 10px;">PreloadJS EaselJS TweenJS SoundJS</a> <a href="/tags/SVG-Sprites-Symbols/" style="font-size: 10px;">SVG Sprites Symbols</a> <a href="/tags/SVG-icon、-导出优化/" style="font-size: 10px;">SVG icon、 导出优化</a> <a href="/tags/SVG、dataURI、base64/" style="font-size: 10px;">SVG、dataURI、base64</a> <a href="/tags/UMD/" style="font-size: 10px;">UMD</a> <a href="/tags/Vim-vi/" style="font-size: 10px;">Vim vi</a> <a href="/tags/Webhook，git/" style="font-size: 10px;">Webhook，git</a> <a href="/tags/Webhook，git，-Git-Hooks/" style="font-size: 10px;">Webhook，git， Git Hooks</a> <a href="/tags/createJS/" style="font-size: 10px;">createJS</a> <a href="/tags/css-modules-scope-模块化/" style="font-size: 10px;">css modules  scope  模块化</a> <a href="/tags/device-width-window-screen-width-区分ip6与ip6plus/" style="font-size: 10px;">device-width window.screen.width 区分ip6与ip6plus</a> <a href="/tags/deviceorientation、orientationchange-重力感应/" style="font-size: 10px;">deviceorientation、orientationchange 重力感应</a> <a href="/tags/deviceorientation、orientationchange-重力感应-CSS3D/" style="font-size: 10px;">deviceorientation、orientationchange 重力感应 CSS3D</a> <a href="/tags/express/" style="font-size: 10px;">express</a> <a href="/tags/fiddler/" style="font-size: 10px;">fiddler</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/hexo初始/" style="font-size: 10px;">hexo初始</a> <a href="/tags/hexo相关问题/" style="font-size: 10px;">hexo相关问题</a> <a href="/tags/howler-js、-video-js/" style="font-size: 10px;">howler.js、 video.js</a> <a href="/tags/insertAdjacentHTML方法/" style="font-size: 10px;">insertAdjacentHTML方法</a> <a href="/tags/insertAdjacentText方法/" style="font-size: 10px;">insertAdjacentText方法</a> <a href="/tags/javascript、canvas、toDataURL/" style="font-size: 10px;">javascript、canvas、toDataURL()</a> <a href="/tags/letsencrypt、HTTPS、SSL、TSL/" style="font-size: 10px;">letsencrypt、HTTPS、SSL、TSL</a> <a href="/tags/mac-iphone-铃声/" style="font-size: 10px;">mac iphone 铃声</a> <a href="/tags/node-版本管理-nvm-n/" style="font-size: 10px;">node 版本管理  nvm  n</a> <a href="/tags/node-读写excel-JS-XLSX-分析excel写入/" style="font-size: 10px;">node 读写excel JS-XLSX 分析excel写入</a> <a href="/tags/pm2学习实践-nodejs-pm2/" style="font-size: 10px;">pm2学习实践 nodejs pm2</a> <a href="/tags/react-flux-redux-ECMAScript6-Vue-Angular-Angular2-0-NuclearJS/" style="font-size: 10px;">react flux redux ECMAScript6 Vue Angular Angular2.0 NuclearJS</a> <a href="/tags/ssh常用命令-SSH/" style="font-size: 10px;">ssh常用命令  SSH</a> <a href="/tags/svg、path、circle、rect、ellipse、polygon、polyline、line/" style="font-size: 10px;">svg、path、circle、rect、ellipse、polygon、polyline、line</a> <a href="/tags/video-canvas/" style="font-size: 10px;">video canvas</a> <a href="/tags/vue-router-vue/" style="font-size: 10px;">vue-router, vue</a> <a href="/tags/webp/" style="font-size: 10px;">webp</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/三角学、弧度、角度/" style="font-size: 10px;">三角学、弧度、角度</a> <a href="/tags/买房前必备知识-house-home/" style="font-size: 10px;">买房前必备知识  house home</a> <a href="/tags/买车前必备知识-car/" style="font-size: 10px;">买车前必备知识  car</a> <a href="/tags/京东购物H5活动CP重构规范/" style="font-size: 10px;">京东购物H5活动CP重构规范</a> <a href="/tags/优化JavaScript的执行效率/" style="font-size: 10px;">优化JavaScript的执行效率</a> <a href="/tags/前端性能优化/" style="font-size: 10px;">前端性能优化</a> <a href="/tags/吉他/" style="font-size: 10px;">吉他</a> <a href="/tags/吉他知识/" style="font-size: 10px;">吉他知识</a> <a href="/tags/学吉他知识集锦/" style="font-size: 10px;">学吉他知识集锦</a> <a href="/tags/搬瓦工，Shadowsocks/" style="font-size: 10px;">搬瓦工，Shadowsocks</a> <a href="/tags/旅游-帝都畅游-相约北京/" style="font-size: 10px;">旅游 帝都畅游 相约北京</a> <a href="/tags/模块的写法/" style="font-size: 10px;">模块的写法</a> <a href="/tags/运营规范/" style="font-size: 10px;">运营规范</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/pingfan1990/">博客园博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.w3cfuns.com/house.php">前端网博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://pingfan1990.sinaapp.com/">pfan展示平台</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://doc.pfan123.com/">pfan前端开发导航平台</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">因上努力，果上随缘</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">pfan</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://litten.github.io/assets/blogImg/litten.png" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">pfan</h1>
			</hgroup>
			
			<p class="header-subtitle">新起点，新高度</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/pfan123" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/gaolu1990/home?wvr=5" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-webp实践" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/19/webp实践/" class="article-date">
  	<time datetime="2016-07-19T03:51:43.000Z" itemprop="datePublished">2016-07-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/19/webp实践/">webp实践探究</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近组内流行一股探讨webp的风潮，抱着实事求是的态度，本码农也开始了webp探究实践。先扫一下盲，提提WebP的优势。</p>
<h2 id="WebP-的优势"><a href="#WebP-的优势" class="headerlink" title="WebP 的优势"></a>WebP 的优势</h2><p>WebP 格式是 Google 于2010年发布的一种支持有损压缩和无损压缩的图片文件格式，派生自图像编码格式 VP8。它具有较优的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量，同时具备了无损和有损的压缩模式、Alpha 透明以及动画的特性，在 JPEG 和 PNG 上的转化效果都非常优秀、稳定和统一。目前，知名网站 Youtube 、Facebook、Ebay 等均有使用 WebP格式。</p>
<p>WebP 集合了多种图片文件格式的特点，JPEG 适合压缩照片和其他细节丰富的图片，GIF 可以显示动态图片，PNG 支持透明图像，图片色彩非常丰富，而 WebP 则兼具上述优点，且较于它们还有更出色的地方。</p>
<p>据 Google 测试，无损压缩后的 WebP 比 PNG 文件少了 45% 的文件大小，即使 PNG 文件经过其他压缩工具压缩后，WebP 还是可以减少 28% 的文件大小。此外，与 JPEG 相比，在质量相同的情况下，WebP 格式图像的体积要比 JPEG 格式图像小 40%，而 WebP 在压缩方面比 JPEG 格式更优越。    </p>
<h2 id="Webp-转换工具"><a href="#Webp-转换工具" class="headerlink" title="Webp 转换工具"></a>Webp 转换工具</h2><p>看了我组恩鑫大大的<a href="http://mtd.jd.com/wiki/doku.php?id=blog:2016:07:png_%E8%BD%AC_webp_%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%96%B9%E5%BC%8F" target="_blank" rel="external">png 转 webp 的正确姿势</a>，知道了<a href="https://developers.google.com/speed/webp/" target="_blank" rel="external">WebP Converter工具</a>转换webp的效率是比较高的。</p>
<p>webP Converter工具安装是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo brew install webp</span><br></pre></td></tr></table></figure>
<p>转换webp命令是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cwebp -q 80 image.png -o image.webp</span><br></pre></td></tr></table></figure>
<p>知道了，google提供的工具转换效率高，以及使用方式，鉴于工程化、批量化、敏捷开发的原则，我进行了如下猜想使其达到批量生产的目的：</p>
<p>猜测一：  cwebp命令后面匹配多个参数进行批量转换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cwebp -q 80 image.png -o image.webp -q 80 logo.png -o logo.webp</span><br></pre></td></tr></table></figure>
<p>抱着大大的希望，结果发现，只能转换最后一个图片，只能转换最后一个图片，只能转换最后一个图片，重要的事情说三遍，整个人不好了……</p>
<p>猜测二：通过child_process模块，开子进程，来执行格式webp转换</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">const child_process  = require(&quot;child_process&quot;);</span><br><span class="line">const fs = require(&quot;fs&quot;);</span><br><span class="line">const path = require(&quot;path&quot;);</span><br><span class="line">const curPath = process.cwd();</span><br><span class="line"></span><br><span class="line">function convertWep(opt)&#123;</span><br><span class="line">	var src = opt.src, quality = opt.quality || 60;</span><br><span class="line"></span><br><span class="line">    if(fs.existsSync(src))&#123;</span><br><span class="line">        fs.readdir(src,(err,files) =&gt; &#123;</span><br><span class="line">            if(err)&#123;console.log(err);return;&#125;</span><br><span class="line">            files.forEach(function(filename)&#123;</span><br><span class="line">            </span><br><span class="line">                var url = path.join(src,filename);</span><br><span class="line"></span><br><span class="line">                fs.stat(url,(err, stats) =&gt; &#123;</span><br><span class="line">                    if (err) throw err;</span><br><span class="line">                    </span><br><span class="line">                    if(stats.isFile())&#123;</span><br><span class="line">                    	//不支持bmp格式</span><br><span class="line">                        if(/.*\.png|jpg|gif$/.test(url))&#123;</span><br><span class="line">                        </span><br><span class="line">                        	var webpsrc = url.split(&apos;.&apos;)[0]+&quot;.webp&quot;;</span><br><span class="line">                        	childWebp(path.join(curPath,url),quality,path.join(curPath,webpsrc))</span><br><span class="line">                        	console.log(filename+&quot; 转换webp格式成功&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;else if(stats.isDirectory())&#123;</span><br><span class="line">                        convertWep(&#123;</span><br><span class="line">							&quot;src&quot;:url,</span><br><span class="line">							&quot;quality&quot;:quality                        	</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        console.log(&quot;给定的目录不存，读取不到文件&quot;);</span><br><span class="line">        return;</span><br><span class="line">    &#125;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function childWebp(src , quality,webpsrc)&#123;</span><br><span class="line">	child_process.exec(&quot;cwebp -q &quot;+quality+&quot; &quot;+src+&quot; -o &quot;+webpsrc,(error, stdout, stderr) =&gt; &#123;</span><br><span class="line">	    if (error) &#123;</span><br><span class="line">	      console.log(error.stack);</span><br><span class="line">	      console.log(&apos;Error code: &apos; + error.code);</span><br><span class="line">	      return ;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">convertWep(&#123;</span><br><span class="line">	src:&quot;./images/&quot;,</span><br><span class="line">	quality:60</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>转换结果：<br><img src="http://7xrig5.com1.z0.glb.clouddn.com/1.png" alt="child_process开进程转换结果"></p>
<p>方法原理就是给每个图片单独开子进程进行转换，看结果可以达到批量转换不同质量的webp格式的目的，但是不够优雅，无法达到监测每个图片转换情况，无法监测图片转换完成，以及无法关闭所开的子进程。</p>
<h3 id="gulp-webp转换工具"><a href="#gulp-webp转换工具" class="headerlink" title="gulp-webp转换工具"></a>gulp-webp转换工具</h3><p>本着码农朋友不作死、不服输的精神，反复查阅资料找寻其他自动化转换webp工具，我发现了<a href="https://github.com/sindresorhus/gulp-webp" target="_blank" rel="external">gulp-webp</a>插件也可以达到批量转换，支持 <code>PNG</code>、<code>JPEG</code>、<code>TIFF</code>格式转换，并且转换率基本一致。</p>
<p>使用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const gulp = require(&apos;gulp&apos;);</span><br><span class="line">const webp = require(&apos;gulp-webp&apos;);</span><br><span class="line"></span><br><span class="line">gulp.task(&apos;default&apos;, () =&gt;</span><br><span class="line">    gulp.src(&apos;./images/*.&#123;png,jpg,jpeg&#125;&apos;)</span><br><span class="line">        .pipe(webp(&#123;quality: 60&#125;))</span><br><span class="line">        .pipe(gulp.dest(&apos;./dist&apos;))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>简单看看，示例代码，感觉还是很优雅的，但使用时发现无法提供转换webp具体提示，这点糟透了：<br>执行结果：<br><img src="http://7xrig5.com1.z0.glb.clouddn.com/2.png" alt="child_process开进程转换结果"></p>
<p>gulp-webp与WebP Converter转换率对比:<br><code>WebP Converter</code>: 0.4.3<br><code>gulp-webp</code>: 2.3.0<br>原图： bg.jpg (34.176K)，test.png(141.071K)</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>质量</th>
<th>gulp-webp</th>
<th>WebP Converter</th>
</tr>
</thead>
<tbody>
<tr>
<td>bg.jpg</td>
<td>90%</td>
<td>21.344K</td>
<td>21.344K</td>
</tr>
<tr>
<td></td>
<td>80%</td>
<td>10.250K</td>
<td>10.250K</td>
</tr>
<tr>
<td></td>
<td>70%</td>
<td>7.550K</td>
<td>7.550K</td>
</tr>
<tr>
<td></td>
<td>60%</td>
<td>6.856K</td>
<td>6.856K</td>
</tr>
<tr>
<td></td>
<td>50%</td>
<td>6.034K</td>
<td>6.034K</td>
</tr>
<tr>
<td>test.png</td>
<td>90%</td>
<td>48.390K</td>
<td>48.710K</td>
</tr>
<tr>
<td></td>
<td>80%</td>
<td>29.584K</td>
<td>29.584K</td>
</tr>
<tr>
<td></td>
<td>70%</td>
<td>23.240K</td>
<td>23.240K</td>
</tr>
<tr>
<td></td>
<td>60%</td>
<td>20.734K</td>
<td>20.734K</td>
</tr>
<tr>
<td></td>
<td>50%</td>
<td>18.332K</td>
<td>18.332K</td>
</tr>
</tbody>
</table>
<p>对比结果得出，gulp-webp与WebP Converter转换率基本是一致的，于是乎猜想难道它们使用额转换原理一样。抱着这个猜想，开始了分析<code>gulp-webp</code>转换原理。</p>
<p><code>gulp-webp</code>中 API 提到：</p>
<blockquote>
<p>webp([options])</p>
<p>See the <a href="https://github.com/imagemin/imagemin-webp#imageminwebpoptions" target="_blank" rel="external">imagemin-webp</a> options.</p>
</blockquote>
<p>查看<code>imagemin-webp</code>模块中发现，其中转换模块最终是利用<code>cwebp-bin</code>实现，其原理也是对图片单开子进程实现转换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var execFile = require(&apos;child_process&apos;).execFile;</span><br><span class="line">var cwebp = require(&apos;cwebp-bin&apos;);</span><br><span class="line"></span><br><span class="line">execFile(cwebp, [&apos;input.png&apos;, &apos;-o&apos;, &apos;output.webp&apos;], function (err) &#123;</span><br><span class="line">    if (err) &#123;</span><br><span class="line">        throw err;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    console.log(&apos;Image is converted!&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>结合webp官网给出解释：</p>
<blockquote>
<p>WebP includes the lightweight encoding and decoding library libwebp and the command line tools cwebp and dwebp for converting images to and from the WebP format, as well as tools for viewing, muxing and animating WebP images. The full source code is available on the download page.</p>
</blockquote>
<p>最终结论，<code>WebP Converter</code>与<code>gulp-webp</code>转换webp的核心模块都是<code>cwebp-bin</code>，实现原理、转换效率基本都是一样，所以在使用webp批量转换上，使用gulp-webp插件或前面我提到的第二种猜想方法，都可以达到目的，具体使用可结合个人喜好选用。</p>
<h2 id="Webp-实例使用"><a href="#Webp-实例使用" class="headerlink" title="Webp 实例使用"></a>Webp 实例使用</h2><p>本码农再次本着实事求是的心态，深挖总结webp在项目中实际使用。具体使用方案如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">//注意此脚本需放在样式前面</span><br><span class="line"> checkWebp();</span><br><span class="line"> </span><br><span class="line"> function checkWebp()&#123;</span><br><span class="line">      var img = new Image();</span><br><span class="line">      img.onload = function()&#123;</span><br><span class="line">         if(img.width &gt; 0 &amp;&amp; img.height &gt; 0)&#123;</span><br><span class="line">           document.documentElement.className = &quot;webp&quot;;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      img.onerror = function()&#123;&#125;</span><br><span class="line">      img.src = &quot;data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA&quot;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/201607/sns808/css/style.css&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div class=&quot;wrapper&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"> //样式代码片段</span><br><span class="line"> .wrapper&#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    width:pxTorem(750px);</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    margin:0 auto;</span><br><span class="line">    background:image-url(&quot;bg.jpg&quot;) no-repeat;</span><br><span class="line">    background-size:cover;</span><br><span class="line">&#125;</span><br><span class="line">.webp&#123;</span><br><span class="line">    .wrapper&#123;</span><br><span class="line">        background:image-url(&quot;bg.webp&quot;) no-repeat;</span><br><span class="line">        background-size:cover;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>通过chrome控制台观察结果：</p>
<p><img src="http://7xrig5.com1.z0.glb.clouddn.com/3.png" alt="实践结果"></p>
<p>通过浏览器的自动运算判断，只加载了对应使用的资源，从而达到减少加载资源、提高加载效率的目的。</p>
<p>参考资料：</p>
<ul>
<li><a href="https://github.com/sindresorhus/gulp-webp" target="_blank" rel="external">gulp-webp转换工具</a></li>
<li><a href="https://github.com/imagemin/imagemin-webp#imageminwebpoptions" target="_blank" rel="external">imagemin-webp包装 cwebp-bin</a></li>
<li><a href="https://github.com/imagemin/cwebp-bin" target="_blank" rel="external">底层转换cwebp-bin</a></li>
<li><a href="https://www.npmjs.com/package/webpcss" target="_blank" rel="external">webpcss</a></li>
<li><a href="http://blog.qiniu.com/archives/5793" target="_blank" rel="external">七牛云图片处理实践｜带你认识 WEBP</a></li>
<li><a href="http://7b1fp7.com2.z0.glb.clouddn.com/%E4%B8%83%E7%89%9B%E5%8A%A8%E6%80%81WebP%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97.pdf" target="_blank" rel="external">七牛动态WebP使用指南.pdf</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webp/">webp</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Canvas实时处理Video预研" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/18/Canvas实时处理Video预研/" class="article-date">
  	<time datetime="2016-07-18T03:51:43.000Z" itemprop="datePublished">2016-07-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/18/Canvas实时处理Video预研/">Canvas实时处理Video预研</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="video简介"><a href="#video简介" class="headerlink" title="video简介"></a>video简介</h2><p>HTML5里引入的新标记 <code>&lt;video&gt;</code> 实现了HTML对视频播放和音频播放的原生支持，有了这种原生的HTML5视频播放器/音频播放器，我们不再需要flash技术，而直接能将视频/音频嵌入到了网页中。</p>
<p>由于部分浏览器存在不支持<code>&lt;video&gt;</code> 标签，可以尝试使用<a href="https://github.com/videojs/video.js" target="_blank" rel="external">video.js</a>.</p>
<h2 id="如何嵌入视频"><a href="#如何嵌入视频" class="headerlink" title="如何嵌入视频"></a>如何嵌入视频</h2><p>方式一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;video src=&quot;http://www.webhek.com/~j/theora_testsuite/320x240.ogg&quot; controls autoplay loop&gt;</span><br><span class="line">  Your browser does not support the &lt;code&gt;video&lt;/code&gt; element.</span><br><span class="line">&lt;/video&gt;</span><br></pre></td></tr></table></figure>
<p>方式二：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;video width=&quot;320&quot; height=&quot;240&quot; controls&gt;</span><br><span class="line">  &lt;source src=&quot;movie.mp4&quot; type=&quot;video/mp4&quot;&gt;</span><br><span class="line">  &lt;source src=&quot;movie.ogg&quot; type=&quot;video/ogg&quot;&gt;</span><br><span class="line">您的浏览器不支持Video标签。</span><br><span class="line">&lt;/video&gt;</span><br></pre></td></tr></table></figure>
<h2 id="video常用属性"><a href="#video常用属性" class="headerlink" title="video常用属性"></a>video常用属性</h2><table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>autoplay</td>
<td>如果出现该属性，则视频在就绪后马上播放。</td>
</tr>
<tr>
<td>controls</td>
<td>如果出现该属性，则向用户显示控件，比如播放按钮。</td>
</tr>
<tr>
<td>loop</td>
<td>如果出现该属性，则当媒介文件完成播放后再次开始播放。</td>
</tr>
<tr>
<td>muted</td>
<td>规定视频的音频输出应该被静音。</td>
</tr>
<tr>
<td>poster</td>
<td>规定视频下载时显示的图像，或者在用户点击播放按钮前显示的图像。</td>
</tr>
<tr>
<td>preload</td>
<td>如果出现该属性，则视频在页面加载时进行加载，并预备播放。如果使用 “autoplay”，则忽略该属性。</td>
</tr>
<tr>
<td>webkit-playsinline</td>
<td>IOS允许内嵌播放在网页，因浏览器默认，全局打开。</td>
</tr>
</tbody>
</table>
<h2 id="video在IOS和Andriod使用情况"><a href="#video在IOS和Andriod使用情况" class="headerlink" title="video在IOS和Andriod使用情况"></a>video在IOS和Andriod使用情况</h2><blockquote>
<p>1.video在<code>IOS</code>环境下微信、sq以及uc使用情况<br>默认，全屏播放video，通过webkit-playsinline属性可以达到内嵌入网页播放，添加controls属性会导致出现video控制条.</p>
<p>2.video在<code>Andriod</code>环境下微信、sq以及uc使用情况<br>但凡检测到页面可播放的video元素，都会调用浏览器封装的播放器，全屏播放，不支持webkit-playsinline属性，发现qq域名拥有腾讯x5白名单，可以内嵌播放，默认不会调用全屏播放，但会自动添加浮动全屏按钮。</p>
</blockquote>
<h2 id="video转canvas"><a href="#video转canvas" class="headerlink" title="video转canvas"></a>video转canvas</h2><p>canvas中 drawImage() 方法可以在画布上绘制视频。想通过canvas绘制video视频的方式，来全兼容IOS和Andriod，发现还是无法解决Andriod中存在检测页面中video全屏播发的问题，示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- video视频在ios中wx和sq里面可以通过drawImage实现截取视频，andriod中wx和sq，不管你禁用还是隐藏video都会自动启用系统自带播放器--&gt;</span><br><span class="line">&lt;!-- 这里ios会有控制条，是因为加了controls，不加就可以取消--&gt;</span><br><span class="line">&lt;video id=&quot;video&quot; controls width=&quot;270&quot; autoplay webkit-playsinline=&quot;true&quot;&gt;</span><br><span class="line">  &lt;source src=&quot;http://www.w3school.com.cn/example/html5/mov_bbb.mp4&quot; type=&apos;video/mp4&apos;&gt;</span><br><span class="line">  &lt;source src=&quot;http://www.w3school.com.cn/example/html5/mov_bbb.ogg&quot; type=&apos;video/ogg&apos;&gt;</span><br><span class="line">  &lt;source src=&quot;http://www.w3school.com.cn/example/html5/mov_bbb.webm&quot; type=&apos;video/webm&apos;&gt;</span><br><span class="line">&lt;/video&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;画布（每 20 毫秒，代码就会绘制视频的当前帧）：&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;canvas id=&quot;myCanvas&quot; width=&quot;540&quot; height=&quot;270&quot; style=&quot;border:1px solid #d3d3d3;&quot;&gt;</span><br><span class="line">Your browser does not support the HTML5 canvas tag.</span><br><span class="line">&lt;/canvas&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">var video=document.getElementById(&quot;video&quot;);</span><br><span class="line">var canvas=document.getElementById(&quot;myCanvas&quot;);</span><br><span class="line">ctx=canvas.getContext(&apos;2d&apos;);</span><br><span class="line"></span><br><span class="line">video.addEventListener(&apos;play&apos;, function() &#123;var i=window.setInterval(function() &#123;ctx.drawImage(video,0,0,540,270)&#125;,20);&#125;,false);</span><br><span class="line">video.addEventListener(&apos;pause&apos;,function() &#123;window.clearInterval(i);&#125;,false);</span><br><span class="line">video.addEventListener(&apos;ended&apos;,function() &#123;clearInterval(i);&#125;,false);  </span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<ul>
<li><a href="http://tgideas.qq.com/webplat/info/news_version3/804/7104/7106/m5723/201509/374931.shtml" target="_blank" rel="external">关于“吴亦凡入伍”H5的背后的技术（前端篇）</a></li>
<li><a href="http://mp.weixin.qq.com/s?__biz=MjM5MDQwNjY3Mg==&amp;mid=209431356&amp;idx=1&amp;sn=d4084807268fb54596d8119d8ca99d7d&amp;scene=23&amp;srcid=eIJhX8QYYO7xdxu35qSp#rd" target="_blank" rel="external">“吴亦凡即将入伍”的H5技术到底是怎么实现的？</a></li>
<li><p><a href="http://yanhaijing.com/html/2016/03/12/html5-video/" target="_blank" rel="external">HTML5视频的那些事儿）</a></p>
</li>
<li><p><a href="http://www.haomou.net/2014/08/04/2014_Html5_canvas_video/" target="_blank" rel="external">WebRTC相关的canvas与video</a></p>
</li>
<li><a href="http://www.jianshu.com/p/f198d11577f4" target="_blank" rel="external">字体平滑➕视频转canvas</a></li>
<li><a href="http://annn.me/video2txt-canvas/" target="_blank" rel="external">基于canvas将视频转化成字符动画</a></li>
<li><a href="http://www.w3school.com.cn/tags/canvas_drawimage.asp" target="_blank" rel="external">HTML5 canvas drawImage() 方法</a></li>
<li><a href="http://annn.me/img2txt-canvas/" target="_blank" rel="external">基于canvas将图片转化成字符画</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/video-canvas/">video canvas</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-HTML5 视频直播" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/12/HTML5 视频直播/" class="article-date">
  	<time datetime="2016-07-12T03:51:43.000Z" itemprop="datePublished">2016-07-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/12/HTML5 视频直播/">HTML5 视频直播</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>参考资料：</p>
<ul>
<li><a href="https://imququ.com/post/html5-live-player-1.html" target="_blank" rel="external">HTML5 视频直播（一）</a></li>
<li><a href="https://imququ.com/post/html5-live-player-2.html" target="_blank" rel="external">HTML5 视频直播（二）</a></li>
<li><p><a href="https://imququ.com/post/html5-live-player-3.html" target="_blank" rel="external">HTML5 视频直播（三）</a></p>
</li>
<li><p><a href="http://www.haomou.net/2014/08/04/2014_Html5_canvas_video/" target="_blank" rel="external">WebRTC相关的canvas与video</a></p>
</li>
<li><p><a href="http://www.jianshu.com/p/f198d11577f4" target="_blank" rel="external">字体平滑➕视频转canvas</a></p>
</li>
<li><p><a href="http://www.alloyteam.com/2016/05/h5-camera-literacy/" target="_blank" rel="external">H5视频直播扫盲</a></p>
</li>
<li><a href="https://segmentfault.com/a/1190000000392586" target="_blank" rel="external">使用 WebSockets 进行 HTML5 视频直播</a></li>
<li><a href="https://www.zhihu.com/question/25497090" target="_blank" rel="external">可以用WebRTC来做视频直播吗？</a></li>
<li><a href="http://blog.ucloud.cn/archives/694" target="_blank" rel="external">关于直播，所有的技术细节都在这里了（一）</a></li>
<li><a href="http://blog.ucloud.cn/archives/699" target="_blank" rel="external">关于直播，所有的技术细节都在这里了（二）</a></li>
<li><p><a href="http://blog.ucloud.cn/archives/760" target="_blank" rel="external">关于直播，所有的技术细节都在这里了（三）</a></p>
</li>
<li><p><a href="http://www.jq-school.com/Show.aspx?id=738" target="_blank" rel="external">windows+nginx+ffmpeg实现移动端html5直播m3u8</a></p>
</li>
<li><p><a href="https://github.com/tiantianlan/LiveExplanation" target="_blank" rel="external">直播技术</a></p>
</li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTML5/">HTML5</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HTML5-视频直播-video-canvas/">HTML5 视频直播 video canvas</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-createJS实战深入解析" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/06/createJS实战深入解析/" class="article-date">
  	<time datetime="2016-07-06T15:51:43.000Z" itemprop="datePublished">2016-07-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/06/createJS实战深入解析/">createJS实战深入解析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="CreateJS简介"><a href="#CreateJS简介" class="headerlink" title="CreateJS简介"></a>CreateJS简介</h2><p>CreateJS 是一套可以构建丰富交互体验的 HTML5 游戏的开源工具包，旨在降低 HTML5 项目的开发难度和成本，让开发者以熟悉的方式打造更具现代感的网络交互体验。</p>
<p>CreateJS中文Github:<a href="https://github.com/CreateJS/" target="_blank" rel="external">https://github.com/CreateJS/</a><br>CreateJS英文版Api:<a href="http://www.createjs.com/" target="_blank" rel="external">http://www.createjs.com/</a><br>CreateJS中文版Api:<a href="http://www.createjs.cc/" target="_blank" rel="external">http://www.createjs.cc/</a></p>
<p>CreateJS 中包含：</p>
<ul>
<li>EaselJS：用于 Sprites、动画、向量和位图的绘制，创建 HTML5 Canvas 上的交互体验（包含多点触控），同时提供 Flash 中的“显示列表”功能。</li>
<li>TweenJS：一个简单的用于制作类似 Flash 中“补间动画”的引擎，可生成数字或非数字的连续变化效果。</li>
<li>SoundJS：一个音频播放引擎，能够根据浏览器性能选择音频播放方式。将音频文件作为模块，可随时加载和卸载。</li>
<li>PerloadJS：帮助你简化网站资源预加载工作，无论加载内容是图形、视频、声音、JS、数据……<br>以上的Createjs介绍来自百度，不过通过介绍可以知道，虽然CreateJS看起来复杂，不过四个部分各有作用，其中最主要的就是EaselJS，其余三项不过是为他服务。</li>
</ul>
<p>开发步骤：<br>1、下载类库，可以使用源代码，也可以使用压缩过的min.js，就好像平时写网页一样。<br>2、建立html和canvas标签，onload后再执行createjs相关逻辑。<br>3、编写createjs逻辑。这个非常简单，因为createjs只提供了最简单的基础功能，我们理解了基础功能后就可以叠积木了。</p>
<p>关于createjs，最关键是要理解类结构</p>
<p><img src="/img/create/create.png" alt="createjs类结构"></p>
<p>上图列出了createjs的主要类结构，所有舞台上的内容都是元件，元件的基类是DisplayObject。Container可以包含子元件，舞台Stage本身也是Container。另外Sprite用于表现SpriteSheet帧动画人物、Bitmap用于展示纯静态的人物。 </p>
<p><img src="/img/create/1.jpg" alt="createjs类结构"></p>
<p> 而Filter和Shadow则是滤镜分支，可以针对任意元件实现颜色变换、模糊、阴影等效果。使用滤镜的方式跟Flash一致，需要新建Filter实例，添加到目标元件的FilterList中，Createjs框架在下一帧就会把该元件加上滤镜效果。</p>
<h2 id="EaselJS部分"><a href="#EaselJS部分" class="headerlink" title="EaselJS部分"></a>EaselJS部分</h2><p>EaselJS所有的功能都是被一个全局类<code>createjs</code>所包含，将其打印大致包含如下（有删减）:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">AlphaMapFilter</span><br><span class="line">AlphaMaskFilter</span><br><span class="line">Bitmap   			//位图，用于引入图片  位图类不需要缓存</span><br><span class="line">BitmapText			// 位图中绘制文字</span><br><span class="line">BlurFilter			//模糊滤镜</span><br><span class="line">ButtonHelper</span><br><span class="line">ColorFilter			// 颜色滤镜</span><br><span class="line">ColorMatrix</span><br><span class="line">ColorMatrixFilter</span><br><span class="line">Container</span><br><span class="line">DisplayObject</span><br><span class="line">DisplayProps</span><br><span class="line">DOMElement</span><br><span class="line">EaselJS				//版本信息</span><br><span class="line">Event</span><br><span class="line">EventDispatcher</span><br><span class="line">Filter				//滤镜</span><br><span class="line">Graphics			//绘制各种图形</span><br><span class="line">Matrix2D</span><br><span class="line">MouseEvent       //鼠标事件，用于与用户交互</span><br><span class="line">MovieClip		 //动画剪裁</span><br><span class="line">MovieClipPlugin</span><br><span class="line">Point			//绘制点</span><br><span class="line">Rectangle		//绘制矩形</span><br><span class="line">Shadow			//绘制阴影</span><br><span class="line">Shape			//新建图形图层</span><br><span class="line">Sprite			//帧或帧序列（即动画）</span><br><span class="line">SpriteContainer</span><br><span class="line">SpriteSheet</span><br><span class="line">SpriteSheetBuilder</span><br><span class="line">SpriteSheetUtils</span><br><span class="line">SpriteStage</span><br><span class="line">Stage			//新建舞台</span><br><span class="line">Text			//绘制文本图层</span><br><span class="line">Ticker</span><br><span class="line">Touch			//移动端交互  触摸事件 注册createjs.Touch.enable(stage)  pressup、pressmove</span><br><span class="line">UID				//用于生成序列唯一标识号的全局实用程序</span><br><span class="line">Utility Methods</span><br></pre></td></tr></table></figure>
<p>使用EaselJS基本结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">var stage=new createjs.Stage(&quot;canvas&quot;);</span><br><span class="line">var canvas = new createjs.Stage(&quot;canvas&quot;).canvas;</span><br><span class="line">var container = new createjs.Container();</span><br><span class="line">var ctx = new createjs.Stage(&quot;canvas&quot;).canvas.getContext(&quot;2d&quot;);</span><br><span class="line"></span><br><span class="line">var circle=new createjs.Shape();</span><br><span class="line">circle.graphics.beginFill(&quot;red&quot;).drawCircle(0,0,50);</span><br><span class="line"></span><br><span class="line">//regX,regY向左，向上偏移两，旋转时设置可以让其沿坐标点旋转。</span><br><span class="line">circle.regX = -25;</span><br><span class="line">circle.regY = -25;</span><br><span class="line">circle.x=50;</span><br><span class="line">circle.y=50;</span><br><span class="line"></span><br><span class="line">//增加形状实例显示在舞台列表上</span><br><span class="line">stage.addChild(circle);</span><br><span class="line"></span><br><span class="line">//更新舞台渲染</span><br><span class="line">stage.update();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stage.addEventListener(&quot;stagemousedown&quot;,function()&#123;</span><br><span class="line">	//控制舞台点击</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">stage.addEventListener(&quot;click&quot;,function()&#123;</span><br><span class="line">	//只能点击舞台上的显示元素才能触发</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">//多点触摸功能的设备 pressup,pressmove替换touchstart，touchmove</span><br><span class="line">createjs.Touch.enable(stage);</span><br><span class="line"></span><br><span class="line">//帧频率绘制模式</span><br><span class="line">createjs.Ticker.timingMode = createjs.Ticker.RAF;</span><br><span class="line"></span><br><span class="line">//createjs.Ticker.setFPS(60);</span><br><span class="line"></span><br><span class="line">//获取当前帧频率</span><br><span class="line">createjs.Ticker.getMeasuredFPS()</span><br><span class="line"></span><br><span class="line">stage.addEventListener(&quot;tick&quot;,tick);</span><br></pre></td></tr></table></figure>
<p>1.stagemousedown,stagemouseup,stagemousemove与mousedown,mouseup,mousemove的区别</p>
<blockquote>
<p>(1) stagemousedown,stagemouseup,stagemousemove是针对stage的专属事件<br>(2) mousedown,mouseup,mousemove事件对stage、DisplayObject都可以触发，但针对stage只对舞台上DisplayObject才触发</p>
</blockquote>
<p>2.pressmove、pressup与touchmove,touchend</p>
<blockquote>
<p>(1) 要使用移动端交互，多点触控事件，需先注册createjs.Touch.enable(stage)，开启触摸事件<br>(2) pressmove代替touchmove, pressup代替touchend</p>
</blockquote>
<p>3.DisplayObject中<code>cache</code>提高stage渲染效率<br><code>cache</code>方法其实是把显示对象画到一个新的canvas中，从而每一次stage.update()重绘的时候不用重新渲染了，大大提高效率。<br>通常把一些不经常变化的复杂的显示对象进行<code>cache</code>（比如说有许多子对象的容器或者复杂的Shape），被缓存的显示对象可以移动、旋转、改变透明度。但是被缓存的显示对象的内容变化的话，就要重新调用cache()、updateCahce()、uncache()方法。 </p>
<p>关于cache，<a href="http://createjs.com/#demos/easeljs/cache" target="_blank" rel="external">官网cache例子</a></p>
<p>语法:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cache ( x  y  width  height  [scale=1] )  //scale默认为1</span><br><span class="line"></span><br><span class="line">前四个参数指定了显示对象要缓存的区域，注意的事x和y的坐标都是根据当前这个显示对象本身的坐标系来计算。 </span><br><span class="line">最后一个参数scale表示在缓存时缩放的比例，比如 myShape.cache(0,0,100,100,2) 这样使用时，缓存出来的结果大小事200*200。</span><br></pre></td></tr></table></figure>
<p>缓存一个圆型的Shape，例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var shape = new createjs.Shape();</span><br><span class="line">shape.graphics.beginFill(&quot;#ff0000&quot;).drawCircle(0, 0, 25);</span><br><span class="line">shape.cache(-25, -25, 50, 50);</span><br></pre></td></tr></table></figure>
<p>使用<code>cache</code>注意关键点：</p>
<blockquote>
<p>1.在<code>displayObject</code>上使用<code>filter</code>，要在调用<code>cache</code>方法之前使用filter<br>2.<code>Bitmap</code>对象中使用<code>cache</code>，普通<code>bitmap</code>不要调用<code>cache</code>方法，如果bitmap要使用滤镜<code>filter</code>的话，一定要调用<code>cache</code><br>3.在<code>Sprite</code>对象中，<code>Sprite</code>已经是光栅格式，对于<code>Sprite</code>实例来说<code>cache</code>没有必要。不要为提高性能来调用<code>Sprite</code>的<code>cache</code></p>
</blockquote>
<p>4.DisplayObject中<code>scale</code>、<code>rotation</code>中心点，通过regX,regY偏移，定位到相对<code>DisplayObject</code>坐标点</p>
<blockquote>
<p>例如,让一个100 x100px位图旋转中心,您将设置regX regY 50</p>
</blockquote>
<p>5.Ticker处理帧频率</p>
<p>Ticker类为游戏开发提供了一个主要的定时类,主要的目的就是把stage渲染的工作集中起来，也就是说定时调用stage.update()这个方法。Ticker设置的频率也就是游戏的帧数了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">createjs.Ticker.setFPS(60);</span><br><span class="line">createjs.Ticker.addEventListener(&quot;tick&quot;, handleTick);</span><br><span class="line">stage.addEventListener(&quot;stagemousedown&quot;, function(event)&#123;</span><br><span class="line">    createjs.Ticker.setPaused(!createjs.Ticker.getPaused());</span><br><span class="line">&#125;);</span><br><span class="line">function handleTick(event)&#123;</span><br><span class="line">	if(!event.paused)&#123;</span><br><span class="line">	  ……</span><br><span class="line">	&#125;</span><br><span class="line">	stage.update();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在侦听函数中event的数据 </span><br><span class="line">1.event.paused 表示ticker是否处于暂停状态 </span><br><span class="line">2.event.delta 在上一次tick事件之后到这次事件的时间间隔，以毫秒为单位。 </span><br><span class="line">3.event.time 在Ticker被初始化以后的时间总和，以毫秒为单位。 </span><br><span class="line">4.event.runTime 在Ticker被初始化以后没有暂停的时间总和，以毫秒为单位。</span><br></pre></td></tr></table></figure>
<p>Ticker常用属性和方法：<br>1.paused 在ticker暂停时，所有的侦听器仍然会接受到tick事件，但是事件中的paused会是true（createjs.Ticker.paused = true）；<br>2.timingMode指定tick的timing模式。一共有三种模式，TIMEOUT、RAF和RAF_SYNCHEN。<br>（1）TIMEOUT，这种模式下使用的就是setTimeOut这个方法实现的。是timingMode的默认模式。<br>（2）RAF 在这个模式下使用requestAnimationFrame，完全忽略Ticker的帧频。如果requestAnimationFrame API不支持的话就用TIMEOUT模式。<br>（3）RAF_SYNCHEN 在这个模式下使用requestAnimationFrame，但是试图与ticker的帧频同步。如果requestAnimationFrame API不支持的话就用TIMEOUT模式。<br>3.getMeasuredFPS() 获得当前的实际帧频。<br>4.getMeasuredTickTime 获得平均一次tick所有的时间，大概就是在这一次tick所用的时间。</p>
<h2 id="PrloadJS部分"><a href="#PrloadJS部分" class="headerlink" title="PrloadJS部分"></a>PrloadJS部分</h2><p>PreloadJS是一个用来管理和协调相关资源加载的类库，它可以方便的帮助你预先加载相关资源。当我们打印PreloadJS对象，发现主要提供以下类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">AbstractLoader</span><br><span class="line">AbstractMediaLoader</span><br><span class="line">AbstractRequest</span><br><span class="line">BinaryLoader  //二进制文件的加载</span><br><span class="line">CSSLoader	  //CSS文件的加载</span><br><span class="line">DataUtils</span><br><span class="line">DomUtils</span><br><span class="line">ImageLoader</span><br><span class="line">JavaScriptLoader</span><br><span class="line">JSONLoader   	//加载JSON</span><br><span class="line">JSONPLoader		//要加载JSON跨域，使用JSONP和 JSONPLoader 代替</span><br><span class="line">LoadItem</span><br><span class="line">LoadQueue   //加载管理器，可以预先加载一个文件或者一个文件队列</span><br><span class="line">ManifestLoader</span><br><span class="line">MediaTagRequest</span><br><span class="line">PreloadJS</span><br><span class="line">ProgressEvent</span><br><span class="line">RequestUtils</span><br><span class="line">SamplePlugin</span><br><span class="line">SoundLoader</span><br><span class="line">SpriteSheetLoader</span><br><span class="line">SVGLoader		//加载svg</span><br><span class="line">TagRequest</span><br><span class="line">TextLoader</span><br><span class="line">VideoLoader</span><br><span class="line">XHRRequest</span><br><span class="line">XMLLoader</span><br><span class="line">```	</span><br><span class="line">LoadQueue类，应该来说平时使用比较多，这里就主要聊聊LoadQueue。</span><br><span class="line"></span><br><span class="line">LoadQueue 类</span><br><span class="line">LoadQueue类是预加​​载内容的主要API。 LoadQueue是负载管理器，它可以预载是单个文件或文件的队列。</span><br><span class="line"></span><br><span class="line">LoadQueue包含了几个可以订阅的事件：</span><br><span class="line"></span><br><span class="line">- complete: 当队列完成加载所有文件时。</span><br><span class="line">- error: 当队列与任何文件遇到错误时。</span><br><span class="line">- progress: 对于整个队列进展已经改变。</span><br><span class="line">- fileload: 单个文件已完成加载。</span><br><span class="line">- fileprogress: 单个文件进度变化。注意,只有文件装载XHR(或可能通过插件)将 file 事件进展除了0或100%。</span><br><span class="line"></span><br><span class="line">LoadQueue支持相关文件类型如下：</span><br><span class="line"></span><br><span class="line">- BINARY: XHR调用的二进制文件</span><br><span class="line">- CSS: CSS文件</span><br><span class="line">- IMAGE: 一般图片文件格式</span><br><span class="line">- JAVASCRIPT: JavaScript文件</span><br><span class="line">- JSON: JSON数据</span><br><span class="line">- JSONP: 跨域JSON文件</span><br><span class="line">- MANIFEST: JSON格式的文件列表</span><br><span class="line">- SOUND: 音频文件</span><br><span class="line">- SVG: SVG文件</span><br><span class="line">- TEXT: 文本文件 - 仅支持XHR</span><br><span class="line">- XML: XML数据</span><br></pre></td></tr></table></figure></p>
<p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var queue = new createjs.LoadQueue(true); //LoadQueue ( [preferXHR=true]  [basePath=&quot;&quot;]  [crossOrigin=&quot;&quot;] )</span><br><span class="line"></span><br><span class="line">queue.loadManifest([&#123;</span><br><span class="line">    id: &quot;guide&quot;,</span><br><span class="line">    src: &quot;images/guide.png&quot;</span><br><span class="line">  &#125;&#125;]);</span><br><span class="line"></span><br><span class="line">queue.on(&quot;fileload&quot;, handleFileLoad, this);</span><br><span class="line">queue.on(&quot;complete&quot;, handleComplete, this);</span><br><span class="line">queue.on(&quot;progress&quot;, handleProgress, this);</span><br><span class="line"></span><br><span class="line">function handleComplete()&#123;</span><br><span class="line">	queue.getResult(‘id’);</span><br><span class="line">&#125;</span><br><span class="line">function handleProgress(event) &#123;</span><br><span class="line">  console.log(event.progress * 100)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>LoadQueue支持相关文件类型如下：</p>
<ul>
<li><p>预加载音频文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//初始化插件</span><br><span class="line"> queue.installPlugin(createjs.Sound);</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置加载路径<br>注意，第一个参数为true，代表通过xhr形式加载，但是通常，我们可能需要http加载，所以建议设置为false，以免造成重复加载。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var queue = new createjs.LoadQueue(false,&quot;./base/src/&quot;); //LoadQueue ( [preferXHR=true]  [basePath=&quot;&quot;]  [crossOrigin=&quot;&quot;] )</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取加载进度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.progress</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取预加载资源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preload.getResult(‘id’);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="TweenJS部分"><a href="#TweenJS部分" class="headerlink" title="TweenJS部分"></a>TweenJS部分</h2><p>TweenJS Javascript库提供了一个简单但强大的渐变界面。它支持渐变的数字对象属性&amp;CSS样式属性,并允许您链接补间动画和行动结合起来,创造出复杂的序列。其中主要包含如下类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CSSPlugin   //用css的方式写动画，但是它采用的形式是html，效率低下</span><br><span class="line">Ease		//提供支持贝塞尔动画</span><br><span class="line">MotionGuidePlugin   //轨迹动画插件</span><br><span class="line">SamplePlugin</span><br><span class="line">Timeline</span><br><span class="line">Tween  </span><br><span class="line">TweenJS</span><br></pre></td></tr></table></figure>
<p>Tween构造函数:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Tween ( target  [props]  [pluginData] )</span><br></pre></td></tr></table></figure></p>
<p>参数</p>
<ul>
<li>target对象: 将其属性渐变的目标对象</li>
<li><p>[props] 对象: 适用于这个渐变实例的配置属性(ex. {loop:true, paused:true}. 所有属性默认为false. 被支持的小道具是:<br>(1)loop: 设置循环属性渐变，true为循环，false为不循环.<br>(2)useTicks: 使用嘀嗒走针是因为持续时间而不是毫秒.<br>(3)ignoreGlobalPause: 设置在渐变动画上 ignoreGlobalPause 属性.<br>(4)override:如果设置为true,Tween.removeTweens(target) 将被称为移除相同目标的所有别的渐变动画.<br>(5)paused: 指示是否开始停止渐变动画.<br>(6)position: 表明这个渐变的初始位置.<br>(7)onChange: 指定一个“change”事件侦听器.</p>
</li>
<li><p>[pluginData] 对象(可选的):一个对象包含的数据供安装使用插件。有关详细信息,请参阅个别插件的文档.</p>
</li>
</ul>
<p>Tween实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">target.alpha = 1;</span><br><span class="line">   createjs.Tween.get(target, &#123;override:true&#125;) //多个渐变动画可以指向相同的实例,然而如果他们影响相同的属性可能会有意外行为. 需要停止所有的渐变动画, 使用 removeTweens 或者通过 override:true</span><br><span class="line">   .to(&#123;alpha:0.5,x:10,y:20&#125;, 1000, createjs.Ease.linear)</span><br><span class="line">   .wait(500)</span><br><span class="line">   .call(handleComplete)</span><br><span class="line">   .to(&#123;alpha:0, visible:false&#125;, 1000, createjs.Ease.bounceInOut)</span><br><span class="line">   .addEventListener(&quot;change&quot;,handleChange)</span><br><span class="line"></span><br><span class="line">   function handleComplete() &#123;</span><br><span class="line">   //Tween complete</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>get 获取目标元素</li>
<li>to 执行动画</li>
<li>wait 队列等待</li>
<li>call 执行回调函数</li>
<li>createjs.Ease.bounceInOut 缓动效果</li>
<li>change  订阅 change 事件以便当目标的属性改变时获得通知</li>
</ul>
<p>使用Ease可以控制运动的轨迹，实现曲线的运动，还可以控制运动过程，比如先加速再减速等，在Tweenjs官方示例中有两个可以用来观察Ease提供的各个参数对运动过程产生的影响，<br><a href="http://andysaia.com/blog/tweenjs/" target="_blank" rel="external">http://andysaia.com/blog/tweenjs/</a><br><a href="http://www.createjs.com/demos/tweenjs/tween_sparktable" target="_blank" rel="external">http://www.createjs.com/demos/tweenjs/tween_sparktable</a></p>
<p>参考资料：</p>
<ul>
<li><a href="http://www.createjs.cc/" target="_blank" rel="external">createjs中文api</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47261225" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（一）EaselJS简介</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47282073" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（二）使用EaselJS处理图片</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47302309" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（三）使用EaselJS中的制作Sprite类制作</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47323573" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（四）TweenJS和Tick动画</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47326093" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（五）PreloadJS和SoundJS</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47357747" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（六）完成一个简单的打飞机游戏（上）</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47382401" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（七）完成一个简单的打飞机游戏（下）</a></li>
<li><a href="http://blog.csdn.net/lanix516/article/details/47402499" target="_blank" rel="external">如何使用Createjs来编写HTML5游戏（八） 通过继承扩展EaselJS中的基础元素</a></li>
<li><a href="http://blog.csdn.net/k_shl_2011/article/category/5666125" target="_blank" rel="external">createjs教程</a></li>
<li><a href="http://canlynet.iteye.com/blog/2310855" target="_blank" rel="external">createjs碰撞检测hitTest(x,y),只是检查物体圆心到某点</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PreloadJS-EaselJS-TweenJS-SoundJS/">PreloadJS EaselJS TweenJS SoundJS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/createJS/">createJS</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/JavaScript/">JavaScript</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-CSS模块化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/27/CSS模块化/" class="article-date">
  	<time datetime="2016-06-27T10:40:43.000Z" itemprop="datePublished">2016-06-27</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/27/CSS模块化/">CSS模块化</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>React Style, jsxstyle 和 Radium 是目前在React中写样式的三个最新，最好，最可行的方法。</p>
<h2 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h2><ul>
<li><a href="https://github.com/css-modules/css-modules" target="_blank" rel="external">CSS Modules</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/20495964" target="_blank" rel="external">CSS Modules 详解及 React 中实践</a></li>
<li><a href="https://boke.io/tan-tan-css-modules/" target="_blank" rel="external">谈谈 CSS Modules</a></li>
<li><a href="http://www.w3cplus.com/css/css-modules.html" target="_blank" rel="external">CSS模块</a></li>
<li><a href="http://www.alloyteam.com/2015/11/we-will-be-componentized-web-long-text/" target="_blank" rel="external">致我们终将组件化的Web</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/css-modules-scope-模块化/">css modules  scope  模块化</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/CSS3/">CSS3</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Mac怎么制作iphone铃声？" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/21/Mac怎么制作iphone铃声？/" class="article-date">
  	<time datetime="2016-06-21T15:40:43.000Z" itemprop="datePublished">2016-06-21</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/21/Mac怎么制作iphone铃声？/">Mac怎么制作iphone铃声？</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>有时候听到好听的音乐就想把它做成手机铃声，那么怎么在Mac上制作iPhone铃声呢？其实，Mac电脑下iTunes本身具有有这个功能，而且操作并不是太难只需要注意几个关键点一步一步引导即可。步骤如下：</p>
<h2 id="一-打开itunes软件"><a href="#一-打开itunes软件" class="headerlink" title="一.打开itunes软件"></a>一.打开itunes软件</h2><p><img src="http://pic.pc6.com/up/2014-8/201408141708053418745.png" alt="打开itunes软件"></p>
<h2 id="二-选择左上脚“文件”——“将文件导入资料库”"><a href="#二-选择左上脚“文件”——“将文件导入资料库”" class="headerlink" title="二. 选择左上脚“文件”——“将文件导入资料库”"></a>二. 选择左上脚“文件”——“将文件导入资料库”</h2><p><img src="http://pic.pc6.com/up/2014-8/201408141709155402601.png" alt="打开itunes软件"></p>
<p>或者直接点击本地音乐文件播放（注意选择iTunes），我们就可以在iTunes最近添加找到文件：<br><img src="/img/macmusic/1.jpg" alt="打开itunes软件"></p>
<h2 id="三-选择你要的文件点击打开"><a href="#三-选择你要的文件点击打开" class="headerlink" title="三. 选择你要的文件点击打开"></a>三. 选择你要的文件点击打开</h2><p><img src="/img/macmusic/2.jpg" alt="打开itunes软件"></p>
<h2 id="四：选择“选项”，然后写上你想要开始和结束的时间，注意iphone的铃声只支持40秒。写好后将起始时间和停止时间都选勾，然后点击右下角的“好”。"><a href="#四：选择“选项”，然后写上你想要开始和结束的时间，注意iphone的铃声只支持40秒。写好后将起始时间和停止时间都选勾，然后点击右下角的“好”。" class="headerlink" title="四：选择“选项”，然后写上你想要开始和结束的时间，注意iphone的铃声只支持40秒。写好后将起始时间和停止时间都选勾，然后点击右下角的“好”。"></a>四：选择“选项”，然后写上你想要开始和结束的时间，注意iphone的铃声只支持40秒。写好后将起始时间和停止时间都选勾，然后点击右下角的“好”。</h2><p><img src="http://pic.pc6.com/up/2014-8/201408141711243985502.png" alt="打开itunes软件"></p>
<h2 id="五：选择左上脚“文件”——“转换”——“创建ACC版本”，iTunes会生成一首歌曲，在原来歌曲的下面。"><a href="#五：选择左上脚“文件”——“转换”——“创建ACC版本”，iTunes会生成一首歌曲，在原来歌曲的下面。" class="headerlink" title="五：选择左上脚“文件”——“转换”——“创建ACC版本”，iTunes会生成一首歌曲，在原来歌曲的下面。"></a>五：选择左上脚“文件”——“转换”——“创建ACC版本”，iTunes会生成一首歌曲，在原来歌曲的下面。</h2><p><img src="/img/macmusic/3.jpg" alt="打开itunes软件"></p>
<h2 id="六：右键点选歌曲例《单车》选择在Finder中显示“然后把后缀名”m4a“改为”m4r“。因为m4r才是iphone铃声的格式，改好后将其移动到桌面，然后在iTunes中把这首铃声删除，option＋command删除文件从资料库，设备。"><a href="#六：右键点选歌曲例《单车》选择在Finder中显示“然后把后缀名”m4a“改为”m4r“。因为m4r才是iphone铃声的格式，改好后将其移动到桌面，然后在iTunes中把这首铃声删除，option＋command删除文件从资料库，设备。" class="headerlink" title="六：右键点选歌曲例《单车》选择在Finder中显示“然后把后缀名”m4a“改为”m4r“。因为m4r才是iphone铃声的格式，改好后将其移动到桌面，然后在iTunes中把这首铃声删除，option＋command删除文件从资料库，设备。"></a>六：右键点选歌曲例《单车》选择在Finder中显示“然后把后缀名”m4a“改为”m4r“。因为m4r才是iphone铃声的格式，改好后将其移动到桌面，然后在iTunes中把这首铃声删除，<code>option＋command</code>删除文件从资料库，设备。</h2><p><img src="/img/macmusic/4.jpg" alt="打开itunes软件"></p>
<h2 id="七-选择左上脚“文件”——“将文件导入资料库”，选择刚才移出到桌面的m4r文件导入"><a href="#七-选择左上脚“文件”——“将文件导入资料库”，选择刚才移出到桌面的m4r文件导入" class="headerlink" title="七. 选择左上脚“文件”——“将文件导入资料库”，选择刚才移出到桌面的m4r文件导入"></a>七. 选择左上脚“文件”——“将文件导入资料库”，选择刚才移出到桌面的<code>m4r</code>文件导入</h2><h2 id="八-点击设备手机图标-点击左侧菜单“铃声”——同步铃声“所选铃声”，应用将此歌曲同步到iphone的铃音库中，即可设置成功"><a href="#八-点击设备手机图标-点击左侧菜单“铃声”——同步铃声“所选铃声”，应用将此歌曲同步到iphone的铃音库中，即可设置成功" class="headerlink" title="八. 点击设备手机图标,点击左侧菜单“铃声”——同步铃声“所选铃声”，应用将此歌曲同步到iphone的铃音库中，即可设置成功"></a>八. 点击设备手机图标,点击左侧菜单“铃声”——同步铃声“所选铃声”，应用将此歌曲同步到iphone的铃音库中，即可设置成功</h2><p><img src="/img/macmusic/5.jpg" alt="打开itunes软件"></p>
<p><img src="/img/macmusic/6.jpg" alt="打开itunes软件"></p>
<p>参考资料：</p>
<ul>
<li><a href="http://jingyan.baidu.com/article/a17d52853026838098c8f2ff.html" target="_blank" rel="external">Mac怎么制作铃声？Mac制作铃声图文教程</a></li>
<li><a href="http://www.pc6.com/edu/67786.html" target="_blank" rel="external">Mac怎么制作iphone铃声</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mac-iphone-铃声/">mac iphone 铃声</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/兴趣爱好/">兴趣爱好</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-如何愉快的使用ESLint进行代码校验" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/16/如何愉快的使用ESLint进行代码校验/" class="article-date">
  	<time datetime="2016-06-16T02:40:43.000Z" itemprop="datePublished">2016-06-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/16/如何愉快的使用ESLint进行代码校验/">如何愉快的使用ESLint进行代码校验－-转载</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一-ESLint是什么？"><a href="#一-ESLint是什么？" class="headerlink" title="一. ESLint是什么？"></a>一. ESLint是什么？</h2><p>ESLint 是一个开源的 JavaScript 代码校验工具，最初是由 Nicholas C. Zakas 在2013年创建的。经常被用来发现问题的模式或代码，不符合特定的风格准则。</p>
<blockquote>
<p>ESLint 创建的首要原因是为了让开发人员创建自己的校验规则，ESLint 的目的是让所有的规则完全可插拔。虽然ESLint将附带一些内置的规则，你可以在任何时间点动态加载规则。</p>
</blockquote>
<h2 id="二-ESLint有什么用？"><a href="#二-ESLint有什么用？" class="headerlink" title="二. ESLint有什么用？"></a>二. ESLint有什么用？</h2><ul>
<li>可以辅助编码规范执行，有效控制代码质量</li>
<li>默认规则包含所有 JSLint、JSHint 中存在的规则，易迁移；</li>
<li>规则可配置性高：可设置「警告」、「错误」两个 error 等级，或者直接禁用；</li>
<li>包含代码风格检测的规则；</li>
<li>支持插件扩展、自定义规则。</li>
</ul>
<h2 id="三-ESLint规则一览"><a href="#三-ESLint规则一览" class="headerlink" title="三. ESLint规则一览"></a>三. ESLint规则一览</h2><p><em>Vim</em>常见有两种模式一种是<em>Insert</em>模式，该模式下可以像其它文本编辑器一样正常输入字符；另一种是<em>Normal</em>模式，该模式下<em>Vim</em>监听用户的按键可以对文本进行快速修改。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">&quot;no-alert&quot;: 0,//禁止使用alert confirm prompt</span><br><span class="line"> &quot;no-array-constructor&quot;: 2,//禁止使用数组构造器</span><br><span class="line"> &quot;no-bitwise&quot;: 0,//禁止使用按位运算符</span><br><span class="line"> &quot;no-caller&quot;: 1,//禁止使用arguments.caller或arguments.callee</span><br><span class="line"> &quot;no-catch-shadow&quot;: 2,//禁止catch子句参数与外部作用域变量同名</span><br><span class="line"> &quot;no-class-assign&quot;: 2,//禁止给类赋值</span><br><span class="line"> &quot;no-cond-assign&quot;: 2,//禁止在条件表达式中使用赋值语句</span><br><span class="line"> &quot;no-console&quot;: 2,//禁止使用console</span><br><span class="line"> &quot;no-const-assign&quot;: 2,//禁止修改const声明的变量</span><br><span class="line"> &quot;no-constant-condition&quot;: 2,//禁止在条件中使用常量表达式 if(true) if(1)</span><br><span class="line"> &quot;no-continue&quot;: 0,//禁止使用continue</span><br><span class="line"> &quot;no-control-regex&quot;: 2,//禁止在正则表达式中使用控制字符</span><br><span class="line"> &quot;no-debugger&quot;: 2,//禁止使用debugger</span><br><span class="line"> &quot;no-delete-var&quot;: 2,//不能对var声明的变量使用delete操作符</span><br><span class="line"> &quot;no-div-regex&quot;: 1,//不能使用看起来像除法的正则表达式/=foo/</span><br><span class="line"> &quot;no-dupe-keys&quot;: 2,//在创建对象字面量时不允许键重复 &#123;a:1,a:1&#125;</span><br><span class="line"> &quot;no-dupe-args&quot;: 2,//函数参数不能重复</span><br><span class="line"> &quot;no-duplicate-case&quot;: 2,//switch中的case标签不能重复</span><br><span class="line"> &quot;no-else-return&quot;: 2,//如果if语句里面有return,后面不能跟else语句</span><br><span class="line"> &quot;no-empty&quot;: 2,//块语句中的内容不能为空</span><br><span class="line"> &quot;no-empty-character-class&quot;: 2,//正则表达式中的[]内容不能为空</span><br><span class="line"> &quot;no-empty-label&quot;: 2,//禁止使用空label</span><br><span class="line"> &quot;no-eq-null&quot;: 2,//禁止对null使用==或!=运算符</span><br><span class="line"> &quot;no-eval&quot;: 1,//禁止使用eval</span><br><span class="line"> &quot;no-ex-assign&quot;: 2,//禁止给catch语句中的异常参数赋值</span><br><span class="line"> &quot;no-extend-native&quot;: 2,//禁止扩展native对象</span><br><span class="line"> &quot;no-extra-bind&quot;: 2,//禁止不必要的函数绑定</span><br><span class="line"> &quot;no-extra-boolean-cast&quot;: 2,//禁止不必要的bool转换</span><br><span class="line"> &quot;no-extra-parens&quot;: 2,//禁止非必要的括号</span><br><span class="line"> &quot;no-extra-semi&quot;: 2,//禁止多余的冒号</span><br><span class="line"> &quot;no-fallthrough&quot;: 1,//禁止switch穿透</span><br><span class="line"> &quot;no-floating-decimal&quot;: 2,//禁止省略浮点数中的0 .5 3.</span><br><span class="line"> &quot;no-func-assign&quot;: 2,//禁止重复的函数声明</span><br><span class="line"> &quot;no-implicit-coercion&quot;: 1,//禁止隐式转换</span><br><span class="line"> &quot;no-implied-eval&quot;: 2,//禁止使用隐式eval</span><br><span class="line"> &quot;no-inline-comments&quot;: 0,//禁止行内备注</span><br><span class="line"> &quot;no-inner-declarations&quot;: [2, &quot;functions&quot;],//禁止在块语句中使用声明（变量或函数）</span><br><span class="line"> &quot;no-invalid-regexp&quot;: 2,//禁止无效的正则表达式</span><br><span class="line"> &quot;no-invalid-this&quot;: 2,//禁止无效的this，只能用在构造器，类，对象字面量</span><br><span class="line"> &quot;no-irregular-whitespace&quot;: 2,//不能有不规则的空格</span><br><span class="line"> &quot;no-iterator&quot;: 2,//禁止使用__iterator__ 属性</span><br><span class="line"> &quot;no-label-var&quot;: 2,//label名不能与var声明的变量名相同</span><br><span class="line"> &quot;no-labels&quot;: 2,//禁止标签声明</span><br><span class="line"> &quot;no-lone-blocks&quot;: 2,//禁止不必要的嵌套块</span><br><span class="line"> &quot;no-lonely-if&quot;: 2,//禁止else语句内只有if语句</span><br><span class="line"> &quot;no-loop-func&quot;: 1,//禁止在循环中使用函数（如果没有引用外部变量不形成闭包就可以）</span><br><span class="line"> &quot;no-mixed-requires&quot;: [0, false],//声明时不能混用声明类型</span><br><span class="line"> &quot;no-mixed-spaces-and-tabs&quot;: [2, false],//禁止混用tab和空格</span><br><span class="line"> &quot;linebreak-style&quot;: [0, &quot;windows&quot;],//换行风格</span><br><span class="line"> &quot;no-multi-spaces&quot;: 1,//不能用多余的空格</span><br><span class="line"> &quot;no-multi-str&quot;: 2,//字符串不能用\换行</span><br><span class="line"> &quot;no-multiple-empty-lines&quot;: [1, &#123;&quot;max&quot;: 2&#125;],//空行最多不能超过2行</span><br><span class="line"> &quot;no-native-reassign&quot;: 2,//不能重写native对象</span><br><span class="line"> &quot;no-negated-in-lhs&quot;: 2,//in 操作符的左边不能有!</span><br><span class="line"> &quot;no-nested-ternary&quot;: 0,//禁止使用嵌套的三目运算</span><br><span class="line"> &quot;no-new&quot;: 1,//禁止在使用new构造一个实例后不赋值</span><br><span class="line"> &quot;no-new-func&quot;: 1,//禁止使用new Function</span><br><span class="line"> &quot;no-new-object&quot;: 2,//禁止使用new Object()</span><br><span class="line"> &quot;no-new-require&quot;: 2,//禁止使用new require</span><br><span class="line"> &quot;no-new-wrappers&quot;: 2,//禁止使用new创建包装实例，new String new Boolean new Number</span><br><span class="line"> &quot;no-obj-calls&quot;: 2,//不能调用内置的全局对象，比如Math() JSON()</span><br><span class="line"> &quot;no-octal&quot;: 2,//禁止使用八进制数字</span><br><span class="line"> &quot;no-octal-escape&quot;: 2,//禁止使用八进制转义序列</span><br><span class="line"> &quot;no-param-reassign&quot;: 2,//禁止给参数重新赋值</span><br><span class="line"> &quot;no-path-concat&quot;: 0,//node中不能使用__dirname或__filename做路径拼接</span><br><span class="line"> &quot;no-plusplus&quot;: 0,//禁止使用++，--</span><br><span class="line"> &quot;no-process-env&quot;: 0,//禁止使用process.env</span><br><span class="line"> &quot;no-process-exit&quot;: 0,//禁止使用process.exit()</span><br><span class="line"> &quot;no-proto&quot;: 2,//禁止使用__proto__属性</span><br><span class="line"> &quot;no-redeclare&quot;: 2,//禁止重复声明变量</span><br><span class="line"> &quot;no-regex-spaces&quot;: 2,//禁止在正则表达式字面量中使用多个空格 /foo bar/</span><br><span class="line"> &quot;no-restricted-modules&quot;: 0,//如果禁用了指定模块，使用就会报错</span><br><span class="line"> &quot;no-return-assign&quot;: 1,//return 语句中不能有赋值表达式</span><br><span class="line"> &quot;no-script-url&quot;: 0,//禁止使用javascript:void(0)</span><br><span class="line"> &quot;no-self-compare&quot;: 2,//不能比较自身</span><br><span class="line"> &quot;no-sequences&quot;: 0,//禁止使用逗号运算符</span><br><span class="line"> &quot;no-shadow&quot;: 2,//外部作用域中的变量不能与它所包含的作用域中的变量或参数同名</span><br><span class="line"> &quot;no-shadow-restricted-names&quot;: 2,//严格模式中规定的限制标识符不能作为声明时的变量名使用</span><br><span class="line"> &quot;no-spaced-func&quot;: 2,//函数调用时 函数名与()之间不能有空格</span><br><span class="line"> &quot;no-sparse-arrays&quot;: 2,//禁止稀疏数组， [1,,2]</span><br><span class="line"> &quot;no-sync&quot;: 0,//nodejs 禁止同步方法</span><br><span class="line"> &quot;no-ternary&quot;: 0,//禁止使用三目运算符</span><br><span class="line"> &quot;no-trailing-spaces&quot;: 1,//一行结束后面不要有空格</span><br><span class="line"> &quot;no-this-before-super&quot;: 0,//在调用super()之前不能使用this或super</span><br><span class="line"> &quot;no-throw-literal&quot;: 2,//禁止抛出字面量错误 throw &quot;error&quot;;</span><br><span class="line"> &quot;no-undef&quot;: 1,//不能有未定义的变量</span><br><span class="line"> &quot;no-undef-init&quot;: 2,//变量初始化时不能直接给它赋值为undefined</span><br><span class="line"> &quot;no-undefined&quot;: 2,//不能使用undefined</span><br><span class="line"> &quot;no-unexpected-multiline&quot;: 2,//避免多行表达式</span><br><span class="line"> &quot;no-underscore-dangle&quot;: 1,//标识符不能以_开头或结尾</span><br><span class="line"> &quot;no-unneeded-ternary&quot;: 2,//禁止不必要的嵌套 var isYes = answer === 1 ? true : false;</span><br><span class="line"> &quot;no-unreachable&quot;: 2,//不能有无法执行的代码</span><br><span class="line"> &quot;no-unused-expressions&quot;: 2,//禁止无用的表达式</span><br><span class="line"> &quot;no-unused-vars&quot;: [2, &#123;&quot;vars&quot;: &quot;all&quot;, &quot;args&quot;: &quot;after-used&quot;&#125;],//不能有声明后未被使用的变量或参数</span><br><span class="line"> &quot;no-use-before-define&quot;: 2,//未定义前不能使用</span><br><span class="line"> &quot;no-useless-call&quot;: 2,//禁止不必要的call和apply</span><br><span class="line"> &quot;no-void&quot;: 2,//禁用void操作符</span><br><span class="line"> &quot;no-var&quot;: 0,//禁用var，用let和const代替</span><br><span class="line"> &quot;no-warning-comments&quot;: [1, &#123; &quot;terms&quot;: [&quot;todo&quot;, &quot;fixme&quot;, &quot;xxx&quot;], &quot;location&quot;: &quot;start&quot; &#125;],//不能有警告备注</span><br><span class="line"> &quot;no-with&quot;: 2,//禁用with</span><br><span class="line"></span><br><span class="line"> &quot;array-bracket-spacing&quot;: [2, &quot;never&quot;],//是否允许非空数组里面有多余的空格</span><br><span class="line"> &quot;arrow-parens&quot;: 0,//箭头函数用小括号括起来</span><br><span class="line"> &quot;arrow-spacing&quot;: 0,//=&gt;的前/后括号</span><br><span class="line"> &quot;accessor-pairs&quot;: 0,//在对象中使用getter/setter</span><br><span class="line"> &quot;block-scoped-var&quot;: 0,//块语句中使用var</span><br><span class="line"> &quot;brace-style&quot;: [1, &quot;1tbs&quot;],//大括号风格</span><br><span class="line"> &quot;callback-return&quot;: 1,//避免多次调用回调什么的</span><br><span class="line"> &quot;camelcase&quot;: 2,//强制驼峰法命名</span><br><span class="line"> &quot;comma-dangle&quot;: [2, &quot;never&quot;],//对象字面量项尾不能有逗号</span><br><span class="line"> &quot;comma-spacing&quot;: 0,//逗号前后的空格</span><br><span class="line"> &quot;comma-style&quot;: [2, &quot;last&quot;],//逗号风格，换行时在行首还是行尾</span><br><span class="line"> &quot;complexity&quot;: [0, 11],//循环复杂度</span><br><span class="line"> &quot;computed-property-spacing&quot;: [0, &quot;never&quot;],//是否允许计算后的键名什么的</span><br><span class="line"> &quot;consistent-return&quot;: 0,//return 后面是否允许省略</span><br><span class="line"> &quot;consistent-this&quot;: [2, &quot;that&quot;],//this别名</span><br><span class="line"> &quot;constructor-super&quot;: 0,//非派生类不能调用super，派生类必须调用super</span><br><span class="line"> &quot;curly&quot;: [2, &quot;all&quot;],//必须使用 if()&#123;&#125; 中的&#123;&#125;</span><br><span class="line"> &quot;default-case&quot;: 2,//switch语句最后必须有default</span><br><span class="line"> &quot;dot-location&quot;: 0,//对象访问符的位置，换行的时候在行首还是行尾</span><br><span class="line"> &quot;dot-notation&quot;: [0, &#123; &quot;allowKeywords&quot;: true &#125;],//避免不必要的方括号</span><br><span class="line"> &quot;eol-last&quot;: 0,//文件以单一的换行符结束</span><br><span class="line"> &quot;eqeqeq&quot;: 2,//必须使用全等</span><br><span class="line"> &quot;func-names&quot;: 0,//函数表达式必须有名字</span><br><span class="line"> &quot;func-style&quot;: [0, &quot;declaration&quot;],//函数风格，规定只能使用函数声明/函数表达式</span><br><span class="line"> &quot;generator-star-spacing&quot;: 0,//生成器函数*的前后空格</span><br><span class="line"> &quot;guard-for-in&quot;: 0,//for in循环要用if语句过滤</span><br><span class="line"> &quot;handle-callback-err&quot;: 0,//nodejs 处理错误</span><br><span class="line"> &quot;id-length&quot;: 0,//变量名长度</span><br><span class="line"> &quot;indent&quot;: [2, 4],//缩进风格</span><br><span class="line"> &quot;init-declarations&quot;: 0,//声明时必须赋初值</span><br><span class="line"> &quot;key-spacing&quot;: [0, &#123; &quot;beforeColon&quot;: false, &quot;afterColon&quot;: true &#125;],//对象字面量中冒号的前后空格</span><br><span class="line"> &quot;lines-around-comment&quot;: 0,//行前/行后备注</span><br><span class="line"> &quot;max-depth&quot;: [0, 4],//嵌套块深度</span><br><span class="line"> &quot;max-len&quot;: [0, 80, 4],//字符串最大长度</span><br><span class="line"> &quot;max-nested-callbacks&quot;: [0, 2],//回调嵌套深度</span><br><span class="line"> &quot;max-params&quot;: [0, 3],//函数最多只能有3个参数</span><br><span class="line"> &quot;max-statements&quot;: [0, 10],//函数内最多有几个声明</span><br><span class="line"> &quot;new-cap&quot;: 2,//函数名首行大写必须使用new方式调用，首行小写必须用不带new方式调用</span><br><span class="line"> &quot;new-parens&quot;: 2,//new时必须加小括号</span><br><span class="line"> &quot;newline-after-var&quot;: 2,//变量声明后是否需要空一行</span><br><span class="line"> &quot;object-curly-spacing&quot;: [0, &quot;never&quot;],//大括号内是否允许不必要的空格</span><br><span class="line"> &quot;object-shorthand&quot;: 0,//强制对象字面量缩写语法</span><br><span class="line"> &quot;one-var&quot;: 1,//连续声明</span><br><span class="line"> &quot;operator-assignment&quot;: [0, &quot;always&quot;],//赋值运算符 += -=什么的</span><br><span class="line"> &quot;operator-linebreak&quot;: [2, &quot;after&quot;],//换行时运算符在行尾还是行首</span><br><span class="line"> &quot;padded-blocks&quot;: 0,//块语句内行首行尾是否要空行</span><br><span class="line"> &quot;prefer-const&quot;: 0,//首选const</span><br><span class="line"> &quot;prefer-spread&quot;: 0,//首选展开运算</span><br><span class="line"> &quot;prefer-reflect&quot;: 0,//首选Reflect的方法</span><br><span class="line"> &quot;quotes&quot;: [1, &quot;single&quot;],//引号类型 `` &quot;&quot; &apos;&apos;</span><br><span class="line"> &quot;quote-props&quot;:[2, &quot;always&quot;],//对象字面量中的属性名是否强制双引号</span><br><span class="line"> &quot;radix&quot;: 2,//parseInt必须指定第二个参数</span><br><span class="line"> &quot;id-match&quot;: 0,//命名检测</span><br><span class="line"> &quot;require-yield&quot;: 0,//生成器函数必须有yield</span><br><span class="line"> &quot;semi&quot;: [2, &quot;always&quot;],//语句强制分号结尾</span><br><span class="line"> &quot;semi-spacing&quot;: [0, &#123;&quot;before&quot;: false, &quot;after&quot;: true&#125;],//分号前后空格</span><br><span class="line"> &quot;sort-vars&quot;: 0,//变量声明时排序</span><br><span class="line"> &quot;space-after-keywords&quot;: [0, &quot;always&quot;],//关键字后面是否要空一格</span><br><span class="line"> &quot;space-before-blocks&quot;: [0, &quot;always&quot;],//不以新行开始的块&#123;前面要不要有空格</span><br><span class="line"> &quot;space-before-function-paren&quot;: [0, &quot;always&quot;],//函数定义时括号前面要不要有空格</span><br><span class="line"> &quot;space-in-parens&quot;: [0, &quot;never&quot;],//小括号里面要不要有空格</span><br><span class="line"> &quot;space-infix-ops&quot;: 0,//中缀操作符周围要不要有空格</span><br><span class="line"> &quot;space-return-throw-case&quot;: 2,//return throw case后面要不要加空格</span><br><span class="line"> &quot;space-unary-ops&quot;: [0, &#123; &quot;words&quot;: true, &quot;nonwords&quot;: false &#125;],//一元运算符的前/后要不要加空格</span><br><span class="line"> &quot;spaced-comment&quot;: 0,//注释风格要不要有空格什么的</span><br><span class="line"> &quot;strict&quot;: 2,//使用严格模式</span><br><span class="line"> &quot;use-isnan&quot;: 2,//禁止比较时使用NaN，只能用isNaN()</span><br><span class="line"> &quot;valid-jsdoc&quot;: 0,//jsdoc规则</span><br><span class="line"> &quot;valid-typeof&quot;: 2,//必须使用合法的typeof的值</span><br><span class="line"> &quot;vars-on-top&quot;: 2,//var必须放在作用域顶部</span><br><span class="line"> &quot;wrap-iife&quot;: [2, &quot;inside&quot;],//立即执行函数表达式的小括号风格</span><br><span class="line"> &quot;wrap-regex&quot;: 0,//正则表达式字面量用小括号包起来</span><br><span class="line"> &quot;yoda&quot;: [2, &quot;never&quot;]//禁止尤达条件</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<ul>
<li><a href="http://www.tuicool.com/articles/7JZZJzn" target="_blank" rel="external">ESLint 使用入门</a></li>
<li><a href="https://csspod.com/getting-started-with-eslint/" target="_blank" rel="external">ESLint 使用入门</a></li>
<li><a href="http://ilioner.github.io/2016/05/21/%E5%A6%82%E4%BD%95%E6%84%89%E5%BF%AB%E7%9A%84%E4%BD%BF%E7%94%A8ESLint%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%A0%A1%E9%AA%8C.html" target="_blank" rel="external">如何愉快的使用ESLint进行代码校验</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ESLint/">ESLint</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术杂谈/">技术杂谈</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-vim快捷操作整理" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/12/vim快捷操作整理/" class="article-date">
  	<time datetime="2016-06-12T02:40:43.000Z" itemprop="datePublished">2016-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/12/vim快捷操作整理/">vim快捷操作整理</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>Vim</em>常见有两种模式一种是<em>Insert</em>模式，该模式下可以像其它文本编辑器一样正常输入字符；另一种是<em>Normal</em>模式，该模式下<em>Vim</em>监听用户的按键可以对文本进行快速修改。</p>
<p>想要从<em>Insert</em>模式切换到<em>Normal</em>模式只需按下<em>ESC</em>键即可。</p>
<p>想要从<em>Normal</em>模式切换到<em>Insert</em>模式，有很多方法。<br>最直接的是按下I键，效果是：在当前光标处插入文本。<br>如果按下A键，效果是：在下一光标处追加文本。</p>
<p>进入和退出vim编辑器：</p>
<blockquote>
<p>进入   vi filename(要编辑的文件名字)———&gt;进入了命令模式<br>命令模式——&gt;输入  :wq——&gt;退出</p>
</blockquote>
<p>保存退出</p>
<blockquote>
<p>:wq      保存修改并退出<br>ZZ      快捷键，保存修改并退出(前面没有冒号)<br>:q!        不保存退出<br>:wq!    强行保存退出，(文件所属者科忽略文件的制度属性)<br>:w        保存不退出<br>:wqa     保存所有文件<br>:w  new_filename  另存为指定文件</p>
</blockquote>
<p>vim配置文件，所在目录~/.vimrc</p>
<blockquote>
<p>1.修改配置文件时，可以不用加：<br>2.可将编辑模式下的命令写在里面，每个命令单独一行，这样每次启动时，会自动执行里面的命令。</p>
</blockquote>
<p>光标的快速移动</p>
<blockquote>
<p>h,j,k,l：左，下，上，右<br>w：光标移动至下一单词首位<br>b：光标移动至当前单词首位，如果光标已经在当前单词首位，就移动到前一单词首位<br>e：光标移动至当前单词末位<br>gg：光标移动至文本首行<br>Shift+g：光标移动至文本尾行<br>27+Shift+g：光标移动至文本第27行</p>
</blockquote>
<p>插入行</p>
<blockquote>
<p>o：在当前光标的下方插入新一行<br>Shift+o： 在当前光标的上方插入新一行</p>
</blockquote>
<p>删除与还原</p>
<blockquote>
<p>x：删除光标后的一个字符<br>Shift+x：删除光标前的一个字符<br>dd：删除光标所在整行，同时被删除内容存于剪贴板上<br>de：删除光标后的单词内容，同时被删除内容存于剪贴板上<br>dw：删除光标后的单词内容以及之后的空格，同时被删除内容存于剪贴板上<br>u：还原上一个操作（不限于删除）</p>
</blockquote>
<p>剪切、复制与粘贴</p>
<blockquote>
<p>选定文本块：使用v进入可视模式；移动光标键选定内容<br>y：复制选定块<br>yy：复制光标所在整行<br>d：剪切选定块<br>dd：剪切光标所在整行<br>p：粘贴文本</p>
</blockquote>
<p>查找与替换</p>
<blockquote>
<p>f+o：在当前行的光标之后查找字母o<br>f+o：在当前行的光标之后查找字母o<br>F+b：在当前行的光标之前查找字母b<br>:/word：全文查找word。 按下:实际上是进入了Vim的命令模式。查找操作支持正则表达式。<br>r+p：将光标之后的字符替换为字母p<br>:s/word/replace：光标所在行的第一个word替换为replace。<br>:%s/from/to/：全文查找from并替换为to。<br>:1,50s/from/to/：在第1行和第50行之间（含）进行搜索和替换。:45s/from/to/表示仅仅在第45行进行搜索和替换。而1,$行号范围和%是等价的。<br>:%s/from/to/g：全文查找from并替换为to,包含选项g的替换范围更广。？？<br>:%s/from/to/gc：全文查找from并替换为to，替换时询问。可以选择y/n/a/q/l/^E/^Y：y表示同意当前替换；n表示不同意当前替换；a表示替换当前和后面的并且不再确认；q表示立即结束替换操作；l表示把当前的替换后结束替换操作；^E向上滚屏^Y向下滚屏，用来帮助查看前后内容以决定进行操作。</p>
</blockquote>
<p>执行Shell命令</p>
<blockquote>
<p>:!ls就等同于在Shell终端执行ls命令。</p>
</blockquote>
<p>参考资料：</p>
<ul>
<li><a href="http://coolshell.cn/articles/5426.html" target="_blank" rel="external">简明 Vim 练级攻略</a></li>
<li><a href="https://gist.github.com/tuchangwei/87aa7b7c483e4c49967b" target="_blank" rel="external">Vim快捷键积累</a></li>
<li><a href="http://www.dabu.info/vim-shortcut-key-operation.html" target="_blank" rel="external">vim快捷键操作</a></li>
<li><a href="http://www.jianshu.com/p/c23136f68d2f" target="_blank" rel="external">Vim快捷键整理</a></li>
<li><a href="http://blog.csdn.net/ljianhui/article/details/11100625" target="_blank" rel="external">初窥Linux 之 我最常用的20条命令</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Vim-vi/">Vim vi</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术杂谈/">技术杂谈</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Nginx配置文件详解" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/12/Nginx配置文件详解/" class="article-date">
  	<time datetime="2016-06-12T01:40:43.000Z" itemprop="datePublished">2016-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/12/Nginx配置文件详解/">nginx反向代理处理静态页面(转载)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Nginx (“engine x”) 是一个高性能的 HTTP 和 反向代理服务器，也是一个 IMAP/POP3/SMTP 代理服务器。 Nginx 是由 Igor Sysoev 为俄罗斯访问量第二的 Rambler.ru 站点开发的，第一个公开版本0.1.0发布于2004年10月4日。其将源代码以类BSD许可证的形式发布，因它的稳定性、丰富的功能集、示例配置文件和低系统资源的消耗而闻名。</p>
<p>尽管Node.JS的性能不错，但处理静态事务确实不是他的专长，如：gzip编码，静态文件，HTTP缓存，SSL处理，负载平衡和反向代理及多站点代理等，都可以通过nginx来完成，从而减小node.js的负载，并通过nginx强大的缓存来节省您网站的流量从而提高网站的加载速度。</p>
<p>虽然node.js也有一些如http-proxy的代理模块可以实现一台服务器上面架设多个网站（每个域名映射到不同nodejs进程的端口），但这种基础性的工作，其实更应该交给ngnix来完成。</p>
<p>下面我们可以看一个多站点代理的例子, 假设你有一个node.js进程正在侦听8080端口，你希望从domaina.com的进入的连接由node.js提供服务，从domainb.com进入的连接映射到另一个静态文件服务的网站，你可以使用下面的ngix.confg(for 1.44)，配置比较简单，一般写程序的人应该都能看懂，进行之后你输入<code>http://192.168.0.101</code>, <code>http://localhost</code>会看到不同的结果.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#user  nobody;</span><br><span class="line">worker_processes  2;</span><br><span class="line"></span><br><span class="line">error_log  logs/error.log;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    gzip    on;</span><br><span class="line">    gzip_min_length 1k;</span><br><span class="line">    gzip_buffers    4 8k;</span><br><span class="line">    gzip_http_version   1.1;</span><br><span class="line">    gzip_types  text/plain application/x-javascript text/css application/xml;</span><br><span class="line"></span><br><span class="line">    upstream node_app &#123;</span><br><span class="line">        server 127.0.0.1:8080;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://node_app;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # static server</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  192.168.0.101;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   D:\GitHub\areu\web;</span><br><span class="line">            index  home.html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里有一篇更加复杂的示例，由于版本相对陈旧，仅供参考 <a href="http://blog.argteam.com/coding/hardening-node-js-for-production-part-2-using-nginx-to-avoid-node-js-load/" target="_blank" rel="external">Using Nginx To Avoid NodeJS Load</a> </p>
<p>简单说明一下，各个部分的作用</p>
<p>指明你网站运行的端口，因为支持http/https所以有两个端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    upstream silly_face_society_upstream &#123;</span><br><span class="line">      server 127.0.0.1:61337;</span><br><span class="line">      server 127.0.0.1:61338;</span><br><span class="line">      keepalive 64;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>静态文件拦截器，将以images/js/img/css…开头的地址映射到网站目录，由ngnix直接提供服务：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    server &#123;</span><br><span class="line">        ...</span><br><span class="line">        location ~ ^/(images/|img/|javascript/|js/|css/|stylesheets/|flash/|media/|static/|robots.txt|humans.txt|favicon.ico) &#123;</span><br><span class="line">          root /usr/local/silly_face_society/node/public;</span><br><span class="line">          access_log off;</span><br><span class="line">          expires max;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设置缓存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    proxy_cache_path  /var/cache/nginx levels=1:2 keys_zone=one:8m max_size=3000m inactive=600m;</span><br><span class="line">    proxy_temp_path /var/tmp;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设置Gzip压缩</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_comp_level 6;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_min_length  1000;</span><br><span class="line">    gzip_proxied any;</span><br><span class="line">    gzip_types text/plain text/html text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;</span><br><span class="line">    gzip_buffers 16 8k;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后将非静态文件交给nodejs进程去响应：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    server &#123;</span><br><span class="line">        ...</span><br><span class="line">        location / &#123;</span><br><span class="line">          proxy_redirect off;</span><br><span class="line">          proxy_set_header   X-Real-IP            $remote_addr;</span><br><span class="line">          proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;</span><br><span class="line">          proxy_set_header   Host                   $http_host;</span><br><span class="line">          proxy_set_header   X-NginX-Proxy    true;</span><br><span class="line">          ...</span><br><span class="line">          proxy_set_header   Connection &quot;&quot;;</span><br><span class="line">          proxy_http_version 1.1;</span><br><span class="line">          proxy_pass         http://silly_face_society_upstream;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>分享几个nginx调试命令: Debian Linux</p>
<p>安装nginx，使用apt-get 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install nginx</span><br></pre></td></tr></table></figure>
<p>测试nginx配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -t -c /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>
<p>重启nginx服务器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/nginx restart</span><br></pre></td></tr></table></figure>
<p>设置某脚本开机启动 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod 755 /etc/init.d/foobar</span><br><span class="line">sudo update-rc.d foobar defaults     #开机时启动</span><br><span class="line">sudo update-rc.d -f foobar remove　　#开机时不启动</span><br><span class="line"></span><br><span class="line">find / -name &apos;node&apos;  #在根目录 &apos;/&apos;　查找　node的位置（某些场合会用到）</span><br></pre></td></tr></table></figure>
<p>有时侯nginx在windows下面怎么杀也杀不死，可以使用此脚本　（Windows 2003 测试有效）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill /F /IM nginx.exe &gt; nul</span><br></pre></td></tr></table></figure>
<p>参考资料：</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000002797601" target="_blank" rel="external">nginx服务器安装及配置文件详解</a></li>
<li><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Nginx 安装配置</a></li>
<li><a href="https://segmentfault.com/a/1190000000606752" target="_blank" rel="external">全新安装Mac OSX 开发者环境 同时使用homebrew搭建 PHP，Nginx ，MySQL(LNMP开发环境)</a></li>
<li><a href="https://luolei.org/node-js-nginx-proxy/" target="_blank" rel="external">Nginx反向代理部署Node.js应用配置方法</a></li>
<li><a href="http://blog.fens.me/nodejs-nginx-log4js/" target="_blank" rel="external">Nginx反向代理Nodejs – log4js日志IP显示错误</a></li>
<li><a href="https://www.douban.com/note/265207425/" target="_blank" rel="external">node.js部署最佳实践</a></li>
<li><a href="http://www.phpsong.com/2126.html" target="_blank" rel="external">服务器nginx+nodejs配置</a></li>
<li><a href="https://www.zhihu.com/question/19887245" target="_blank" rel="external">如何在生产服务器上部署 Node.js 应用？</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx-Mac-Node/">Nginx Mac Node</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术杂谈/">技术杂谈</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
    <article id="post-Mac OS使用brew安装Nginx、MySQL、PHP-FPM的LAMP开发环境" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/12/Mac OS使用brew安装Nginx、MySQL、PHP-FPM的LAMP开发环境/" class="article-date">
  	<time datetime="2016-06-12T01:40:43.000Z" itemprop="datePublished">2016-06-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/12/Mac OS使用brew安装Nginx、MySQL、PHP-FPM的LAMP开发环境/">Mac使用brew安装Nginx、MySQL、PHP的LAMP开发环境</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>新版的 Mac OS 内置了Apache 和 PHP，我的系统版本是OS X 10.9.3，可以通过以下命令查看Apache和PHP的版本号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">httpd -v</span><br><span class="line"></span><br><span class="line">    Server version: Apache/2.2.26 (Unix)</span><br><span class="line">    Server built:   Dec 10 2013 22:09:38</span><br><span class="line"></span><br><span class="line">php --version</span><br><span class="line"></span><br><span class="line">    PHP 5.4.24 (cli) (built: Jan 19 2014 21:32:15)</span><br><span class="line">    Copyright (c) 1997-2013 The PHP Group</span><br><span class="line">    Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies</span><br></pre></td></tr></table></figure>
<p>因为我们要自己动手来安装 Nginx，因此首先来关闭系统自带的apache：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apachectl stop  #关闭apache，如果事先没开启过，可以忽略报错信息</span><br></pre></td></tr></table></figure>
<p>如果你的apache已经加入了launchctl，使用下面的命令来关闭：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist</span><br></pre></td></tr></table></figure>
<p>为什么选择关闭apache？因为mac os x系统自带的apache是没有优雅的remove/uninstall 的方式的… 对于“洁癖”比较严重的童鞋，可以选择直接删除相关的文件！（千万不要手抖删错目录…）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo rm /usr/sbin/apachectl</span><br><span class="line">sudo rm /usr/sbin/httpd</span><br><span class="line">sudo rm -r /etc/apache2/</span><br></pre></td></tr></table></figure>
<p>删除自带的php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -r /usr/bin/php</span><br></pre></td></tr></table></figure>
<p>如果没有安装brew，可以按照官网的步骤安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://brew.sh/</span><br></pre></td></tr></table></figure>
<h2 id="nginx的安装与配置"><a href="#nginx的安装与配置" class="headerlink" title="nginx的安装与配置"></a>nginx的安装与配置</h2><p>安装nginx</p>
<p>1、连接到远程主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nginx</span><br></pre></td></tr></table></figure>
<p>修改配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/local/etc/nginx/nginx.conf</span><br><span class="line">    #修改默认的8080端口为80,小于1024需要root权限</span><br></pre></td></tr></table></figure></p>
<p>给予管理员权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown root:wheel /usr/local/opt/nginx/bin/nginx</span><br><span class="line">sudo chmod u+s /usr/local/opt/nginx/bin/nginx</span><br></pre></td></tr></table></figure>
<p>加入launchctl启动控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/Library/LaunchAgents</span><br><span class="line">cp /usr/local/opt/nginx/homebrew.mxcl.nginx.plist ~/Library/LaunchAgents/</span><br><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist</span><br></pre></td></tr></table></figure>
<p>运行nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx #打开 nginx</span><br><span class="line">nginx -s reload|reopen|stop|quit  #重新加载配置|重启|停止|退出 nginx</span><br><span class="line">nginx -t   #测试配置是否有语法错误</span><br></pre></td></tr></table></figure>
<p><code>注意</code>：出现Nginx操作错误，可以参照<a href="http://www.jianshu.com/p/918eb337a206" target="_blank" rel="external">Mac Nginx 安装(源文件安装)</a></p>
<p>用法详解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx [-?hvVtq] [-s signal] [-c filename] [-p prefix] [-g directives]</span><br></pre></td></tr></table></figure>
<p>选项列表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-?,-h           : 打开帮助信息</span><br><span class="line">-v              : 显示版本信息并退出</span><br><span class="line">-V              : 显示版本和配置选项信息，然后退出</span><br><span class="line">-t              : 检测配置文件是否有语法错误，然后退出</span><br><span class="line">-q              : 在检测配置文件期间屏蔽非错误信息</span><br><span class="line">-s signal       : 给一个 nginx 主进程发送信号：stop（停止）, quit（退出）, reopen（重启）, reload（重新加载配置文件）</span><br><span class="line">-p prefix       : 设置前缀路径（默认是：/usr/local/Cellar/nginx/1.2.6/）</span><br><span class="line">-c filename     : 设置配置文件（默认是：/usr/local/etc/nginx/nginx.conf）</span><br><span class="line">-g directives   : 设置配置文件外的全局指令</span><br></pre></td></tr></table></figure>
<h2 id="mysql的安装与配置"><a href="#mysql的安装与配置" class="headerlink" title="mysql的安装与配置"></a>mysql的安装与配置</h2><p>安装mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install mysql</span><br><span class="line">cd /usr/local/opt/mysql/</span><br></pre></td></tr></table></figure>
<p>修改配置文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo vim my.cnf</span><br><span class="line">#如果出现无法启动mysql，rm my.cnf</span><br></pre></td></tr></table></figure></p>
<p>加入launchctl启动控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/Library/LaunchAgents/</span><br><span class="line">cp /usr/local/opt/mysql/homebrew.mxcl.mysql.plist ~/Library/LaunchAgents/</span><br><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span><br><span class="line">#取消启动</span><br><span class="line">#launchctl unload ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist</span><br></pre></td></tr></table></figure>
<p>初始化 mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/mysql_install_db</span><br></pre></td></tr></table></figure>
<p>执行安全设置脚本,设置root账号密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/mysql_secure_installation</span><br></pre></td></tr></table></figure>
<p>命令行连接mysql</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure>
<p>php的安装与配置<br>brew 默认没有 php 安装包：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew tap homebrew/dupes</span><br><span class="line">brew tap josegonzalez/homebrew-php</span><br></pre></td></tr></table></figure>
<p>现在可以安装php了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install php54 --with-imap --with-tidy --with-debug --with-mysql --with-fpm</span><br></pre></td></tr></table></figure>
<p>将php路径加入PATH</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim ~/.bash_profile    </span><br><span class="line">    export PATH=&quot;$(brew --prefix php54)/bin:$PATH&quot;</span><br><span class="line"></span><br><span class="line">source ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>加入launchctl启动控制</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/Library/LaunchAgents</span><br><span class="line">cp /usr/local/opt/php54/homebrew.mxcl.php54.plist ~/Library/LaunchAgents/</span><br><span class="line">launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.php54.plist</span><br></pre></td></tr></table></figure>
<p>配置路径</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/etc/php/5.4/php.ini</span><br><span class="line">/usr/local/etc/php/5.4/php-fpm.conf</span><br></pre></td></tr></table></figure>
<p>配置 Nginx 支持 PHP-FPM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/local/etc/nginx/nginx.conf    </span><br><span class="line"></span><br><span class="line">    # 添加默认首页 php</span><br><span class="line">    index  index.php index.html index.htm;</span><br><span class="line"></span><br><span class="line">    # 取消以下内容的注释，并做修改</span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        fastcgi_intercept_errors on;</span><br><span class="line">        fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        fastcgi_index  index.php;</span><br><span class="line">        fastcgi_param  SCRIPT_FILENAME  /usr/local/Cellar/nginx/1.6.0_1/html$fastcgi_script_name;</span><br><span class="line">        include        /usr/local/etc/nginx/fastcgi_params;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>测试环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /usr/local/Cellar/nginx/1.6.0_1/html/index.php</span><br><span class="line"></span><br><span class="line">    #添加测试代码</span><br><span class="line">    &lt;?php </span><br><span class="line">        phpinfo();</span><br></pre></td></tr></table></figure>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>到目前为止，我们的Nginx、MySQL、PHP-FPM三大软件已经安装好了，针对不同的系统版本和软件版本，可能会遇到一些问题，欢迎留言探讨。</p>
<p>原文链接：<a href="https://segmentfault.com/a/1190000002963355" target="_blank" rel="external">Mac OS使用brew安装Nginx、MySQL、PHP-FPM的LAMP开发环境</a></p>
<p>参考资料：</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000002797601" target="_blank" rel="external">nginx服务器安装及配置文件详解</a></li>
<li><a href="https://segmentfault.com/a/1190000004537991" target="_blank" rel="external">配置nginx静态文件代理和gzip</a></li>
<li><a href="http://www.darrenfang.com/2015/01/setting-up-http-cache-and-gzip-with-nginx/" target="_blank" rel="external">加速nginx: 开启gzip和缓存</a></li>
<li><a href="https://segmentfault.com/a/1190000003023558" target="_blank" rel="external">ngnix + node 的负载均衡</a></li>
<li><a href="https://segmentfault.com/a/1190000004916646" target="_blank" rel="external">5个提高Node.js应用性能的技巧</a></li>
<li><a href="https://www.zhihu.com/question/19887245" target="_blank" rel="external">如何在生产服务器上部署 Node.js 应用？</a></li>
<li><a href="http://www.runoob.com/linux/nginx-install-setup.html" target="_blank" rel="external">Nginx 安装配置</a></li>
<li><a href="https://segmentfault.com/a/1190000000606752" target="_blank" rel="external">全新安装Mac OSX 开发者环境 同时使用homebrew搭建 PHP，Nginx ，MySQL(LNMP开发环境)</a></li>
<li><a href="https://luolei.org/node-js-nginx-proxy/" target="_blank" rel="external">Nginx反向代理部署Node.js应用配置方法</a></li>
<li><a href="http://blog.fens.me/nodejs-nginx-log4js/" target="_blank" rel="external">Nginx反向代理Nodejs – log4js日志IP显示错误</a></li>
<li><a href="https://www.douban.com/note/265207425/" target="_blank" rel="external">node.js部署最佳实践</a></li>
<li><a href="http://www.phpsong.com/2126.html" target="_blank" rel="external">服务器nginx+nodejs配置</a></li>
<li><a href="http://www.codeceo.com/article/nginx-ssl-nodejs.html" target="_blank" rel="external">配置Nginx SSL Node.js环境详细指南</a></li>
<li><a href="http://www.oschina.net/translate/optimising-nginx-node-js-and-networking-for-heavy-workloads" target="_blank" rel="external">为高负载网络优化 Nginx 和 Node.js</a></li>
<li><a href="http://itbilu.com/other/relate/NJ2TJohl.html" target="_blank" rel="external">阿里云服务器配置Nodejs生产环境全过程</a></li>
<li><a href="https://xujiwei.com/blog/2011/12/build-site-with-nodejs-and-nginx/" target="_blank" rel="external">使用 node.js + nginx 建设网站</a></li>
<li><a href="http://01web.mobi/archives/95/" target="_blank" rel="external">01Web前端团队</a></li>
</ul>

      
    </div>

    <!-- S 打赏模块 -->
    <div class="pfan_payment" style="max-width: 500px;margin: 0 auto">
        <img src="http://img.pfan123.com/payment.png" alt="" style="width: 100%;height: 10%;">
    </div>
    <!-- E 打赏模块 -->


    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Nginx-MySQL-PHP-FPM-Mac-OS/">Nginx MySQL PHP-FPM Mac OS</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/技术杂谈/">技术杂谈</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
    
</article>











  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 pfan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a>
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>